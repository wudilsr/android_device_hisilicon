/******************************************************************************

Copyright (C), 2004-2020, Hisilicon Tech. Co., Ltd.
******************************************************************************
File Name     : sample_ca_tsplay.c
Version       : Initial
Author        : Hisilicon hisecurity group
Created       : 2013-08-28
Last Modified :
Description   :  
Function List :
History       :
******************************************************************************/
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <errno.h>
#include <string.h>
#include <sys/types.h>
#include <sys/socket.h>
#include <netinet/in.h>
#include <arpa/inet.h>
#include <string.h>
#include <pthread.h>

#include <assert.h>
#include <linux/fb.h>
#include <sys/mman.h>
#include <sys/ioctl.h>
#include <fcntl.h>
#include <unistd.h>

#include "hi_unf_common.h"
#include "hi_unf_ecs.h"
#include "hi_unf_avplay.h"
#include "hi_unf_sound.h"
#include "hi_unf_disp.h"
#include "hi_unf_vo.h"
#include "hi_unf_descrambler.h"
#include "hi_unf_advca.h"
#include "hi_unf_demux.h"
#include "hi_adp_audio.h"
#include "hi_adp_hdmi.h"
#include "hi_adp_mpi.h"
#include "sample_ca_common.h"
#include "hi_unf_pvr.h"

#define PLAY_DMX_ID    0
#define PVR_DMX_ID_REC  2
#define TESTPID     0x210

FILE    *g_pTsFile = HI_NULL;
static pthread_t    g_TsThd, g_RecThd;
static pthread_mutex_t  g_TsMutex;
static HI_BOOL  g_bStopTsThread = HI_FALSE;
HI_HANDLE   g_TsBuf;
PMT_COMPACT_TBL *g_pProgTbl = HI_NULL;
HI_S32  g_CwType = 0;
HI_U32 g_RecChn;
HI_HANDLE g_RecDesc;
HI_HANDLE g_hVideochannelhandle;

typedef enum hiADVCA_IRDETO_MSR2_2_CASE_ID
{
    Clear_CW = 0,
    CW_8byte_KL_ALG_TDES_KL_Level_2_TS_CSA2,
    CW_8byte_KL_ALG_AES_KL_Level_2_TS_CSA2,
    CW_16byte_KL_ALG_AES_KL_Level_2_TS_AES_CBC,
    
    CW_S0_KL_2TDES_L2_TS_AES,
    CW_S0_KL_2TDES_L2_TS_AES_TA,
    CW_S0_KL_2TDES_L2_TS_CSA,
    CW_S0_KL_2TDES_L2_TS_CSA_TA,
    CW_S0_KL_2TDES_L2_TS_CSA3,
    CW_S0_KL_2TDES_L2_TS_CSA3_TA,
    CW_S0_KL_2TDES_L2_TS_TCSA3,
    CW_S0_KL_2TDES_L2_TS_TCSA3_TA,
    
    CW_S0_KL_2TDES_L3_TS_AES,
    CW_S0_KL_2TDES_L3_TS_AES_TA,
    CW_S0_KL_2TDES_L3_TS_CSA,
    CW_S0_KL_2TDES_L3_TS_CSA_TA,
    CW_S0_KL_2TDES_L3_TS_CSA3,
    CW_S0_KL_2TDES_L3_TS_CSA3_TA,
    CW_S0_KL_2TDES_L3_TS_TCSA3,
    CW_S0_KL_2TDES_L3_TS_TCSA3_TA,
    
    CW_S0_KL_AES_L2_TS_AES,
    CW_S0_KL_AES_L2_TS_AES_TA,
    CW_S0_KL_AES_L2_TS_CSA,
    CW_S0_KL_AES_L2_TS_CSA_TA,
    CW_S0_KL_AES_L2_TS_CSA3,
    CW_S0_KL_AES_L2_TS_CSA3_TA,
    CW_S0_KL_AES_L2_TS_TCSA3,
    CW_S0_KL_AES_L2_TS_TCSA3_TA,
    
    CW_S0_KL_AES_L3_TS_AES,
    CW_S0_KL_AES_L3_TS_AES_TA,
    CW_S0_KL_AES_L3_TS_CSA,
    CW_S0_KL_AES_L3_TS_CSA_TA,
    CW_S0_KL_AES_L3_TS_CSA3,
    CW_S0_KL_AES_L3_TS_CSA3_TA,
    CW_S0_KL_AES_L3_TS_TCSA3,
    CW_S0_KL_AES_L3_TS_TCSA3_TA,
    
    PVR_S0_KL_2TDES_L2_TS_2TDES_CBC,
    PVR_S0_KL_2TDES_L2_TS_2TDES_ECB,
    PVR_S0_KL_2TDES_L2_TS_AES_CBC,
    PVR_S0_KL_2TDES_L2_TS_AES_ECB,
    
    PVR_S0_KL_2TDES_L3_TS_2TDES_CBC,
    PVR_S0_KL_2TDES_L3_TS_2TDES_ECB,
    PVR_S0_KL_2TDES_L3_TS_AES_CBC,
    PVR_S0_KL_2TDES_L3_TS_AES_ECB,
    
    PVR_S0_KL_AES_L2_TS_2TDES_CBC,
    PVR_S0_KL_AES_L2_TS_2TDES_ECB,
    PVR_S0_KL_AES_L2_TS_AES_CBC,
    PVR_S0_KL_AES_L2_TS_AES_ECB,
    
    PVR_S0_KL_AES_L3_TS_2TDES_CBC,
    PVR_S0_KL_AES_L3_TS_2TDES_ECB,
    PVR_S0_KL_AES_L3_TS_AES_CBC,
    PVR_S0_KL_AES_L3_TS_AES_ECB,
    
    AES_CBC_MAC_HIGH_LEVEL_CODE_AUTHENTICATION,
    
    AES_CBC_MAC_CHIP_CONFIGURATION_CHECK,
}HI_ADVCA_IRDETO_MSR2_2_CASE_ID;

//0: Clear_CW (SST_V2.4.mpg)
static HI_U8 g_u8ClearOddKey[8] = {0xA8,0x9C,0x0F,0x53,0x51,0x08,0xBD,0x16};
static HI_U8 g_u8ClearEvenKey[8] = {0x19,0xDF,0x63,0x5B,0xDC,0xB8,0x90,0x24};

//1: 8byte_CW-KL_ALG_TDES-KL_Level_2-TS_CSA2 (SST_V2.4.mpg)
static HI_U8 g_u8TDesEncrytedOddKey[8] = {0x1A,0x1C,0x15,0x4B,0xC1,0xAE,0x1A,0x14};
static HI_U8 g_u8TDesEncrytedEvenKey[8] = {0xB0,0x57,0xA4,0x02,0x49,0xDE,0x9B,0xAD};
static HI_U8 g_u8TDesEncrptedCwpk[16] = {0x1E,0x2E,0x06,0x74,0xF5,0x8C,0x95,0x20,0x41,0x0E,0x91,0xF3,0x68,0xB6,0xBB,0xF4}; 

//2: 8byte_CW-KL_ALG_AES-KL_Level_2-TS_CSA2 (SST_V2.4.mpg)
static HI_U8 g_u8AesEncrytedOddKey[16] = {0xE8,0x8C,0x5D,0x34,0x85,0x24,0x3F,0x9C,0xCE,0x3B,0xB1,0x3A,0xF8,0x47,0x7B,0x5F};
static HI_U8 g_u8AesEncrytedEvenKey[16] = {0x25,0x8D,0x6F,0x1A,0x8A,0x81,0x2A,0xB4,0x61,0x78,0x6B,0xFA,0xFB,0xB8,0x4B,0x11};
static HI_U8 g_u8AesEncrptedCwpk[16] = {0x89,0x05,0xD1,0x17,0xFF,0x4F,0xA9,0xAD,0xC9,0xE1,0x21,0x28,0x78,0x81,0x8B,0x68}; 

//3: 16byte_CW-KL_ALG_AES-KL_Level_2-TS_AES_CBC (IRDETO_AES_CBC.ts)
static HI_U8 g_u8IV[16] = {0x49,0x72,0x64,0x65,0x74,0x6F,0xA9,0x43,0x6F,0x70,0x79,0x72,0x69,0x67,0x68,0x74}; 
static HI_U8 g_u8AesCbcEncrytedOddKey[16] = {0x32,0x35,0xF9,0x8B,0xA5,0xF9,0xB7,0xC0,0x15,0x82,0x9E,0x46,0xF9,0x22,0xB8,0x66};
static HI_U8 g_u8AesCbcEncrytedEvenKey[16] = {0x30,0x08,0x35,0x94,0xD9,0xA3,0x81,0x44,0x26,0x1B,0x61,0xCC,0x1E,0xE4,0x28,0xB0};
static HI_U8 g_u8AesCbcEncrptedCwpk[16] = {0x89,0x05,0xD1,0x17,0xFF,0x4F,0xA9,0xAD,0xC9,0xE1,0x21,0x28,0x78,0x81,0x8B,0x68};

//Irdeto MSR2.2 chipset test vector
//The Hi3716CV200 encrypted CUSK is 7DA5FA73FFA9297617D45775E977E2FD
static HI_U8 g_u8IV_Zero[16] = {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00}; 
HI_U8 Clear_TS_packet_payload[] = {
    0xb7,0xb6,0xb5,0xb4,0xb3,0xb2,0xb1,0xb0,0xaf,0xae,0xad,0xac,0xab,0xaa,0xa9,0xa8,
    0xa7,0xa6,0xa5,0xa4,0xa3,0xa2,0xa1,0xa0,0x9f,0x9e,0x9d,0x9c,0x9b,0x9a,0x99,0x98,
    0x97,0x96,0x95,0x94,0x93,0x92,0x91,0x90,0x8f,0x8e,0x8d,0x8c,0x8b,0x8a,0x89,0x88,
    0x87,0x86,0x85,0x84,0x83,0x82,0x81,0x80,0x7f,0x7e,0x7d,0x7c,0x7b,0x7a,0x79,0x78,
    0x77,0x76,0x75,0x74,0x73,0x72,0x71,0x70,0x6f,0x6e,0x6d,0x6c,0x6b,0x6a,0x69,0x68,
    0x67,0x66,0x65,0x64,0x63,0x62,0x61,0x60,0x5f,0x5e,0x5d,0x5c,0x5b,0x5a,0x59,0x58,
    0x57,0x56,0x55,0x54,0x53,0x52,0x51,0x50,0x4f,0x4e,0x4d,0x4c,0x4b,0x4a,0x49,0x48,
    0x47,0x46,0x45,0x44,0x43,0x42,0x41,0x40,0x3f,0x3e,0x3d,0x3c,0x3b,0x3a,0x39,0x38,
    0x37,0x36,0x35,0x34,0x33,0x32,0x31,0x30,0x2f,0x2e,0x2d,0x2c,0x2b,0x2a,0x29,0x28,
    0x27,0x26,0x25,0x24,0x23,0x22,0x21,0x20,0x1f,0x1e,0x1d,0x1c,0x1b,0x1a,0x19,0x18,
    0x17,0x16,0x15,0x14,0x13,0x12,0x11,0x10,0x0f,0x0e,0x0d,0x0c,0x0b,0x0a,0x09,0x08,
    0x07,0x06,0x05,0x04,0x03,0x02,0x01,0x00
};

//3.2   CW_S0_KL-2TDES_L2_TS-AES
static HI_U8 CW_S0_KL_2TDES_L2_TS_AES_CWSKp[] = {0x82,0xE2,0xE6,0x62,0xF7,0x28,0xB4,0xFA,0x42,0x48,0x5E,0x3A,0x0A,0x5D,0x2F,0x34};
static HI_U8 CW_S0_KL_2TDES_L2_TS_AES_CEK_p[] = {0x0E,0x82,0x05,0x56,0x60,0x24,0xA0,0x11,0xC9,0x3B,0xE8,0x15,0x7A,0x4C,0xF1,0x7C};
HI_U8 Org_CW_S0_KL_2TDES_L2_TS_AES[188] = {
    0x47,0x42,0x10,0x90,0x3a,0xfc,0x36,0x8d,0x00,0x40,0x06,0xc0,0xe4,0xa6,0x6e,0x83,
    0x77,0x82,0x2c,0xd0,0x60,0xb3,0xc8,0xb7,0xa9,0x0f,0xb2,0x32,0x62,0x4d,0x1e,0x36,
    0x9c,0x9a,0x68,0x2b,0x6c,0xcd,0x88,0xb0,0x8a,0x24,0x0a,0xc9,0xcc,0xb8,0x09,0x1c,
    0xcb,0xb5,0xab,0xd3,0xb3,0x15,0x2f,0x76,0xe7,0xa1,0xc9,0x7b,0xbe,0x29,0x6e,0xf1,
    0xf5,0x98,0x4f,0x1c,0x94,0x4a,0x93,0xc7,0x25,0xe8,0xb9,0xd5,0x29,0x76,0xc8,0x66,
    0xbf,0xd6,0x82,0xfd,0x97,0xea,0xb0,0x7c,0x10,0x00,0x06,0x19,0x5f,0x44,0xcd,0x60,
    0xad,0xff,0x99,0xc9,0x67,0x8e,0x81,0x75,0x86,0xe4,0x70,0x26,0xad,0xe5,0x95,0x34,
    0x6a,0x57,0xd0,0x52,0xc9,0xe5,0x7b,0x4d,0xc4,0xff,0x2d,0xfe,0xcc,0x2b,0x7b,0x41,
    0x9e,0x5e,0x85,0xc8,0x4c,0x5d,0xdf,0xe5,0xd7,0xb4,0xb5,0xd2,0x21,0x20,0x4e,0x51,
    0x76,0x78,0x4d,0x75,0xc4,0xf2,0x5c,0xa1,0x3d,0x33,0x6f,0xad,0xe5,0x3d,0xf6,0xde,
    0xcf,0x8f,0x1f,0xc8,0xa7,0x82,0xf8,0x55,0x3d,0x4a,0x20,0xe2,0xa1,0x68,0x82,0xc0,
    0x3d,0xd6,0x8c,0x1a,0x07,0x06,0x05,0x04,0x03,0x02,0x01,0x00
};

//3.3   CW_S0_KL-2TDES_L2_TS-AES_TA
static HI_U8 CW_S0_KL_2TDES_L2_TS_AES_TA_TASKp[16]  = {0xD4,0x71,0x3D,0x60,0xC8,0xA7,0x06,0x39,0xEB,0x11,0x67,0xB3,0x67,0xA9,0xC3,0x78};
static HI_U8 CW_S0_KL_2TDES_L2_TS_AES_TA_Transformation_Data[] = {
    0xF5,0x84,0xCF,0x33,0x02,0x7D,0xF5,0x0A,0x34,0x46,0x4A,0x56,0x73,0xA7,0x35,0x50,
    0x47,0xAA,0x38,0xFF,0xC4,0x62,0x88,0x85,0x27,0x8E,0x08,0x40,0x42,0x46,0x32,0x87,
    0x36,0x85,0xD8,0xAF,0xD1,0x06,0x72,0xDF,0xD5,0xFA,0x1B,0x3F,0x66,0x4D,0x4B,0xBA,
    0x79,0xD8,0x75,0xBD,0x06,0x56,0x48,0x54,0xCA,0x62,0x68,0x51,0x72,0xF4,0xC9,0x9B,
    0x32,0x78,0xFC,0xB8,0xFF,0xCA,0x6D,0x2C,0xA9,0xC3,0x82,0x4E,0xC5,0xE2,0x1A,0x42,
    0xAA,0x1C,0xC7,0x09,0xA2,0x4D,0xE6,0x23,0xE9,0xEB,0x2A,0xCA,0x9F,0xFE,0x29,0x3F,
    0xE4,0xA0,0xA2,0x7F,0x21,0x42,0x94,0xDC,0x29,0x22,0xBA,0xDF,0xE5,0x8D,0x95,0x72,
    0xDF,0xBC,0x73,0x09,0xBB,0xCC,0x72,0xB3,0xEF,0xB5,0x4D,0xA0,0x1A,0x97,0x89,0x68,
    0x55,0x54,0xAF,0x4A,0x59,0xF9,0x70,0xFE,0xCB,0xC2,0x2C,0x90,0xB8,0xD0,0x40,0xF5,
    0x71,0x68,0x41,0x95,0x54,0x03,0x4B,0x39,0x3E,0x5E,0x57,0x62,0xB7,0xC6,0x82,0x4A,
    0x79,0xE3,0xFC,0x31,0x44,0xEB,0x90,0x95,0x00,0x58,0x95,0xD1,0x13,0x1A,0x08,0x1E,
    0x5A,0xC0,0xAA,0x41,0x2D,0xB0,0xF6,0xD3,0xF1,0x50,0xF2,0x2E,0x8C,0x68,0x86,0x9A,
    0x9C,0xEA,0x30,0x7E,0x54,0x7E,0x3A,0x3C,0xFD,0xD4,0x08,0xFC,0x06,0xCD,0x17,0x47,
    0xD1,0x5A,0x55,0x87,0x91,0xFC,0xD5,0xF4,0x41,0x78,0x4A,0xE2,0x16,0x18,0xAD,0x2F,
    0x9F,0x92,0x3F,0x9A,0xF8,0xC3,0x09,0x61,0xEC,0xB2,0x0C,0x8B,0xA6,0x13,0x6F,0x25,
    0x3E,0x71,0x08,0x2C,0x9C,0x66,0xED,0x5B,0x10,0x3B,0xAC,0x21,0xEC,0x9D,0x7F,0x89,
    0x64,0x02,0x45,0xEB,0xDC,0x6A,0x3C,0x62,0xDD,0x84,0x8F,0x36,0x41,0x21,0xC7,0x9A,
    0x6E,0x7A,0xBC,0xCD,0xDD,0xA7,0x54,0xEB,0x45,0xA7,0x74,0x18,0x80,0x3C,0xC9,0x60,
    0x93,0x4E,0xA7,0x25,0x11,0x6A,0x43,0x25,0xB2,0xF7,0x0D,0xF9,0x96,0x6C,0xEB,0xF0,
    0xE5,0x5B,0xC4,0xFC,0x4A,0xCF,0xEE,0xF4,0x54,0xFD,0x83,0x8A,0x5D,0x5B,0x54,0x5F,
    0xF9,0x53,0x50,0xAF,0x2E,0x12,0x60,0xDB,0x4E,0x44,0x19,0x93,0x91,0xCC,0xCB,0x16,
    0xF0,0x0D,0xEC,0xB3,0x2A,0x1D,0x7D,0xBE,0x2B,0xF3,0xE6,0xEB,0x4B,0x9A,0xAA,0xA6,
    0x59,0x49,0x57,0xF8,0x29,0xF4,0xF2,0x26,0xB3,0xE0,0xDA,0xAF,0x8A,0x5F,0xD7,0x24,
    0xE4,0x49,0x0F,0x3D,0x83,0xE6,0xDC,0xA6,0x4D,0xDC,0xF0,0xEE,0x86,0x9A,0xB0,0x0B,
    0x54,0xB9,0x12,0xC3,0x93,0x0F,0x4F,0x59,0x3A,0x34,0xE9,0x04,0xA4,0x3F,0x51,0x5C,
    0xD2,0x16,0xE8,0x72,0x05,0x1F,0xA2,0x12,0x08,0x5B,0x33,0xC7,0xD6,0x5A,0x6D,0xA5,
};

static HI_U8 CW_S0_KL_2TDES_L2_TS_AES_TA_CWSKp[] = {0x82,0xE2,0xE6,0x62,0xF7,0x28,0xB4,0xFA,0x42,0x48,0x5E,0x3A,0x0A,0x5D,0x2F,0x34};
static HI_U8 CW_S0_KL_2TDES_L2_TS_AES_TA_CEK_pT[] = {0x3E,0x2B,0x83,0x81,0xD3,0x36,0x2E,0x7A,0xFD,0xB1,0x0A,0x63,0xB5,0xAD,0x95,0xFB};
static HI_U8 Org_CW_S0_KL_2TDES_L2_TS_AES_TA[188] = {
    0x47,0x42,0x10,0x90,0x3a,0xfc,0x36,0x8d,0x00,0x40,0x06,0xc0,0xe4,0xa6,0x6e,0x83,
    0x77,0x82,0x2c,0xd0,0x60,0xb3,0xc8,0xb7,0xa9,0x0f,0xb2,0x32,0x62,0x4d,0x1e,0x36,
    0x9c,0x9a,0x68,0x2b,0x6c,0xcd,0x88,0xb0,0x8a,0x24,0x0a,0xc9,0xcc,0xb8,0x09,0x1c,
    0xcb,0xb5,0xab,0xd3,0xb3,0x15,0x2f,0x76,0xe7,0xa1,0xc9,0x7b,0xbe,0x29,0x6e,0xf1,
    0xf5,0x98,0x4f,0x1c,0x94,0x4a,0x93,0xc7,0x25,0xe8,0xb9,0xd5,0x29,0x76,0xc8,0x66,
    0xbf,0xd6,0x82,0xfd,0x97,0xea,0xb0,0x7c,0x10,0x00,0x06,0x19,0x5f,0x44,0xcd,0x60,
    0xad,0xff,0x99,0xc9,0x67,0x8e,0x81,0x75,0x86,0xe4,0x70,0x26,0xad,0xe5,0x95,0x34,
    0x6a,0x57,0xd0,0x52,0xc9,0xe5,0x7b,0x4d,0xc4,0xff,0x2d,0xfe,0xcc,0x2b,0x7b,0x41,
    0x9e,0x5e,0x85,0xc8,0x4c,0x5d,0xdf,0xe5,0xd7,0xb4,0xb5,0xd2,0x21,0x20,0x4e,0x51,
    0x76,0x78,0x4d,0x75,0xc4,0xf2,0x5c,0xa1,0x3d,0x33,0x6f,0xad,0xe5,0x3d,0xf6,0xde,
    0xcf,0x8f,0x1f,0xc8,0xa7,0x82,0xf8,0x55,0x3d,0x4a,0x20,0xe2,0xa1,0x68,0x82,0xc0,
    0x3d,0xd6,0x8c,0x1a,0x07,0x06,0x05,0x04,0x03,0x02,0x01,0x00
};

//3.4	CW_S0_KL-2TDES_L2_TS-CSA
static HI_U8 CW_S0_KL_2TDES_L2_TS_CSA_CWSKp[] = {0xE3,0xE7,0x06,0x82,0xC2,0x09,0x4C,0xAC,0x62,0x9F,0x6F,0xBE,0xD8,0x2C,0x07,0xCD};
static HI_U8 CW_S0_KL_2TDES_L2_TS_CSA_CEK_p[] = {0x9A,0x5F,0xCF,0x2D,0x1C,0xAD,0x45,0x3F,0x9A,0x5F,0xCF,0x2D,0x1C,0xAD,0x45,0x3F};
HI_U8 Org_CW_S0_KL_2TDES_L2_TS_CSA[188] = {
    0x47,0x42,0x10,0x90,0x4F,0x0C,0xCC,0xA6,0xD3,0xA2,0x71,0x41,0x2D,0xAA,0x76,0xD0,0xED,0x57,0xC0,0xC5,
    0x00,0xAA,0xF2,0xA4,0x5C,0xE9,0xF6,0x2E,0xA4,0x06,0xAC,0x41,0x5E,0xDC,0x42,0xD9,
    0x8A,0x76,0x4E,0x45,0xBF,0xC0,0xE7,0xE9,0x9C,0x83,0x95,0xF6,0x22,0xF5,0x3D,0xFA,
    0x92,0x76,0xBF,0x17,0x40,0x59,0x88,0xE0,0x45,0xC9,0xE3,0x47,0xDD,0x68,0x4E,0x94,
    0x00,0x2A,0x43,0x36,0xF6,0xBB,0xF2,0x99,0x9D,0x4E,0x5C,0x76,0xAC,0x54,0x6C,0xB7,
    0xDA,0x69,0x22,0x40,0x58,0x22,0x27,0xB9,0xB5,0xD2,0x21,0x69,0x96,0x24,0x9D,0xCF,
    0xD7,0x8E,0xF6,0x7D,0xF0,0xFC,0x10,0x4B,0xC8,0x63,0xC8,0x3A,0x76,0x4A,0x25,0x05,
    0x58,0x3D,0xDE,0xE6,0xA9,0x8B,0x79,0xF4,0x73,0xCD,0xEF,0xC6,0xA7,0x43,0x76,0xC5,
    0xF2,0x64,0x47,0x4B,0x89,0xB1,0x07,0xB2,0xA4,0xC1,0x95,0xFC,0x94,0xA9,0xC3,0xBA,
    0x82,0x5C,0xB0,0xDF,0xDA,0x11,0x9F,0xE1,0x31,0x44,0x3F,0x48,0xF9,0x41,0xD2,0x97,
    0x99,0x78,0x73,0x16,0x8E,0xB3,0x43,0x10,0x5A,0x41,0x4B,0x12,0x87,0x69,0xC7,0x5D,
    0x70,0xB9,0x6F,0x3C,0x8D,0x00,0x8D,0xBA
};

//3.5	CW_S0_KL-2TDES_L2_TS-CSA_TA
static HI_U8 CW_S0_KL_2TDES_L2_TS_CSA_TA_CWSKp[]  = {0xE3,0xE7,0x06,0x82,0xC2,0x09,0x4C,0xAC,0x62,0x9F,0x6F,0xBE,0xD8,0x2C,0x07,0xCD};
static HI_U8 CW_S0_KL_2TDES_L2_TS_CSA_TA_TASKp[]  = {0x82,0xE2,0xE6,0x62,0xF7,0x28,0xB4,0xFA,0x42,0x48,0x5E,0x3A,0x0A,0x5D,0x2F,0x34};
HI_U8 CW_S0_KL_2TDES_L2_TS_CSA_TA_Transformation_Data[] = {
    0xE1,0xC9,0x0D,0xC2,0x97,0x0D,0x9B,0x09,0xEF,0x41,0x4B,0xEA,0x43,0x95,0x3F,0xD0,
    0x9B,0x63,0x29,0xB1,0x92,0x34,0xB1,0x67,0x7A,0x9E,0x1A,0x2A,0xB9,0xE0,0xF3,0xFB,
    0x4A,0xC3,0x74,0x3C,0xDD,0x2E,0x6E,0xD9,0x3E,0xB0,0x9E,0x1F,0xC4,0x7F,0x3B,0xDC,
    0x34,0x1E,0x24,0xC9,0xD6,0x6E,0x0A,0xCC,0xA8,0xF6,0xB2,0x25,0x00,0x07,0xC3,0x3B,
    0x89,0x9F,0x75,0xA9,0xEE,0xA6,0x18,0xBC,0x65,0xA6,0x2F,0xFE,0x97,0x06,0x69,0x45,
    0x1B,0xB1,0x4F,0x34,0xE7,0xC5,0xF7,0x0A,0xD1,0x68,0x0F,0x02,0xE5,0x12,0x43,0x32,
    0x31,0x68,0x7B,0x33,0xC2,0xEA,0x5D,0x7C,0xCD,0x64,0xB8,0xD6,0x18,0xDA,0x93,0x7E,
    0x17,0x81,0x21,0xFC,0x43,0x30,0x4C,0xDF,0x5D,0xF8,0x77,0x1F,0xCE,0xF1,0xD4,0xDD,
    0x82,0x58,0xC1,0xAB,0x9C,0xAE,0xC6,0x72,0xBE,0xA8,0x6F,0xC1,0xAE,0x41,0xE0,0xD8,
    0x7C,0x0D,0x0C,0xFC,0x24,0xC9,0x08,0x4A,0x31,0x3A,0x62,0xFC,0xCE,0xB2,0x5E,0x19,
    0xC6,0xA0,0x2B,0x99,0x92,0x6F,0xC1,0xD9,0xD7,0x38,0xCD,0xC3,0xE5,0x7E,0x4A,0x3E,
    0x21,0x8E,0x85,0x45,0xBD,0x65,0xE9,0x5E,0xC1,0xF3,0x56,0x69,0x5B,0xF3,0xB6,0x96,
    0x12,0xDD,0x24,0x55,0x82,0x23,0xEE,0xDA,0xCE,0x8F,0xBC,0xF8,0xD5,0xAD,0x7D,0xAD,
    0x13,0x77,0x60,0xEE,0x3A,0x56,0xAB,0x8A,0xC9,0x04,0xA5,0x82,0x83,0x65,0x04,0x13,
    0x3E,0x43,0x80,0x6D,0xAC,0xFD,0xFD,0xC9,0x3D,0xF9,0x96,0x1A,0x9E,0x95,0x4B,0xB6,
    0xFB,0x5C,0x93,0x88,0x78,0x9A,0x98,0xEF,0x44,0xEB,0x32,0xD6,0x03,0x2A,0x23,0xC7,
    0x92,0x74,0x24,0x5A,0xCC,0x91,0xE7,0x86,0x02,0x5A,0x0D,0x15,0x0C,0x69,0xDC,0x30,
    0x1B,0xA6,0x94,0xF8,0x67,0x49,0x6C,0x75,0x9B,0xC8,0xF5,0x5E,0x3A,0x9A,0x75,0x8A,
    0x51,0x40,0x1C,0x1B,0x9B,0xCE,0xCE,0x10,0x5B,0xFE,0x95,0x70,0x46,0x6C,0x43,0xFC,
    0x6C,0xDD,0xF1,0x5C,0x55,0xA5,0xB4,0x78,0x75,0xC7,0x09,0x80,0x46,0xF9,0x8B,0x69,
    0x0C,0xE4,0x72,0xEE,0xBE,0x8F,0xCD,0x28,0xFE,0x0B,0xB2,0x2D,0xFD,0x6E,0x41,0x1A,
    0x91,0x7C,0x6B,0x58,0x8A,0x9F,0xC3,0x86,0x5D,0x00,0xB5,0x45,0xC4,0xF6,0x42,0x49,
    0x3B,0x4C,0x84,0xE4,0x25,0x34,0x16,0x73,0x36,0x2A,0xD2,0x60,0x7B,0xD9,0x5D,0xEF,
    0x64,0xF9,0x03,0xD8,0xAE,0x78,0x10,0x38,0x32,0x00,0xF1,0x7A,0x46,0x50,0x04,0xBD,
    0x01,0x3F,0xCE,0x17,0xE5,0xFB,0x9C,0x7F,0xDD,0xB5,0x53,0x9B,0xC1,0x02,0xBF,0xCC,
    0x15,0x3C,0xB6,0xBB,0x0C,0xB7,0x14,0x1D,0x5B,0x1B,0xA8,0xE6,0xB5,0x6D,0xD3,0x49,
};
HI_U8 CW_S0_KL_2TDES_L2_TS_CSA_TA_CEK_pT[] = {0x82,0x99,0x19,0xAD,0xEF,0xBC,0x4B,0x35,0x82,0x99,0x19,0xAD,0xEF,0xBC,0x4B,0x35};
HI_U8 Org_CW_S0_KL_2TDES_L2_TS_CSA_TA[188] = {
    0x47,0x42,0x10,0x90,0x4F,0x0C,0xCC,0xA6,0xD3,0xA2,0x71,0x41,0x2D,0xAA,0x76,0xD0,0xED,0x57,0xC0,0xC5,
    0x00,0xAA,0xF2,0xA4,0x5C,0xE9,0xF6,0x2E,0xA4,0x06,0xAC,0x41,0x5E,0xDC,0x42,0xD9,
    0x8A,0x76,0x4E,0x45,0xBF,0xC0,0xE7,0xE9,0x9C,0x83,0x95,0xF6,0x22,0xF5,0x3D,0xFA,
    0x92,0x76,0xBF,0x17,0x40,0x59,0x88,0xE0,0x45,0xC9,0xE3,0x47,0xDD,0x68,0x4E,0x94,
    0x00,0x2A,0x43,0x36,0xF6,0xBB,0xF2,0x99,0x9D,0x4E,0x5C,0x76,0xAC,0x54,0x6C,0xB7,
    0xDA,0x69,0x22,0x40,0x58,0x22,0x27,0xB9,0xB5,0xD2,0x21,0x69,0x96,0x24,0x9D,0xCF,
    0xD7,0x8E,0xF6,0x7D,0xF0,0xFC,0x10,0x4B,0xC8,0x63,0xC8,0x3A,0x76,0x4A,0x25,0x05,
    0x58,0x3D,0xDE,0xE6,0xA9,0x8B,0x79,0xF4,0x73,0xCD,0xEF,0xC6,0xA7,0x43,0x76,0xC5,
    0xF2,0x64,0x47,0x4B,0x89,0xB1,0x07,0xB2,0xA4,0xC1,0x95,0xFC,0x94,0xA9,0xC3,0xBA,
    0x82,0x5C,0xB0,0xDF,0xDA,0x11,0x9F,0xE1,0x31,0x44,0x3F,0x48,0xF9,0x41,0xD2,0x97,
    0x99,0x78,0x73,0x16,0x8E,0xB3,0x43,0x10,0x5A,0x41,0x4B,0x12,0x87,0x69,0xC7,0x5D,
    0x70,0xB9,0x6F,0x3C,0x8D,0x00,0x8D,0xBA
};

//3.6	CW_S0_KL-2TDES_L2_TS-CSA3
static HI_U8 CW_S0_KL_2TDES_L2_TS_CSA3_CWSKp[] = {0xE3,0xE7,0x06,0x82,0xC2,0x09,0x4C,0xAC,0x62,0x9F,0x6F,0xBE,0xD8,0x2C,0x07,0xCD};
static HI_U8 CW_S0_KL_2TDES_L2_TS_CSA3_CEK_p[] = {0xDF,0x71,0xFF,0xDC,0x4D,0xD3,0x21,0x2A,0xE3,0xB5,0x16,0xFF,0xA0,0x63,0x07,0x87};
HI_U8 Org_CW_S0_KL_2TDES_L2_TS_CSA3[188] = {
    0x47,0x42,0x10,0x90,0x14,0x5C,0x5D,0x60,0xDE,0x00,0x06,0xBD,0x87,0xED,0xBE,0x80,
    0x55,0xB7,0xEF,0xE3,0xA1,0x29,0x1A,0x52,0xB8,0x22,0xDB,0x12,0xA1,0x8A,0x6B,0x1A,
    0x9F,0x2B,0x4C,0xD8,0x9B,0x68,0x38,0x39,0x1E,0xEF,0xB5,0x4F,0xF7,0xA2,0x7D,0xB9,
    0x5A,0xCA,0xE2,0xDC,0x33,0x44,0xAB,0x2F,0x58,0xB7,0xB0,0x85,0x26,0x68,0x5B,0x67,
    0xA0,0x28,0x33,0x4E,0xAB,0x11,0xF2,0x37,0x7B,0xA6,0xBC,0x54,0xE0,0x26,0x02,0x3D,
    0x54,0x57,0x61,0xD2,0x76,0x62,0xC0,0xCE,0x04,0xB4,0xC8,0x63,0x2F,0x4C,0x2E,0x8C,
    0x89,0x95,0x37,0xAD,0x9A,0xDB,0x2A,0x05,0x2A,0x7A,0xB6,0x75,0x3F,0x8B,0x3C,0x2A,
    0xA4,0x0F,0x4B,0x42,0x4E,0xE7,0x51,0x2A,0xE4,0xF5,0x9A,0x6A,0x64,0x4B,0x4A,0x4D,
    0x27,0x82,0x7F,0x2B,0x48,0xFE,0x38,0x0F,0x5B,0x6D,0xE3,0x2D,0x94,0x84,0x47,0x44,
    0xD7,0xD7,0x7D,0xF3,0x0C,0xFE,0xED,0x8C,0xB6,0x77,0xE9,0x88,0x00,0xEB,0xC6,0x78,
    0x3C,0x09,0x66,0x55,0x9E,0x01,0x97,0x8F,0xC0,0xDC,0xDD,0x2E,0x6F,0xDF,0x85,0x5E,
    0xFB,0xBD,0x73,0x91,0xF2,0x28,0x94,0x33,0x90,0xFA,0xDB,0xBD
};

//3.7	CW_S0_KL-2TDES_L2_TS-CSA3_TA
static HI_U8 CW_S0_KL_2TDES_L2_TS_CSA3_TA_CWSKp[]  = {0xE3,0xE7,0x06,0x82,0xC2,0x09,0x4C,0xAC,0x62,0x9F,0x6F,0xBE,0xD8,0x2C,0x07,0xCD};
static HI_U8 CW_S0_KL_2TDES_L2_TS_CSA3_TA_TASKp[]  = {0x82,0xE2,0xE6,0x62,0xF7,0x28,0xB4,0xFA,0x42,0x48,0x5E,0x3A,0x0A,0x5D,0x2F,0x34};
static HI_U8 CW_S0_KL_2TDES_L2_TS_CSA3_TA_Transformation_Data[] = {
    0xE1,0xC9,0x0D,0xC2,0x97,0x0D,0x9B,0x09,0xEF,0x41,0x4B,0xEA,0x43,0x95,0x3F,0xD0,
    0x9B,0x63,0x29,0xB1,0x92,0x34,0xB1,0x67,0x7A,0x9E,0x1A,0x2A,0xB9,0xE0,0xF3,0xFB,
    0x4A,0xC3,0x74,0x3C,0xDD,0x2E,0x6E,0xD9,0x3E,0xB0,0x9E,0x1F,0xC4,0x7F,0x3B,0xDC,
    0x34,0x1E,0x24,0xC9,0xD6,0x6E,0x0A,0xCC,0xA8,0xF6,0xB2,0x25,0x00,0x07,0xC3,0x3B,
    0x89,0x9F,0x75,0xA9,0xEE,0xA6,0x18,0xBC,0x65,0xA6,0x2F,0xFE,0x97,0x06,0x69,0x45,
    0x1B,0xB1,0x4F,0x34,0xE7,0xC5,0xF7,0x0A,0xD1,0x68,0x0F,0x02,0xE5,0x12,0x43,0x32,
    0x31,0x68,0x7B,0x33,0xC2,0xEA,0x5D,0x7C,0xCD,0x64,0xB8,0xD6,0x18,0xDA,0x93,0x7E,
    0x17,0x81,0x21,0xFC,0x43,0x30,0x4C,0xDF,0x5D,0xF8,0x77,0x1F,0xCE,0xF1,0xD4,0xDD,
    0x82,0x58,0xC1,0xAB,0x9C,0xAE,0xC6,0x72,0xBE,0xA8,0x6F,0xC1,0xAE,0x41,0xE0,0xD8,
    0x7C,0x0D,0x0C,0xFC,0x24,0xC9,0x08,0x4A,0x31,0x3A,0x62,0xFC,0xCE,0xB2,0x5E,0x19,
    0xC6,0xA0,0x2B,0x99,0x92,0x6F,0xC1,0xD9,0xD7,0x38,0xCD,0xC3,0xE5,0x7E,0x4A,0x3E,
    0x21,0x8E,0x85,0x45,0xBD,0x65,0xE9,0x5E,0xC1,0xF3,0x56,0x69,0x5B,0xF3,0xB6,0x96,
    0x12,0xDD,0x24,0x55,0x82,0x23,0xEE,0xDA,0xCE,0x8F,0xBC,0xF8,0xD5,0xAD,0x7D,0xAD,
    0x13,0x77,0x60,0xEE,0x3A,0x56,0xAB,0x8A,0xC9,0x04,0xA5,0x82,0x83,0x65,0x04,0x13,
    0x3E,0x43,0x80,0x6D,0xAC,0xFD,0xFD,0xC9,0x3D,0xF9,0x96,0x1A,0x9E,0x95,0x4B,0xB6,
    0xFB,0x5C,0x93,0x88,0x78,0x9A,0x98,0xEF,0x44,0xEB,0x32,0xD6,0x03,0x2A,0x23,0xC7,
    0x92,0x74,0x24,0x5A,0xCC,0x91,0xE7,0x86,0x02,0x5A,0x0D,0x15,0x0C,0x69,0xDC,0x30,
    0x1B,0xA6,0x94,0xF8,0x67,0x49,0x6C,0x75,0x9B,0xC8,0xF5,0x5E,0x3A,0x9A,0x75,0x8A,
    0x51,0x40,0x1C,0x1B,0x9B,0xCE,0xCE,0x10,0x5B,0xFE,0x95,0x70,0x46,0x6C,0x43,0xFC,
    0x6C,0xDD,0xF1,0x5C,0x55,0xA5,0xB4,0x78,0x75,0xC7,0x09,0x80,0x46,0xF9,0x8B,0x69,
    0x0C,0xE4,0x72,0xEE,0xBE,0x8F,0xCD,0x28,0xFE,0x0B,0xB2,0x2D,0xFD,0x6E,0x41,0x1A,
    0x91,0x7C,0x6B,0x58,0x8A,0x9F,0xC3,0x86,0x5D,0x00,0xB5,0x45,0xC4,0xF6,0x42,0x49,
    0x3B,0x4C,0x84,0xE4,0x25,0x34,0x16,0x73,0x36,0x2A,0xD2,0x60,0x7B,0xD9,0x5D,0xEF,
    0x64,0xF9,0x03,0xD8,0xAE,0x78,0x10,0x38,0x32,0x00,0xF1,0x7A,0x46,0x50,0x04,0xBD,
    0x01,0x3F,0xCE,0x17,0xE5,0xFB,0x9C,0x7F,0xDD,0xB5,0x53,0x9B,0xC1,0x02,0xBF,0xCC,
    0x15,0x3C,0xB6,0xBB,0x0C,0xB7,0x14,0x1D,0x5B,0x1B,0xA8,0xE6,0xB5,0x6D,0xD3,0x49,
};
static HI_U8 CW_S0_KL_2TDES_L2_TS_CSA3_TA_CEK_pT[] = {0x64,0x9D,0x51,0x36,0x56,0x64,0x35,0x84,0x3A,0x8F,0x90,0x63,0x61,0x30,0xA6,0xB7};

HI_U8 Org_CW_S0_KL_2TDES_L2_TS_CSA3_TA[188] = {
    0x47,0x42,0x10,0x90,0x14,0x5C,0x5D,0x60,0xDE,0x00,0x06,0xBD,0x87,0xED,0xBE,0x80,
    0x55,0xB7,0xEF,0xE3,0xA1,0x29,0x1A,0x52,0xB8,0x22,0xDB,0x12,0xA1,0x8A,0x6B,0x1A,
    0x9F,0x2B,0x4C,0xD8,0x9B,0x68,0x38,0x39,0x1E,0xEF,0xB5,0x4F,0xF7,0xA2,0x7D,0xB9,
    0x5A,0xCA,0xE2,0xDC,0x33,0x44,0xAB,0x2F,0x58,0xB7,0xB0,0x85,0x26,0x68,0x5B,0x67,
    0xA0,0x28,0x33,0x4E,0xAB,0x11,0xF2,0x37,0x7B,0xA6,0xBC,0x54,0xE0,0x26,0x02,0x3D,
    0x54,0x57,0x61,0xD2,0x76,0x62,0xC0,0xCE,0x04,0xB4,0xC8,0x63,0x2F,0x4C,0x2E,0x8C,
    0x89,0x95,0x37,0xAD,0x9A,0xDB,0x2A,0x05,0x2A,0x7A,0xB6,0x75,0x3F,0x8B,0x3C,0x2A,
    0xA4,0x0F,0x4B,0x42,0x4E,0xE7,0x51,0x2A,0xE4,0xF5,0x9A,0x6A,0x64,0x4B,0x4A,0x4D,
    0x27,0x82,0x7F,0x2B,0x48,0xFE,0x38,0x0F,0x5B,0x6D,0xE3,0x2D,0x94,0x84,0x47,0x44,
    0xD7,0xD7,0x7D,0xF3,0x0C,0xFE,0xED,0x8C,0xB6,0x77,0xE9,0x88,0x00,0xEB,0xC6,0x78,
    0x3C,0x09,0x66,0x55,0x9E,0x01,0x97,0x8F,0xC0,0xDC,0xDD,0x2E,0x6F,0xDF,0x85,0x5E,
    0xFB,0xBD,0x73,0x91,0xF2,0x28,0x94,0x33,0x90,0xFA,0xDB,0xBD
};

//3.8	CW_S0_KL-2TDES_L2_TS-TCSA3
static HI_U8 CW_S0_KL_2TDES_L2_TS_TCSA3_CWSKp[] = {0xE3,0xE7,0x06,0x82,0xC2,0x09,0x4C,0xAC,0x62,0x9F,0x6F,0xBE,0xD8,0x2C,0x07,0xCD};
static HI_U8 CW_S0_KL_2TDES_L2_TS_TCSA3_CEK_p[] = {0xDF,0x71,0xFF,0xDC,0x4D,0xD3,0x21,0x2A,0xE3,0xB5,0x16,0xFF,0xA0,0x63,0x07,0x87};
HI_U8 Org_CW_S0_KL_2TDES_L2_TS_TCSA3[188] = {
    0x47,0x42,0x10,0x90,0xE6,0x34,0x0B,0x6E,0xBA,0x46,0xF2,0xD4,0x12,0x25,0xF0,0xD7,0x1C,0xCC,0xF3,0x45,
    0x57,0x94,0x82,0x74,0xEA,0x50,0x44,0x87,0xB8,0x33,0xAF,0x09,0xF6,0x62,0x5C,0x12,
    0xCF,0x71,0x83,0x34,0x59,0xC8,0xE3,0x1F,0x66,0xFF,0xD7,0x3B,0x04,0x9C,0xF4,0xB1,
    0xC5,0x61,0xE2,0x74,0xAA,0xA8,0xCD,0xCA,0x88,0x13,0xAF,0x18,0x8D,0x71,0x3F,0x88,
    0x39,0xA4,0xC1,0xC3,0x9F,0x4A,0x40,0x9C,0xAA,0xF9,0x27,0xFD,0xF8,0x9A,0xFB,0xE5,
    0x2E,0x67,0x79,0xD3,0xF2,0x3B,0x5F,0x95,0x45,0x58,0xEB,0x38,0xF3,0x9B,0x66,0x7B,
    0xA0,0x1B,0xEE,0x32,0x4D,0xAA,0x0A,0x26,0xE8,0x59,0x10,0xDD,0x8B,0x9F,0x8A,0x43,
    0xDF,0xBA,0x85,0x41,0x45,0x40,0xF1,0x95,0xA7,0xA0,0x0D,0x10,0x2D,0x97,0xE3,0x17,
    0x55,0x62,0x26,0xB2,0xB3,0xE6,0xFD,0xC5,0x13,0x76,0x61,0x79,0xB9,0xB3,0xA9,0x34,
    0x80,0xC4,0x1D,0x90,0x33,0x68,0xAD,0xC6,0xB8,0x18,0x3C,0x9B,0x91,0x58,0x24,0xC3,
    0xB4,0x18,0x7A,0x3C,0x3F,0x4B,0x04,0xBC,0xC6,0xF7,0xD8,0x72,0x8F,0x28,0xA1,0x72,
    0x5E,0x5E,0x25,0xD2,0xD8,0x2B,0x35,0x57
};
HI_U8 CW_S0_KL_2TDES_L2_TS_TCSA3_ACTIVATION[] = {0xAA,0xAA,0x7E,0x7B,0x3D,0x5B,0x87,0xC4,0x81,0x1D,0x69,0xB8,0xC6,0x29,0x59,0x38};

//3.9	CW_S0_KL-2TDES_L2_TS-TCSA3_TA
static HI_U8 CW_S0_KL_2TDES_L2_TS_TCSA3_TA_CWSKp[]  = {0xE3,0xE7,0x06,0x82,0xC2,0x09,0x4C,0xAC,0x62,0x9F,0x6F,0xBE,0xD8,0x2C,0x07,0xCD};
static HI_U8 CW_S0_KL_2TDES_L2_TS_TCSA3_TA_TASKp[]  = {0x82,0xE2,0xE6,0x62,0xF7,0x28,0xB4,0xFA,0x42,0x48,0x5E,0x3A,0x0A,0x5D,0x2F,0x34};
static HI_U8 CW_S0_KL_2TDES_L2_TS_TCSA3_TA_Transformation_Data[] = {
    0xE1,0xC9,0x0D,0xC2,0x97,0x0D,0x9B,0x09,0xEF,0x41,0x4B,0xEA,0x43,0x95,0x3F,0xD0,
    0x9B,0x63,0x29,0xB1,0x92,0x34,0xB1,0x67,0x7A,0x9E,0x1A,0x2A,0xB9,0xE0,0xF3,0xFB,
    0x4A,0xC3,0x74,0x3C,0xDD,0x2E,0x6E,0xD9,0x3E,0xB0,0x9E,0x1F,0xC4,0x7F,0x3B,0xDC,
    0x34,0x1E,0x24,0xC9,0xD6,0x6E,0x0A,0xCC,0xA8,0xF6,0xB2,0x25,0x00,0x07,0xC3,0x3B,
    0x89,0x9F,0x75,0xA9,0xEE,0xA6,0x18,0xBC,0x65,0xA6,0x2F,0xFE,0x97,0x06,0x69,0x45,
    0x1B,0xB1,0x4F,0x34,0xE7,0xC5,0xF7,0x0A,0xD1,0x68,0x0F,0x02,0xE5,0x12,0x43,0x32,
    0x31,0x68,0x7B,0x33,0xC2,0xEA,0x5D,0x7C,0xCD,0x64,0xB8,0xD6,0x18,0xDA,0x93,0x7E,
    0x17,0x81,0x21,0xFC,0x43,0x30,0x4C,0xDF,0x5D,0xF8,0x77,0x1F,0xCE,0xF1,0xD4,0xDD,
    0x82,0x58,0xC1,0xAB,0x9C,0xAE,0xC6,0x72,0xBE,0xA8,0x6F,0xC1,0xAE,0x41,0xE0,0xD8,
    0x7C,0x0D,0x0C,0xFC,0x24,0xC9,0x08,0x4A,0x31,0x3A,0x62,0xFC,0xCE,0xB2,0x5E,0x19,
    0xC6,0xA0,0x2B,0x99,0x92,0x6F,0xC1,0xD9,0xD7,0x38,0xCD,0xC3,0xE5,0x7E,0x4A,0x3E,
    0x21,0x8E,0x85,0x45,0xBD,0x65,0xE9,0x5E,0xC1,0xF3,0x56,0x69,0x5B,0xF3,0xB6,0x96,
    0x12,0xDD,0x24,0x55,0x82,0x23,0xEE,0xDA,0xCE,0x8F,0xBC,0xF8,0xD5,0xAD,0x7D,0xAD,
    0x13,0x77,0x60,0xEE,0x3A,0x56,0xAB,0x8A,0xC9,0x04,0xA5,0x82,0x83,0x65,0x04,0x13,
    0x3E,0x43,0x80,0x6D,0xAC,0xFD,0xFD,0xC9,0x3D,0xF9,0x96,0x1A,0x9E,0x95,0x4B,0xB6,
    0xFB,0x5C,0x93,0x88,0x78,0x9A,0x98,0xEF,0x44,0xEB,0x32,0xD6,0x03,0x2A,0x23,0xC7,
    0x92,0x74,0x24,0x5A,0xCC,0x91,0xE7,0x86,0x02,0x5A,0x0D,0x15,0x0C,0x69,0xDC,0x30,
    0x1B,0xA6,0x94,0xF8,0x67,0x49,0x6C,0x75,0x9B,0xC8,0xF5,0x5E,0x3A,0x9A,0x75,0x8A,
    0x51,0x40,0x1C,0x1B,0x9B,0xCE,0xCE,0x10,0x5B,0xFE,0x95,0x70,0x46,0x6C,0x43,0xFC,
    0x6C,0xDD,0xF1,0x5C,0x55,0xA5,0xB4,0x78,0x75,0xC7,0x09,0x80,0x46,0xF9,0x8B,0x69,
    0x0C,0xE4,0x72,0xEE,0xBE,0x8F,0xCD,0x28,0xFE,0x0B,0xB2,0x2D,0xFD,0x6E,0x41,0x1A,
    0x91,0x7C,0x6B,0x58,0x8A,0x9F,0xC3,0x86,0x5D,0x00,0xB5,0x45,0xC4,0xF6,0x42,0x49,
    0x3B,0x4C,0x84,0xE4,0x25,0x34,0x16,0x73,0x36,0x2A,0xD2,0x60,0x7B,0xD9,0x5D,0xEF,
    0x64,0xF9,0x03,0xD8,0xAE,0x78,0x10,0x38,0x32,0x00,0xF1,0x7A,0x46,0x50,0x04,0xBD,
    0x01,0x3F,0xCE,0x17,0xE5,0xFB,0x9C,0x7F,0xDD,0xB5,0x53,0x9B,0xC1,0x02,0xBF,0xCC,
    0x15,0x3C,0xB6,0xBB,0x0C,0xB7,0x14,0x1D,0x5B,0x1B,0xA8,0xE6,0xB5,0x6D,0xD3,0x49,
};
static HI_U8 CW_S0_KL_2TDES_L2_TS_TCSA3_TA_CEK_pT[] = {0x64,0x9D,0x51,0x36,0x56,0x64,0x35,0x84,0x3A,0x8F,0x90,0x63,0x61,0x30,0xA6,0xB7};

HI_U8 Org_CW_S0_KL_2TDES_L2_TS_TCSA3_TA[188] = {
    0x47,0x42,0x10,0x90,0xE6,0x34,0x0B,0x6E,0xBA,0x46,0xF2,0xD4,0x12,0x25,0xF0,0xD7,0x1C,0xCC,0xF3,0x45,
    0x57,0x94,0x82,0x74,0xEA,0x50,0x44,0x87,0xB8,0x33,0xAF,0x09,0xF6,0x62,0x5C,0x12,
    0xCF,0x71,0x83,0x34,0x59,0xC8,0xE3,0x1F,0x66,0xFF,0xD7,0x3B,0x04,0x9C,0xF4,0xB1,
    0xC5,0x61,0xE2,0x74,0xAA,0xA8,0xCD,0xCA,0x88,0x13,0xAF,0x18,0x8D,0x71,0x3F,0x88,
    0x39,0xA4,0xC1,0xC3,0x9F,0x4A,0x40,0x9C,0xAA,0xF9,0x27,0xFD,0xF8,0x9A,0xFB,0xE5,
    0x2E,0x67,0x79,0xD3,0xF2,0x3B,0x5F,0x95,0x45,0x58,0xEB,0x38,0xF3,0x9B,0x66,0x7B,
    0xA0,0x1B,0xEE,0x32,0x4D,0xAA,0x0A,0x26,0xE8,0x59,0x10,0xDD,0x8B,0x9F,0x8A,0x43,
    0xDF,0xBA,0x85,0x41,0x45,0x40,0xF1,0x95,0xA7,0xA0,0x0D,0x10,0x2D,0x97,0xE3,0x17,
    0x55,0x62,0x26,0xB2,0xB3,0xE6,0xFD,0xC5,0x13,0x76,0x61,0x79,0xB9,0xB3,0xA9,0x34,
    0x80,0xC4,0x1D,0x90,0x33,0x68,0xAD,0xC6,0xB8,0x18,0x3C,0x9B,0x91,0x58,0x24,0xC3,
    0xB4,0x18,0x7A,0x3C,0x3F,0x4B,0x04,0xBC,0xC6,0xF7,0xD8,0x72,0x8F,0x28,0xA1,0x72,
    0x5E,0x5E,0x25,0xD2,0xD8,0x2B,0x35,0x57
};
HI_U8 CW_S0_KL_2TDES_L2_TS_TCSA3_TA_ACTIVATION[] = {0xAA,0xAA,0x7E,0x7B,0x3D,0x5B,0x87,0xC4,0x81,0x1D,0x69,0xB8,0xC6,0x29,0x59,0x38};


//3.10	CW_S0_KL-2TDES_L3_TS-AES
static HI_U8 CW_S0_KL_2TDES_L3_TS_AES_CWAKp[] = {0x82,0xE2,0xE6,0x62,0xF7,0x28,0xB4,0xFA,0x42,0x48,0x5E,0x3A,0x0A,0x5D,0x2F,0x34};
static HI_U8 CW_S0_KL_2TDES_L3_TS_AES_CWSKp[] = {0xD4,0x71,0x3D,0x60,0xC8,0xA7,0x06,0x39,0xEB,0x11,0x67,0xB3,0x67,0xA9,0xC3,0x78};
static HI_U8 CW_S0_KL_2TDES_L3_TS_AES_CEK_p[] = {0xEF,0xCC,0x1E,0xD9,0xB5,0x76,0xB6,0x4D,0x37,0x1E,0x99,0x0F,0xEF,0x71,0x66,0x16};
HI_U8 Org_CW_S0_KL_2TDES_L3_TS_AES[188] = {
    0x47,0x42,0x10,0x90,0x3a,0xfc,0x36,0x8d,0x00,0x40,0x06,0xc0,0xe4,0xa6,0x6e,0x83,
    0x77,0x82,0x2c,0xd0,0x60,0xb3,0xc8,0xb7,0xa9,0x0f,0xb2,0x32,0x62,0x4d,0x1e,0x36,
    0x9c,0x9a,0x68,0x2b,0x6c,0xcd,0x88,0xb0,0x8a,0x24,0x0a,0xc9,0xcc,0xb8,0x09,0x1c,
    0xcb,0xb5,0xab,0xd3,0xb3,0x15,0x2f,0x76,0xe7,0xa1,0xc9,0x7b,0xbe,0x29,0x6e,0xf1,
    0xf5,0x98,0x4f,0x1c,0x94,0x4a,0x93,0xc7,0x25,0xe8,0xb9,0xd5,0x29,0x76,0xc8,0x66,
    0xbf,0xd6,0x82,0xfd,0x97,0xea,0xb0,0x7c,0x10,0x00,0x06,0x19,0x5f,0x44,0xcd,0x60,
    0xad,0xff,0x99,0xc9,0x67,0x8e,0x81,0x75,0x86,0xe4,0x70,0x26,0xad,0xe5,0x95,0x34,
    0x6a,0x57,0xd0,0x52,0xc9,0xe5,0x7b,0x4d,0xc4,0xff,0x2d,0xfe,0xcc,0x2b,0x7b,0x41,
    0x9e,0x5e,0x85,0xc8,0x4c,0x5d,0xdf,0xe5,0xd7,0xb4,0xb5,0xd2,0x21,0x20,0x4e,0x51,
    0x76,0x78,0x4d,0x75,0xc4,0xf2,0x5c,0xa1,0x3d,0x33,0x6f,0xad,0xe5,0x3d,0xf6,0xde,
    0xcf,0x8f,0x1f,0xc8,0xa7,0x82,0xf8,0x55,0x3d,0x4a,0x20,0xe2,0xa1,0x68,0x82,0xc0,
    0x3d,0xd6,0x8c,0x1a,0x07,0x06,0x05,0x04,0x03,0x02,0x01,0x00
};

//3.11	CW_S0_KL-2TDES_L3_TS-AES_TA
static HI_U8 CW_S0_KL_2TDES_L3_TS_AES_TA_TASKp[16]  = {0x23,0xA7,0x71,0x1A,0x81,0x33,0x28,0x76,0x37,0xEB,0xDC,0xD9,0xE8,0x7A,0x16,0x13};
static HI_U8 CW_S0_KL_2TDES_L3_TS_AES_TA_Transformation_Data[] = {
    0xF5,0x84,0xCF,0x33,0x02,0x7D,0xF5,0x0A,0x34,0x46,0x4A,0x56,0x73,0xA7,0x35,0x50,
    0x47,0xAA,0x38,0xFF,0xC4,0x62,0x88,0x85,0x27,0x8E,0x08,0x40,0x42,0x46,0x32,0x87,
    0x36,0x85,0xD8,0xAF,0xD1,0x06,0x72,0xDF,0xD5,0xFA,0x1B,0x3F,0x66,0x4D,0x4B,0xBA,
    0x79,0xD8,0x75,0xBD,0x06,0x56,0x48,0x54,0xCA,0x62,0x68,0x51,0x72,0xF4,0xC9,0x9B,
    0x32,0x78,0xFC,0xB8,0xFF,0xCA,0x6D,0x2C,0xA9,0xC3,0x82,0x4E,0xC5,0xE2,0x1A,0x42,
    0xAA,0x1C,0xC7,0x09,0xA2,0x4D,0xE6,0x23,0xE9,0xEB,0x2A,0xCA,0x9F,0xFE,0x29,0x3F,
    0xE4,0xA0,0xA2,0x7F,0x21,0x42,0x94,0xDC,0x29,0x22,0xBA,0xDF,0xE5,0x8D,0x95,0x72,
    0xDF,0xBC,0x73,0x09,0xBB,0xCC,0x72,0xB3,0xEF,0xB5,0x4D,0xA0,0x1A,0x97,0x89,0x68,
    0x55,0x54,0xAF,0x4A,0x59,0xF9,0x70,0xFE,0xCB,0xC2,0x2C,0x90,0xB8,0xD0,0x40,0xF5,
    0x71,0x68,0x41,0x95,0x54,0x03,0x4B,0x39,0x3E,0x5E,0x57,0x62,0xB7,0xC6,0x82,0x4A,
    0x79,0xE3,0xFC,0x31,0x44,0xEB,0x90,0x95,0x00,0x58,0x95,0xD1,0x13,0x1A,0x08,0x1E,
    0x5A,0xC0,0xAA,0x41,0x2D,0xB0,0xF6,0xD3,0xF1,0x50,0xF2,0x2E,0x8C,0x68,0x86,0x9A,
    0x9C,0xEA,0x30,0x7E,0x54,0x7E,0x3A,0x3C,0xFD,0xD4,0x08,0xFC,0x06,0xCD,0x17,0x47,
    0xD1,0x5A,0x55,0x87,0x91,0xFC,0xD5,0xF4,0x41,0x78,0x4A,0xE2,0x16,0x18,0xAD,0x2F,
    0x9F,0x92,0x3F,0x9A,0xF8,0xC3,0x09,0x61,0xEC,0xB2,0x0C,0x8B,0xA6,0x13,0x6F,0x25,
    0x3E,0x71,0x08,0x2C,0x9C,0x66,0xED,0x5B,0x10,0x3B,0xAC,0x21,0xEC,0x9D,0x7F,0x89,
    0x64,0x02,0x45,0xEB,0xDC,0x6A,0x3C,0x62,0xDD,0x84,0x8F,0x36,0x41,0x21,0xC7,0x9A,
    0x6E,0x7A,0xBC,0xCD,0xDD,0xA7,0x54,0xEB,0x45,0xA7,0x74,0x18,0x80,0x3C,0xC9,0x60,
    0x93,0x4E,0xA7,0x25,0x11,0x6A,0x43,0x25,0xB2,0xF7,0x0D,0xF9,0x96,0x6C,0xEB,0xF0,
    0xE5,0x5B,0xC4,0xFC,0x4A,0xCF,0xEE,0xF4,0x54,0xFD,0x83,0x8A,0x5D,0x5B,0x54,0x5F,
    0xF9,0x53,0x50,0xAF,0x2E,0x12,0x60,0xDB,0x4E,0x44,0x19,0x93,0x91,0xCC,0xCB,0x16,
    0xF0,0x0D,0xEC,0xB3,0x2A,0x1D,0x7D,0xBE,0x2B,0xF3,0xE6,0xEB,0x4B,0x9A,0xAA,0xA6,
    0x59,0x49,0x57,0xF8,0x29,0xF4,0xF2,0x26,0xB3,0xE0,0xDA,0xAF,0x8A,0x5F,0xD7,0x24,
    0xE4,0x49,0x0F,0x3D,0x83,0xE6,0xDC,0xA6,0x4D,0xDC,0xF0,0xEE,0x86,0x9A,0xB0,0x0B,
    0x54,0xB9,0x12,0xC3,0x93,0x0F,0x4F,0x59,0x3A,0x34,0xE9,0x04,0xA4,0x3F,0x51,0x5C,
    0xD2,0x16,0xE8,0x72,0x05,0x1F,0xA2,0x12,0x08,0x5B,0x33,0xC7,0xD6,0x5A,0x6D,0xA5,
};

static HI_U8 CW_S0_KL_2TDES_L3_TS_AES_TA_CWAKp[] = {0x82,0xE2,0xE6,0x62,0xF7,0x28,0xB4,0xFA,0x42,0x48,0x5E,0x3A,0x0A,0x5D,0x2F,0x34};
static HI_U8 CW_S0_KL_2TDES_L3_TS_AES_TA_CWSKp[] = {0xD4,0x71,0x3D,0x60,0xC8,0xA7,0x06,0x39,0xEB,0x11,0x67,0xB3,0x67,0xA9,0xC3,0x78};
static HI_U8 CW_S0_KL_2TDES_L3_TS_AES_TA_CEK_pT[] = {0x2E,0x0A,0x94,0xDC,0x18,0x6E,0x85,0x73,0x8C,0x7C,0x14,0xA0,0x13,0x79,0xE8,0x61};
static HI_U8 Org_CW_S0_KL_2TDES_L3_TS_AES_TA[188] = {
    0x47,0x42,0x10,0x90,0x3a,0xfc,0x36,0x8d,0x00,0x40,0x06,0xc0,0xe4,0xa6,0x6e,0x83,
    0x77,0x82,0x2c,0xd0,0x60,0xb3,0xc8,0xb7,0xa9,0x0f,0xb2,0x32,0x62,0x4d,0x1e,0x36,
    0x9c,0x9a,0x68,0x2b,0x6c,0xcd,0x88,0xb0,0x8a,0x24,0x0a,0xc9,0xcc,0xb8,0x09,0x1c,
    0xcb,0xb5,0xab,0xd3,0xb3,0x15,0x2f,0x76,0xe7,0xa1,0xc9,0x7b,0xbe,0x29,0x6e,0xf1,
    0xf5,0x98,0x4f,0x1c,0x94,0x4a,0x93,0xc7,0x25,0xe8,0xb9,0xd5,0x29,0x76,0xc8,0x66,
    0xbf,0xd6,0x82,0xfd,0x97,0xea,0xb0,0x7c,0x10,0x00,0x06,0x19,0x5f,0x44,0xcd,0x60,
    0xad,0xff,0x99,0xc9,0x67,0x8e,0x81,0x75,0x86,0xe4,0x70,0x26,0xad,0xe5,0x95,0x34,
    0x6a,0x57,0xd0,0x52,0xc9,0xe5,0x7b,0x4d,0xc4,0xff,0x2d,0xfe,0xcc,0x2b,0x7b,0x41,
    0x9e,0x5e,0x85,0xc8,0x4c,0x5d,0xdf,0xe5,0xd7,0xb4,0xb5,0xd2,0x21,0x20,0x4e,0x51,
    0x76,0x78,0x4d,0x75,0xc4,0xf2,0x5c,0xa1,0x3d,0x33,0x6f,0xad,0xe5,0x3d,0xf6,0xde,
    0xcf,0x8f,0x1f,0xc8,0xa7,0x82,0xf8,0x55,0x3d,0x4a,0x20,0xe2,0xa1,0x68,0x82,0xc0,
    0x3d,0xd6,0x8c,0x1a,0x07,0x06,0x05,0x04,0x03,0x02,0x01,0x00
};

//3.12	CW_S0_KL-2TDES_L3_TS-CSA
static HI_U8 CW_S0_KL_2TDES_L3_TS_CSA_CWAKp[] = {0xE3,0xE7,0x06,0x82,0xC2,0x09,0x4C,0xAC,0x62,0x9F,0x6F,0xBE,0xD8,0x2C,0x07,0xCD};
static HI_U8 CW_S0_KL_2TDES_L3_TS_CSA_CWSKp[] = {0x82,0xE2,0xE6,0x62,0xF7,0x28,0xB4,0xFA,0x42,0x48,0x5E,0x3A,0x0A,0x5D,0x2F,0x34};
static HI_U8 CW_S0_KL_2TDES_L3_TS_CSA_CEK_p[] = {0x3A,0xC6,0xD6,0x6F,0x5C,0x9B,0x8F,0x80,0x3A,0xC6,0xD6,0x6F,0x5C,0x9B,0x8F,0x80};
HI_U8 Org_CW_S0_KL_2TDES_L3_TS_CSA[188] = {
    0x47,0x42,0x10,0x90,0x4F,0x0C,0xCC,0xA6,0xD3,0xA2,0x71,0x41,0x2D,0xAA,0x76,0xD0,
    0xED,0x57,0xC0,0xC5,0x00,0xAA,0xF2,0xA4,0x5C,0xE9,0xF6,0x2E,0xA4,0x06,0xAC,0x41,
    0x5E,0xDC,0x42,0xD9,0x8A,0x76,0x4E,0x45,0xBF,0xC0,0xE7,0xE9,0x9C,0x83,0x95,0xF6,
    0x22,0xF5,0x3D,0xFA,0x92,0x76,0xBF,0x17,0x40,0x59,0x88,0xE0,0x45,0xC9,0xE3,0x47,
    0xDD,0x68,0x4E,0x94,0x00,0x2A,0x43,0x36,0xF6,0xBB,0xF2,0x99,0x9D,0x4E,0x5C,0x76,
    0xAC,0x54,0x6C,0xB7,0xDA,0x69,0x22,0x40,0x58,0x22,0x27,0xB9,0xB5,0xD2,0x21,0x69,
    0x96,0x24,0x9D,0xCF,0xD7,0x8E,0xF6,0x7D,0xF0,0xFC,0x10,0x4B,0xC8,0x63,0xC8,0x3A,
    0x76,0x4A,0x25,0x05,0x58,0x3D,0xDE,0xE6,0xA9,0x8B,0x79,0xF4,0x73,0xCD,0xEF,0xC6,
    0xA7,0x43,0x76,0xC5,0xF2,0x64,0x47,0x4B,0x89,0xB1,0x07,0xB2,0xA4,0xC1,0x95,0xFC,
    0x94,0xA9,0xC3,0xBA,0x82,0x5C,0xB0,0xDF,0xDA,0x11,0x9F,0xE1,0x31,0x44,0x3F,0x48,
    0xF9,0x41,0xD2,0x97,0x99,0x78,0x73,0x16,0x8E,0xB3,0x43,0x10,0x5A,0x41,0x4B,0x12,
    0x87,0x69,0xC7,0x5D,0x70,0xB9,0x6F,0x3C,0x8D,0x00,0x8D,0xBA
};

//3.13	CW_S0_KL-2TDES_L3_TS-CSA_TA
static HI_U8 CW_S0_KL_2TDES_L3_TS_CSA_TA_CWAKp[]  = {0xE3,0xE7,0x06,0x82,0xC2,0x09,0x4C,0xAC,0x62,0x9F,0x6F,0xBE,0xD8,0x2C,0x07,0xCD};
static HI_U8 CW_S0_KL_2TDES_L3_TS_CSA_TA_CWSKp[]  = {0x82,0xE2,0xE6,0x62,0xF7,0x28,0xB4,0xFA,0x42,0x48,0x5E,0x3A,0x0A,0x5D,0x2F,0x34};
static HI_U8 CW_S0_KL_2TDES_L3_TS_CSA_TA_TASKp[]  = {0xD4,0x71,0x3D,0x60,0xC8,0xA7,0x06,0x39,0xEB,0x11,0x67,0xB3,0x67,0xA9,0xC3,0x78};
HI_U8 CW_S0_KL_2TDES_L3_TS_CSA_TA_Transformation_Data[] = {
    0x4A,0x6F,0xF6,0x0B,0xD6,0xD0,0xB9,0xC0,0xBD,0x73,0x56,0x6B,0x2C,0x33,0x0D,0x1E,
    0xC6,0xDC,0x09,0x7D,0x64,0xCA,0xA5,0x39,0xB9,0xA6,0x08,0x34,0xF1,0x34,0x97,0x56,
    0x84,0x9F,0xB6,0x6A,0xC0,0x21,0x63,0xFD,0xD0,0xCB,0x61,0xD4,0x1A,0x3C,0x54,0xE8,
    0x6A,0x5E,0xFA,0xEE,0xFA,0x3A,0xAE,0xB7,0x0D,0x1C,0x87,0x45,0x8A,0x6C,0xEE,0x58,
    0xB3,0x76,0xE1,0x8A,0xF3,0xDD,0xCE,0xF1,0x4E,0x99,0x35,0xC7,0x57,0x9D,0xEA,0x4C,
    0x56,0xDE,0x3F,0xF7,0x3D,0xFB,0xCF,0x14,0x61,0x74,0x66,0xE7,0x66,0x38,0xC7,0xAA,
    0x5C,0xD0,0x0A,0xD1,0x90,0xB8,0xB3,0x84,0x33,0x81,0xB9,0xAA,0x55,0x3F,0x12,0x1B,
    0xA4,0x1D,0xA2,0x37,0x54,0xCF,0xB8,0x10,0x75,0x17,0x25,0xF1,0x29,0x46,0x52,0x70,
    0x0F,0x8A,0x7F,0x84,0xDF,0x11,0x7C,0xEF,0x4B,0x81,0x88,0xB9,0x3E,0x34,0xEC,0x29,
    0xA8,0x35,0xBC,0xE9,0xD8,0x1A,0x58,0x1A,0xE6,0x64,0xB5,0x4F,0xCA,0xBC,0x6E,0xD7,
    0x3B,0x62,0xC4,0x5E,0xFC,0x10,0x8B,0x3E,0x51,0xB0,0xC6,0x88,0x6F,0x73,0x18,0x0F,
    0x53,0x28,0x2F,0x92,0x9A,0x1C,0xFB,0xAE,0xD4,0xDE,0xDF,0x01,0xCE,0x98,0x68,0xFA,
    0x9E,0xB1,0xA8,0x99,0x57,0xB0,0x6D,0xCB,0x66,0xEF,0x43,0x1A,0x34,0x34,0x73,0x1C,
    0x5D,0x88,0x67,0xAA,0xE6,0x1B,0x02,0xED,0x4C,0x72,0xFF,0xDC,0xCD,0xE5,0xF9,0x9E,
    0xD2,0xA7,0x5A,0x76,0x8F,0xC8,0xDA,0x5C,0xEB,0x71,0xF8,0x81,0x55,0xD1,0xDE,0x75,
    0xF7,0x07,0x7C,0xFA,0xEE,0xAD,0xC8,0xDC,0xE7,0x8C,0x07,0x71,0x40,0xAE,0x00,0xCC,
    0xE7,0x93,0xF6,0x6C,0x6B,0x35,0xAD,0x56,0x5A,0x5F,0x59,0x42,0x53,0x08,0xDC,0x51,
    0x6A,0x67,0x37,0xAE,0x6E,0xFB,0xB4,0xCD,0x04,0xEB,0x24,0x6F,0x15,0xBE,0x46,0x7B,
    0x12,0x76,0xAA,0x7B,0x2F,0xB9,0x96,0x60,0x0E,0x77,0x3E,0xD7,0x43,0x41,0x7B,0x7C,
    0xBF,0x9F,0x98,0xF5,0x9D,0x58,0xFA,0x77,0x85,0x29,0x3C,0xE2,0x2D,0xAA,0x41,0x7C,
    0x22,0x7C,0x7D,0xCF,0xB0,0xAF,0x0C,0x96,0x3F,0x95,0x89,0xE2,0xC0,0xA8,0xD2,0xF7,
    0xA8,0x98,0xAD,0x95,0x3F,0xB6,0xB5,0xA2,0x9A,0x0D,0xAF,0x86,0xB3,0x8D,0x05,0xAC,
    0x9E,0x53,0x8F,0x88,0x1F,0x86,0xDD,0xD5,0x43,0xD1,0xBE,0x3A,0x18,0x36,0x9A,0x29,
    0xF5,0xFC,0xFC,0xA7,0xE3,0xE6,0xCE,0x82,0x47,0x43,0xAB,0x1D,0x10,0x73,0x36,0xD5,
    0xF5,0x56,0xBE,0x5D,0xAA,0x27,0x05,0xB9,0xB8,0x42,0xF5,0x6F,0xB6,0x6D,0x5A,0x2D,
    0xA7,0x71,0x38,0x24,0xF7,0xE1,0xC4,0x76,0x19,0x98,0x51,0x2D,0x94,0x07,0xD6,0x0C,
};
HI_U8 CW_S0_KL_2TDES_L3_TS_CSA_TA_CEK_pT[] = {0xE9,0xA3,0xFD,0xFA,0x15,0xFB,0xBC,0xE0,0xE9,0xA3,0xFD,0xFA,0x15,0xFB,0xBC,0xE0};
HI_U8 Org_CW_S0_KL_2TDES_L3_TS_CSA_TA[188] = {
    0x47,0x42,0x10,0x90,0x4F,0x0C,0xCC,0xA6,0xD3,0xA2,0x71,0x41,0x2D,0xAA,0x76,0xD0,0xED,0x57,0xC0,0xC5,
    0x00,0xAA,0xF2,0xA4,0x5C,0xE9,0xF6,0x2E,0xA4,0x06,0xAC,0x41,0x5E,0xDC,0x42,0xD9,
    0x8A,0x76,0x4E,0x45,0xBF,0xC0,0xE7,0xE9,0x9C,0x83,0x95,0xF6,0x22,0xF5,0x3D,0xFA,
    0x92,0x76,0xBF,0x17,0x40,0x59,0x88,0xE0,0x45,0xC9,0xE3,0x47,0xDD,0x68,0x4E,0x94,
    0x00,0x2A,0x43,0x36,0xF6,0xBB,0xF2,0x99,0x9D,0x4E,0x5C,0x76,0xAC,0x54,0x6C,0xB7,
    0xDA,0x69,0x22,0x40,0x58,0x22,0x27,0xB9,0xB5,0xD2,0x21,0x69,0x96,0x24,0x9D,0xCF,
    0xD7,0x8E,0xF6,0x7D,0xF0,0xFC,0x10,0x4B,0xC8,0x63,0xC8,0x3A,0x76,0x4A,0x25,0x05,
    0x58,0x3D,0xDE,0xE6,0xA9,0x8B,0x79,0xF4,0x73,0xCD,0xEF,0xC6,0xA7,0x43,0x76,0xC5,
    0xF2,0x64,0x47,0x4B,0x89,0xB1,0x07,0xB2,0xA4,0xC1,0x95,0xFC,0x94,0xA9,0xC3,0xBA,
    0x82,0x5C,0xB0,0xDF,0xDA,0x11,0x9F,0xE1,0x31,0x44,0x3F,0x48,0xF9,0x41,0xD2,0x97,
    0x99,0x78,0x73,0x16,0x8E,0xB3,0x43,0x10,0x5A,0x41,0x4B,0x12,0x87,0x69,0xC7,0x5D,
    0x70,0xB9,0x6F,0x3C,0x8D,0x00,0x8D,0xBA
};

//3.14	CW_S0_KL-2TDES_L3_TS-CSA3
static HI_U8 CW_S0_KL_2TDES_L3_TS_CSA3_CWAKp[] = {0xE3,0xE7,0x06,0x82,0xC2,0x09,0x4C,0xAC,0x62,0x9F,0x6F,0xBE,0xD8,0x2C,0x07,0xCD};
static HI_U8 CW_S0_KL_2TDES_L3_TS_CSA3_CWSKp[] = {0x82,0xE2,0xE6,0x62,0xF7,0x28,0xB4,0xFA,0x42,0x48,0x5E,0x3A,0x0A,0x5D,0x2F,0x34};
static HI_U8 CW_S0_KL_2TDES_L3_TS_CSA3_CEK_p[] = {0x11,0x1F,0x99,0x69,0x1D,0x0E,0xF7,0x31,0xAD,0xF6,0x0E,0x7F,0x16,0x08,0x89,0x84};
HI_U8 Org_CW_S0_KL_2TDES_L3_TS_CSA3[188] = {
    0x47,0x42,0x10,0x90,0x14,0x5C,0x5D,0x60,0xDE,0x00,0x06,0xBD,0x87,0xED,0xBE,0x80,
    0x55,0xB7,0xEF,0xE3,0xA1,0x29,0x1A,0x52,0xB8,0x22,0xDB,0x12,0xA1,0x8A,0x6B,0x1A,
    0x9F,0x2B,0x4C,0xD8,0x9B,0x68,0x38,0x39,0x1E,0xEF,0xB5,0x4F,0xF7,0xA2,0x7D,0xB9,
    0x5A,0xCA,0xE2,0xDC,0x33,0x44,0xAB,0x2F,0x58,0xB7,0xB0,0x85,0x26,0x68,0x5B,0x67,
    0xA0,0x28,0x33,0x4E,0xAB,0x11,0xF2,0x37,0x7B,0xA6,0xBC,0x54,0xE0,0x26,0x02,0x3D,
    0x54,0x57,0x61,0xD2,0x76,0x62,0xC0,0xCE,0x04,0xB4,0xC8,0x63,0x2F,0x4C,0x2E,0x8C,
    0x89,0x95,0x37,0xAD,0x9A,0xDB,0x2A,0x05,0x2A,0x7A,0xB6,0x75,0x3F,0x8B,0x3C,0x2A,
    0xA4,0x0F,0x4B,0x42,0x4E,0xE7,0x51,0x2A,0xE4,0xF5,0x9A,0x6A,0x64,0x4B,0x4A,0x4D,
    0x27,0x82,0x7F,0x2B,0x48,0xFE,0x38,0x0F,0x5B,0x6D,0xE3,0x2D,0x94,0x84,0x47,0x44,
    0xD7,0xD7,0x7D,0xF3,0x0C,0xFE,0xED,0x8C,0xB6,0x77,0xE9,0x88,0x00,0xEB,0xC6,0x78,
    0x3C,0x09,0x66,0x55,0x9E,0x01,0x97,0x8F,0xC0,0xDC,0xDD,0x2E,0x6F,0xDF,0x85,0x5E,
    0xFB,0xBD,0x73,0x91,0xF2,0x28,0x94,0x33,0x90,0xFA,0xDB,0xBD
};

//3.15	CW_S0_KL-2TDES_L3_TS-CSA3_TA
static HI_U8 CW_S0_KL_2TDES_L3_TS_CSA3_TA_CWAKp[]  = {0xE3,0xE7,0x06,0x82,0xC2,0x09,0x4C,0xAC,0x62,0x9F,0x6F,0xBE,0xD8,0x2C,0x07,0xCD};
static HI_U8 CW_S0_KL_2TDES_L3_TS_CSA3_TA_CWSKp[]  = {0x82,0xE2,0xE6,0x62,0xF7,0x28,0xB4,0xFA,0x42,0x48,0x5E,0x3A,0x0A,0x5D,0x2F,0x34};
static HI_U8 CW_S0_KL_2TDES_L3_TS_CSA3_TA_TASKp[]  = {0xD4,0x71,0x3D,0x60,0xC8,0xA7,0x06,0x39,0xEB,0x11,0x67,0xB3,0x67,0xA9,0xC3,0x78};
HI_U8 CW_S0_KL_2TDES_L3_TS_CSA3_TA_Transformation_Data[] = {
    0x4A,0x6F,0xF6,0x0B,0xD6,0xD0,0xB9,0xC0,0xBD,0x73,0x56,0x6B,0x2C,0x33,0x0D,0x1E,
    0xC6,0xDC,0x09,0x7D,0x64,0xCA,0xA5,0x39,0xB9,0xA6,0x08,0x34,0xF1,0x34,0x97,0x56,
    0x84,0x9F,0xB6,0x6A,0xC0,0x21,0x63,0xFD,0xD0,0xCB,0x61,0xD4,0x1A,0x3C,0x54,0xE8,
    0x6A,0x5E,0xFA,0xEE,0xFA,0x3A,0xAE,0xB7,0x0D,0x1C,0x87,0x45,0x8A,0x6C,0xEE,0x58,
    0xB3,0x76,0xE1,0x8A,0xF3,0xDD,0xCE,0xF1,0x4E,0x99,0x35,0xC7,0x57,0x9D,0xEA,0x4C,
    0x56,0xDE,0x3F,0xF7,0x3D,0xFB,0xCF,0x14,0x61,0x74,0x66,0xE7,0x66,0x38,0xC7,0xAA,
    0x5C,0xD0,0x0A,0xD1,0x90,0xB8,0xB3,0x84,0x33,0x81,0xB9,0xAA,0x55,0x3F,0x12,0x1B,
    0xA4,0x1D,0xA2,0x37,0x54,0xCF,0xB8,0x10,0x75,0x17,0x25,0xF1,0x29,0x46,0x52,0x70,
    0x0F,0x8A,0x7F,0x84,0xDF,0x11,0x7C,0xEF,0x4B,0x81,0x88,0xB9,0x3E,0x34,0xEC,0x29,
    0xA8,0x35,0xBC,0xE9,0xD8,0x1A,0x58,0x1A,0xE6,0x64,0xB5,0x4F,0xCA,0xBC,0x6E,0xD7,
    0x3B,0x62,0xC4,0x5E,0xFC,0x10,0x8B,0x3E,0x51,0xB0,0xC6,0x88,0x6F,0x73,0x18,0x0F,
    0x53,0x28,0x2F,0x92,0x9A,0x1C,0xFB,0xAE,0xD4,0xDE,0xDF,0x01,0xCE,0x98,0x68,0xFA,
    0x9E,0xB1,0xA8,0x99,0x57,0xB0,0x6D,0xCB,0x66,0xEF,0x43,0x1A,0x34,0x34,0x73,0x1C,
    0x5D,0x88,0x67,0xAA,0xE6,0x1B,0x02,0xED,0x4C,0x72,0xFF,0xDC,0xCD,0xE5,0xF9,0x9E,
    0xD2,0xA7,0x5A,0x76,0x8F,0xC8,0xDA,0x5C,0xEB,0x71,0xF8,0x81,0x55,0xD1,0xDE,0x75,
    0xF7,0x07,0x7C,0xFA,0xEE,0xAD,0xC8,0xDC,0xE7,0x8C,0x07,0x71,0x40,0xAE,0x00,0xCC,
    0xE7,0x93,0xF6,0x6C,0x6B,0x35,0xAD,0x56,0x5A,0x5F,0x59,0x42,0x53,0x08,0xDC,0x51,
    0x6A,0x67,0x37,0xAE,0x6E,0xFB,0xB4,0xCD,0x04,0xEB,0x24,0x6F,0x15,0xBE,0x46,0x7B,
    0x12,0x76,0xAA,0x7B,0x2F,0xB9,0x96,0x60,0x0E,0x77,0x3E,0xD7,0x43,0x41,0x7B,0x7C,
    0xBF,0x9F,0x98,0xF5,0x9D,0x58,0xFA,0x77,0x85,0x29,0x3C,0xE2,0x2D,0xAA,0x41,0x7C,
    0x22,0x7C,0x7D,0xCF,0xB0,0xAF,0x0C,0x96,0x3F,0x95,0x89,0xE2,0xC0,0xA8,0xD2,0xF7,
    0xA8,0x98,0xAD,0x95,0x3F,0xB6,0xB5,0xA2,0x9A,0x0D,0xAF,0x86,0xB3,0x8D,0x05,0xAC,
    0x9E,0x53,0x8F,0x88,0x1F,0x86,0xDD,0xD5,0x43,0xD1,0xBE,0x3A,0x18,0x36,0x9A,0x29,
    0xF5,0xFC,0xFC,0xA7,0xE3,0xE6,0xCE,0x82,0x47,0x43,0xAB,0x1D,0x10,0x73,0x36,0xD5,
    0xF5,0x56,0xBE,0x5D,0xAA,0x27,0x05,0xB9,0xB8,0x42,0xF5,0x6F,0xB6,0x6D,0x5A,0x2D,
    0xA7,0x71,0x38,0x24,0xF7,0xE1,0xC4,0x76,0x19,0x98,0x51,0x2D,0x94,0x07,0xD6,0x0C,
};
HI_U8 CW_S0_KL_2TDES_L3_TS_CSA3_TA_CEK_pT[] = {0xB7,0xB9,0x14,0x01,0x9A,0x84,0x57,0xC7,0xDD,0x4B,0x0E,0x74,0xC4,0x3A,0xE6,0x0A};
HI_U8 Org_CW_S0_KL_2TDES_L3_TS_CSA3_TA[188] = {
    0x47,0x42,0x10,0x90,0x14,0x5C,0x5D,0x60,0xDE,0x00,0x06,0xBD,0x87,0xED,0xBE,0x80,
    0x55,0xB7,0xEF,0xE3,0xA1,0x29,0x1A,0x52,0xB8,0x22,0xDB,0x12,0xA1,0x8A,0x6B,0x1A,
    0x9F,0x2B,0x4C,0xD8,0x9B,0x68,0x38,0x39,0x1E,0xEF,0xB5,0x4F,0xF7,0xA2,0x7D,0xB9,
    0x5A,0xCA,0xE2,0xDC,0x33,0x44,0xAB,0x2F,0x58,0xB7,0xB0,0x85,0x26,0x68,0x5B,0x67,
    0xA0,0x28,0x33,0x4E,0xAB,0x11,0xF2,0x37,0x7B,0xA6,0xBC,0x54,0xE0,0x26,0x02,0x3D,
    0x54,0x57,0x61,0xD2,0x76,0x62,0xC0,0xCE,0x04,0xB4,0xC8,0x63,0x2F,0x4C,0x2E,0x8C,
    0x89,0x95,0x37,0xAD,0x9A,0xDB,0x2A,0x05,0x2A,0x7A,0xB6,0x75,0x3F,0x8B,0x3C,0x2A,
    0xA4,0x0F,0x4B,0x42,0x4E,0xE7,0x51,0x2A,0xE4,0xF5,0x9A,0x6A,0x64,0x4B,0x4A,0x4D,
    0x27,0x82,0x7F,0x2B,0x48,0xFE,0x38,0x0F,0x5B,0x6D,0xE3,0x2D,0x94,0x84,0x47,0x44,
    0xD7,0xD7,0x7D,0xF3,0x0C,0xFE,0xED,0x8C,0xB6,0x77,0xE9,0x88,0x00,0xEB,0xC6,0x78,
    0x3C,0x09,0x66,0x55,0x9E,0x01,0x97,0x8F,0xC0,0xDC,0xDD,0x2E,0x6F,0xDF,0x85,0x5E,
    0xFB,0xBD,0x73,0x91,0xF2,0x28,0x94,0x33,0x90,0xFA,0xDB,0xBD
};

//3.16	CW_S0_KL-2TDES_L3_TS-TCSA3
static HI_U8 CW_S0_KL_2TDES_L3_TS_TCSA3_CWAKp[] = {0xE3,0xE7,0x06,0x82,0xC2,0x09,0x4C,0xAC,0x62,0x9F,0x6F,0xBE,0xD8,0x2C,0x07,0xCD};
static HI_U8 CW_S0_KL_2TDES_L3_TS_TCSA3_CWSKp[] = {0x82,0xE2,0xE6,0x62,0xF7,0x28,0xB4,0xFA,0x42,0x48,0x5E,0x3A,0x0A,0x5D,0x2F,0x34};
static HI_U8 CW_S0_KL_2TDES_L3_TS_TCSA3_CEK_p[] = {0x11,0x1F,0x99,0x69,0x1D,0x0E,0xF7,0x31,0xAD,0xF6,0x0E,0x7F,0x16,0x08,0x89,0x84};
HI_U8 Org_CW_S0_KL_2TDES_L3_TS_TCSA3[188] = {
    0x47,0x42,0x10,0x90,0xE6,0x34,0x0B,0x6E,0xBA,0x46,0xF2,0xD4,0x12,0x25,0xF0,0xD7,0x1C,0xCC,0xF3,0x45,
    0x57,0x94,0x82,0x74,0xEA,0x50,0x44,0x87,0xB8,0x33,0xAF,0x09,0xF6,0x62,0x5C,0x12,
    0xCF,0x71,0x83,0x34,0x59,0xC8,0xE3,0x1F,0x66,0xFF,0xD7,0x3B,0x04,0x9C,0xF4,0xB1,
    0xC5,0x61,0xE2,0x74,0xAA,0xA8,0xCD,0xCA,0x88,0x13,0xAF,0x18,0x8D,0x71,0x3F,0x88,
    0x39,0xA4,0xC1,0xC3,0x9F,0x4A,0x40,0x9C,0xAA,0xF9,0x27,0xFD,0xF8,0x9A,0xFB,0xE5,
    0x2E,0x67,0x79,0xD3,0xF2,0x3B,0x5F,0x95,0x45,0x58,0xEB,0x38,0xF3,0x9B,0x66,0x7B,
    0xA0,0x1B,0xEE,0x32,0x4D,0xAA,0x0A,0x26,0xE8,0x59,0x10,0xDD,0x8B,0x9F,0x8A,0x43,
    0xDF,0xBA,0x85,0x41,0x45,0x40,0xF1,0x95,0xA7,0xA0,0x0D,0x10,0x2D,0x97,0xE3,0x17,
    0x55,0x62,0x26,0xB2,0xB3,0xE6,0xFD,0xC5,0x13,0x76,0x61,0x79,0xB9,0xB3,0xA9,0x34,
    0x80,0xC4,0x1D,0x90,0x33,0x68,0xAD,0xC6,0xB8,0x18,0x3C,0x9B,0x91,0x58,0x24,0xC3,
    0xB4,0x18,0x7A,0x3C,0x3F,0x4B,0x04,0xBC,0xC6,0xF7,0xD8,0x72,0x8F,0x28,0xA1,0x72,
    0x5E,0x5E,0x25,0xD2,0xD8,0x2B,0x35,0x57,
};
HI_U8 CW_S0_KL_2TDES_L3_TS_TCSA3_ACTIVATION[] = {0x5E,0xBC,0xFC,0x75,0x9B,0x30,0xB3,0x2B,0x75,0x0B,0xEB,0xB6,0x60,0x42,0x6D,0xD7};

//3.17	CW_S0_KL-2TDES_L3_TS-TCSA3_TA
static HI_U8 CW_S0_KL_2TDES_L3_TS_TCSA3_TA_CWAKp[]  = {0xE3,0xE7,0x06,0x82,0xC2,0x09,0x4C,0xAC,0x62,0x9F,0x6F,0xBE,0xD8,0x2C,0x07,0xCD};
static HI_U8 CW_S0_KL_2TDES_L3_TS_TCSA3_TA_CWSKp[]  = {0x82,0xE2,0xE6,0x62,0xF7,0x28,0xB4,0xFA,0x42,0x48,0x5E,0x3A,0x0A,0x5D,0x2F,0x34};
static HI_U8 CW_S0_KL_2TDES_L3_TS_TCSA3_TA_TASKp[]  = {0xD4,0x71,0x3D,0x60,0xC8,0xA7,0x06,0x39,0xEB,0x11,0x67,0xB3,0x67,0xA9,0xC3,0x78};
HI_U8 CW_S0_KL_2TDES_L3_TS_TCSA3_TA_Transformation_Data[] = {
    0x4A,0x6F,0xF6,0x0B,0xD6,0xD0,0xB9,0xC0,0xBD,0x73,0x56,0x6B,0x2C,0x33,0x0D,0x1E,
    0xC6,0xDC,0x09,0x7D,0x64,0xCA,0xA5,0x39,0xB9,0xA6,0x08,0x34,0xF1,0x34,0x97,0x56,
    0x84,0x9F,0xB6,0x6A,0xC0,0x21,0x63,0xFD,0xD0,0xCB,0x61,0xD4,0x1A,0x3C,0x54,0xE8,
    0x6A,0x5E,0xFA,0xEE,0xFA,0x3A,0xAE,0xB7,0x0D,0x1C,0x87,0x45,0x8A,0x6C,0xEE,0x58,
    0xB3,0x76,0xE1,0x8A,0xF3,0xDD,0xCE,0xF1,0x4E,0x99,0x35,0xC7,0x57,0x9D,0xEA,0x4C,
    0x56,0xDE,0x3F,0xF7,0x3D,0xFB,0xCF,0x14,0x61,0x74,0x66,0xE7,0x66,0x38,0xC7,0xAA,
    0x5C,0xD0,0x0A,0xD1,0x90,0xB8,0xB3,0x84,0x33,0x81,0xB9,0xAA,0x55,0x3F,0x12,0x1B,
    0xA4,0x1D,0xA2,0x37,0x54,0xCF,0xB8,0x10,0x75,0x17,0x25,0xF1,0x29,0x46,0x52,0x70,
    0x0F,0x8A,0x7F,0x84,0xDF,0x11,0x7C,0xEF,0x4B,0x81,0x88,0xB9,0x3E,0x34,0xEC,0x29,
    0xA8,0x35,0xBC,0xE9,0xD8,0x1A,0x58,0x1A,0xE6,0x64,0xB5,0x4F,0xCA,0xBC,0x6E,0xD7,
    0x3B,0x62,0xC4,0x5E,0xFC,0x10,0x8B,0x3E,0x51,0xB0,0xC6,0x88,0x6F,0x73,0x18,0x0F,
    0x53,0x28,0x2F,0x92,0x9A,0x1C,0xFB,0xAE,0xD4,0xDE,0xDF,0x01,0xCE,0x98,0x68,0xFA,
    0x9E,0xB1,0xA8,0x99,0x57,0xB0,0x6D,0xCB,0x66,0xEF,0x43,0x1A,0x34,0x34,0x73,0x1C,
    0x5D,0x88,0x67,0xAA,0xE6,0x1B,0x02,0xED,0x4C,0x72,0xFF,0xDC,0xCD,0xE5,0xF9,0x9E,
    0xD2,0xA7,0x5A,0x76,0x8F,0xC8,0xDA,0x5C,0xEB,0x71,0xF8,0x81,0x55,0xD1,0xDE,0x75,
    0xF7,0x07,0x7C,0xFA,0xEE,0xAD,0xC8,0xDC,0xE7,0x8C,0x07,0x71,0x40,0xAE,0x00,0xCC,
    0xE7,0x93,0xF6,0x6C,0x6B,0x35,0xAD,0x56,0x5A,0x5F,0x59,0x42,0x53,0x08,0xDC,0x51,
    0x6A,0x67,0x37,0xAE,0x6E,0xFB,0xB4,0xCD,0x04,0xEB,0x24,0x6F,0x15,0xBE,0x46,0x7B,
    0x12,0x76,0xAA,0x7B,0x2F,0xB9,0x96,0x60,0x0E,0x77,0x3E,0xD7,0x43,0x41,0x7B,0x7C,
    0xBF,0x9F,0x98,0xF5,0x9D,0x58,0xFA,0x77,0x85,0x29,0x3C,0xE2,0x2D,0xAA,0x41,0x7C,
    0x22,0x7C,0x7D,0xCF,0xB0,0xAF,0x0C,0x96,0x3F,0x95,0x89,0xE2,0xC0,0xA8,0xD2,0xF7,
    0xA8,0x98,0xAD,0x95,0x3F,0xB6,0xB5,0xA2,0x9A,0x0D,0xAF,0x86,0xB3,0x8D,0x05,0xAC,
    0x9E,0x53,0x8F,0x88,0x1F,0x86,0xDD,0xD5,0x43,0xD1,0xBE,0x3A,0x18,0x36,0x9A,0x29,
    0xF5,0xFC,0xFC,0xA7,0xE3,0xE6,0xCE,0x82,0x47,0x43,0xAB,0x1D,0x10,0x73,0x36,0xD5,
    0xF5,0x56,0xBE,0x5D,0xAA,0x27,0x05,0xB9,0xB8,0x42,0xF5,0x6F,0xB6,0x6D,0x5A,0x2D,
    0xA7,0x71,0x38,0x24,0xF7,0xE1,0xC4,0x76,0x19,0x98,0x51,0x2D,0x94,0x07,0xD6,0x0C,
};
HI_U8 CW_S0_KL_2TDES_L3_TS_TCSA3_TA_CEK_pT[] = {0xB7,0xB9,0x14,0x01,0x9A,0x84,0x57,0xC7,0xDD,0x4B,0x0E,0x74,0xC4,0x3A,0xE6,0x0A};
HI_U8 Org_CW_S0_KL_2TDES_L3_TS_TCSA3_TA[188] = {
    0x47,0x42,0x10,0x90,0xE6,0x34,0x0B,0x6E,0xBA,0x46,0xF2,0xD4,0x12,0x25,0xF0,0xD7,0x1C,0xCC,0xF3,0x45,
    0x57,0x94,0x82,0x74,0xEA,0x50,0x44,0x87,0xB8,0x33,0xAF,0x09,0xF6,0x62,0x5C,0x12,
    0xCF,0x71,0x83,0x34,0x59,0xC8,0xE3,0x1F,0x66,0xFF,0xD7,0x3B,0x04,0x9C,0xF4,0xB1,
    0xC5,0x61,0xE2,0x74,0xAA,0xA8,0xCD,0xCA,0x88,0x13,0xAF,0x18,0x8D,0x71,0x3F,0x88,
    0x39,0xA4,0xC1,0xC3,0x9F,0x4A,0x40,0x9C,0xAA,0xF9,0x27,0xFD,0xF8,0x9A,0xFB,0xE5,
    0x2E,0x67,0x79,0xD3,0xF2,0x3B,0x5F,0x95,0x45,0x58,0xEB,0x38,0xF3,0x9B,0x66,0x7B,
    0xA0,0x1B,0xEE,0x32,0x4D,0xAA,0x0A,0x26,0xE8,0x59,0x10,0xDD,0x8B,0x9F,0x8A,0x43,
    0xDF,0xBA,0x85,0x41,0x45,0x40,0xF1,0x95,0xA7,0xA0,0x0D,0x10,0x2D,0x97,0xE3,0x17,
    0x55,0x62,0x26,0xB2,0xB3,0xE6,0xFD,0xC5,0x13,0x76,0x61,0x79,0xB9,0xB3,0xA9,0x34,
    0x80,0xC4,0x1D,0x90,0x33,0x68,0xAD,0xC6,0xB8,0x18,0x3C,0x9B,0x91,0x58,0x24,0xC3,
    0xB4,0x18,0x7A,0x3C,0x3F,0x4B,0x04,0xBC,0xC6,0xF7,0xD8,0x72,0x8F,0x28,0xA1,0x72,
    0x5E,0x5E,0x25,0xD2,0xD8,0x2B,0x35,0x57
};
HI_U8 CW_S0_KL_2TDES_L3_TS_TCSA3_TA_ACTIVATION[] = {0x5E,0xBC,0xFC,0x75,0x9B,0x30,0xB3,0x2B,0x75,0x0B,0xEB,0xB6,0x60,0x42,0x6D,0xD7};

//3.18	CW_S0_KL-AES_L2_TS-AES
static HI_U8 CW_S0_KL_AES_L2_TS_AES_CWSKp[] = {0x82,0xE2,0xE6,0x62,0xF7,0x28,0xB4,0xFA,0x42,0x48,0x5E,0x3A,0x0A,0x5D,0x2F,0x34};
static HI_U8 CW_S0_KL_AES_L2_TS_AES_CEK_p[] = {0x7F,0x26,0x43,0x38,0xE9,0xC0,0xA9,0xC9,0xDE,0x65,0x41,0x3D,0xAF,0x84,0xF6,0x86};
HI_U8 Org_CW_S0_KL_AES_L2_TS_AES[188] = {
    0x47,0x42,0x10,0x90,0x3a,0xfc,0x36,0x8d,0x00,0x40,0x06,0xc0,0xe4,0xa6,0x6e,0x83,
    0x77,0x82,0x2c,0xd0,0x60,0xb3,0xc8,0xb7,0xa9,0x0f,0xb2,0x32,0x62,0x4d,0x1e,0x36,
    0x9c,0x9a,0x68,0x2b,0x6c,0xcd,0x88,0xb0,0x8a,0x24,0x0a,0xc9,0xcc,0xb8,0x09,0x1c,
    0xcb,0xb5,0xab,0xd3,0xb3,0x15,0x2f,0x76,0xe7,0xa1,0xc9,0x7b,0xbe,0x29,0x6e,0xf1,
    0xf5,0x98,0x4f,0x1c,0x94,0x4a,0x93,0xc7,0x25,0xe8,0xb9,0xd5,0x29,0x76,0xc8,0x66,
    0xbf,0xd6,0x82,0xfd,0x97,0xea,0xb0,0x7c,0x10,0x00,0x06,0x19,0x5f,0x44,0xcd,0x60,
    0xad,0xff,0x99,0xc9,0x67,0x8e,0x81,0x75,0x86,0xe4,0x70,0x26,0xad,0xe5,0x95,0x34,
    0x6a,0x57,0xd0,0x52,0xc9,0xe5,0x7b,0x4d,0xc4,0xff,0x2d,0xfe,0xcc,0x2b,0x7b,0x41,
    0x9e,0x5e,0x85,0xc8,0x4c,0x5d,0xdf,0xe5,0xd7,0xb4,0xb5,0xd2,0x21,0x20,0x4e,0x51,
    0x76,0x78,0x4d,0x75,0xc4,0xf2,0x5c,0xa1,0x3d,0x33,0x6f,0xad,0xe5,0x3d,0xf6,0xde,
    0xcf,0x8f,0x1f,0xc8,0xa7,0x82,0xf8,0x55,0x3d,0x4a,0x20,0xe2,0xa1,0x68,0x82,0xc0,
    0x3d,0xd6,0x8c,0x1a,0x07,0x06,0x05,0x04,0x03,0x02,0x01,0x00
};

//3.19	CW_S0_KL-AES_L2_TS-AES_TA
static HI_U8 CW_S0_KL_AES_L2_TS_AES_TA_TASKp[16]  = {0xD4,0x71,0x3D,0x60,0xC8,0xA7,0x06,0x39,0xEB,0x11,0x67,0xB3,0x67,0xA9,0xC3,0x78};
static HI_U8 CW_S0_KL_AES_L2_TS_AES_TA_Transformation_Data[] = {
    0xF4,0x29,0x43,0xBC,0xDB,0x85,0x96,0x4D,0xB3,0xCD,0xEF,0xF2,0x5E,0x10,0x64,0xDC,
    0x00,0x8A,0x02,0x82,0x38,0xB1,0xD2,0x9F,0xE1,0xD8,0x74,0x7A,0x57,0xF2,0x1E,0xC8,
    0x5D,0x63,0x60,0x66,0x23,0x6C,0x42,0xED,0x77,0x93,0x4C,0xF1,0x6E,0x95,0x78,0xF1,
    0x37,0x91,0x70,0x6F,0xF0,0x05,0xB7,0x44,0x20,0x54,0xA4,0xBF,0xB5,0x5A,0xC7,0xE6,
    0x51,0x56,0xEC,0x48,0x24,0xBD,0x84,0x03,0x5F,0xF3,0x3A,0xA2,0x65,0xA5,0xF5,0xFE,
    0x8F,0x18,0x3C,0xE3,0xAF,0x7E,0x02,0xA0,0x0F,0x0C,0x60,0xD5,0x4B,0x9B,0x67,0x03,
    0x71,0xA4,0xB7,0x61,0xF1,0x02,0x7A,0x0D,0x98,0x37,0x0B,0x89,0x32,0xE2,0xE1,0x7E,
    0x23,0x47,0x6C,0x80,0xDD,0xFE,0xED,0xC1,0x95,0xA7,0x5D,0x4C,0x91,0x05,0xF2,0xE3,
    0xBB,0xC0,0xE7,0x8A,0xA6,0xD1,0x21,0x25,0x42,0x84,0x96,0x80,0xF7,0x1B,0x7A,0x99,
    0x94,0xD5,0xA5,0xA5,0xBC,0x48,0xA6,0x1C,0x80,0x76,0x7A,0x73,0xEF,0x0F,0x92,0x9E,
    0xDE,0xA2,0xC3,0xD6,0xB8,0x2A,0x1B,0x97,0xE7,0xDA,0x6A,0xE8,0xAE,0xCF,0x60,0xC9,
    0x51,0x34,0x53,0x4F,0x6C,0x25,0x62,0xCE,0x34,0x63,0xAE,0x8B,0x4E,0x20,0x84,0x50,
    0x96,0xBA,0x96,0x5D,0xD3,0xB7,0x6E,0xC2,0x4D,0x8B,0x51,0xF1,0xBE,0xB9,0xE7,0x9C,
    0x1C,0x3E,0x6F,0x5E,0xE0,0x47,0x22,0x14,0x99,0x07,0xEC,0x4B,0xFC,0xC7,0x24,0x52,
    0x58,0x4F,0x78,0xEF,0xD9,0x2F,0x04,0x85,0x72,0x60,0x2E,0x25,0xD0,0x70,0x9C,0xE5,
    0xDE,0x8F,0x26,0xCC,0xE2,0xAF,0x5D,0x53,0xDD,0x8E,0xFA,0x7C,0x07,0x0D,0xF7,0xB4,
    0x41,0xBA,0x55,0x84,0x48,0xE4,0x09,0x9D,0xBE,0x5A,0x17,0x87,0x4D,0x65,0xB8,0xB3,
    0x5C,0xBB,0xEC,0x1C,0x65,0x49,0xCE,0xCE,0x7A,0x5D,0x79,0xED,0x26,0x0D,0xB8,0x87,
    0x1F,0x5D,0xCC,0x8C,0xB8,0x76,0x90,0xDF,0xD1,0x25,0x34,0xB4,0xB5,0xCD,0x43,0x40,
    0x40,0x3B,0x64,0xC0,0x7E,0x51,0xDD,0x2C,0x53,0x89,0x7E,0xDA,0x45,0x07,0xF9,0x14,
    0x81,0xD7,0xD0,0x99,0x26,0x67,0x3F,0x9E,0xD4,0x49,0x26,0x81,0x17,0x25,0x3C,0x40,
    0xC3,0x54,0x2A,0x75,0x63,0x97,0x29,0x25,0xAA,0x26,0x72,0x49,0x66,0x56,0x17,0xAD,
    0xB1,0x5F,0xB8,0x59,0x67,0x41,0x50,0xA7,0xAB,0xEC,0x7B,0x3E,0x84,0xBC,0xA3,0x9B,
    0xDE,0x05,0xD4,0xF3,0x4E,0x7E,0x2C,0xE5,0x1B,0x4D,0x13,0x83,0xCD,0xC2,0x51,0x96,
    0xF0,0xB1,0xB6,0x10,0xAC,0xC1,0x86,0xC0,0x9C,0x8E,0x55,0x9E,0x76,0x78,0x25,0x55,
    0x4E,0x4C,0x7D,0xF7,0x8C,0x89,0x8C,0xFF,0x22,0x0E,0x22,0x7D,0x6C,0x3B,0x57,0x83,
};

static HI_U8 CW_S0_KL_AES_L2_TS_AES_TA_CWSKp[] = {0x82,0xE2,0xE6,0x62,0xF7,0x28,0xB4,0xFA,0x42,0x48,0x5E,0x3A,0x0A,0x5D,0x2F,0x34};
static HI_U8 CW_S0_KL_AES_L2_TS_AES_TA_CEK_pT[] = {0x1D,0x6A,0xB4,0xEB,0x99,0x08,0xD5,0x63,0x2F,0xDC,0x12,0x97,0xEC,0x8E,0xA6,0xE0};
static HI_U8 Org_CW_S0_KL_AES_L2_TS_AES_TA[188] = {
    0x47,0x42,0x10,0x90,0x3a,0xfc,0x36,0x8d,0x00,0x40,0x06,0xc0,0xe4,0xa6,0x6e,0x83,
    0x77,0x82,0x2c,0xd0,0x60,0xb3,0xc8,0xb7,0xa9,0x0f,0xb2,0x32,0x62,0x4d,0x1e,0x36,
    0x9c,0x9a,0x68,0x2b,0x6c,0xcd,0x88,0xb0,0x8a,0x24,0x0a,0xc9,0xcc,0xb8,0x09,0x1c,
    0xcb,0xb5,0xab,0xd3,0xb3,0x15,0x2f,0x76,0xe7,0xa1,0xc9,0x7b,0xbe,0x29,0x6e,0xf1,
    0xf5,0x98,0x4f,0x1c,0x94,0x4a,0x93,0xc7,0x25,0xe8,0xb9,0xd5,0x29,0x76,0xc8,0x66,
    0xbf,0xd6,0x82,0xfd,0x97,0xea,0xb0,0x7c,0x10,0x00,0x06,0x19,0x5f,0x44,0xcd,0x60,
    0xad,0xff,0x99,0xc9,0x67,0x8e,0x81,0x75,0x86,0xe4,0x70,0x26,0xad,0xe5,0x95,0x34,
    0x6a,0x57,0xd0,0x52,0xc9,0xe5,0x7b,0x4d,0xc4,0xff,0x2d,0xfe,0xcc,0x2b,0x7b,0x41,
    0x9e,0x5e,0x85,0xc8,0x4c,0x5d,0xdf,0xe5,0xd7,0xb4,0xb5,0xd2,0x21,0x20,0x4e,0x51,
    0x76,0x78,0x4d,0x75,0xc4,0xf2,0x5c,0xa1,0x3d,0x33,0x6f,0xad,0xe5,0x3d,0xf6,0xde,
    0xcf,0x8f,0x1f,0xc8,0xa7,0x82,0xf8,0x55,0x3d,0x4a,0x20,0xe2,0xa1,0x68,0x82,0xc0,
    0x3d,0xd6,0x8c,0x1a,0x07,0x06,0x05,0x04,0x03,0x02,0x01,0x00
};

//3.20	CW_S0_KL-AES_L2_TS-CSA
static HI_U8 CW_S0_KL_AES_L2_TS_CSA_CWSKp[] = {0xE3,0xE7,0x06,0x82,0xC2,0x09,0x4C,0xAC,0x62,0x9F,0x6F,0xBE,0xD8,0x2C,0x07,0xCD};
static HI_U8 CW_S0_KL_AES_L2_TS_CSA_CEK_p[] = {0x03,0x50,0x4B,0xAD,0xE2,0xAE,0x85,0x2B,0xAB,0xCD,0x96,0x71,0xBA,0xE8,0xCD,0x41};
HI_U8 Org_CW_S0_KL_AES_L2_TS_CSA[188] = {
    0x47,0x42,0x10,0x90,0x4F,0x0C,0xCC,0xA6,0xD3,0xA2,0x71,0x41,0x2D,0xAA,0x76,0xD0,0xED,0x57,0xC0,0xC5,
    0x00,0xAA,0xF2,0xA4,0x5C,0xE9,0xF6,0x2E,0xA4,0x06,0xAC,0x41,0x5E,0xDC,0x42,0xD9,
    0x8A,0x76,0x4E,0x45,0xBF,0xC0,0xE7,0xE9,0x9C,0x83,0x95,0xF6,0x22,0xF5,0x3D,0xFA,
    0x92,0x76,0xBF,0x17,0x40,0x59,0x88,0xE0,0x45,0xC9,0xE3,0x47,0xDD,0x68,0x4E,0x94,
    0x00,0x2A,0x43,0x36,0xF6,0xBB,0xF2,0x99,0x9D,0x4E,0x5C,0x76,0xAC,0x54,0x6C,0xB7,
    0xDA,0x69,0x22,0x40,0x58,0x22,0x27,0xB9,0xB5,0xD2,0x21,0x69,0x96,0x24,0x9D,0xCF,
    0xD7,0x8E,0xF6,0x7D,0xF0,0xFC,0x10,0x4B,0xC8,0x63,0xC8,0x3A,0x76,0x4A,0x25,0x05,
    0x58,0x3D,0xDE,0xE6,0xA9,0x8B,0x79,0xF4,0x73,0xCD,0xEF,0xC6,0xA7,0x43,0x76,0xC5,
    0xF2,0x64,0x47,0x4B,0x89,0xB1,0x07,0xB2,0xA4,0xC1,0x95,0xFC,0x94,0xA9,0xC3,0xBA,
    0x82,0x5C,0xB0,0xDF,0xDA,0x11,0x9F,0xE1,0x31,0x44,0x3F,0x48,0xF9,0x41,0xD2,0x97,
    0x99,0x78,0x73,0x16,0x8E,0xB3,0x43,0x10,0x5A,0x41,0x4B,0x12,0x87,0x69,0xC7,0x5D,
    0x70,0xB9,0x6F,0x3C,0x8D,0x00,0x8D,0xBA
};

//3.21	CW_S0_KL-AES_L2_TS-CSA_TA
static HI_U8 CW_S0_KL_AES_L2_TS_CSA_TA_CWSKp[]  = {0xE3,0xE7,0x06,0x82,0xC2,0x09,0x4C,0xAC,0x62,0x9F,0x6F,0xBE,0xD8,0x2C,0x07,0xCD};
static HI_U8 CW_S0_KL_AES_L2_TS_CSA_TA_TASKp[]  = {0x82,0xE2,0xE6,0x62,0xF7,0x28,0xB4,0xFA,0x42,0x48,0x5E,0x3A,0x0A,0x5D,0x2F,0x34};
HI_U8 CW_S0_KL_AES_L2_TS_CSA_TA_Transformation_Data[] = {
    0x01,0x3B,0x23,0x77,0x80,0x15,0xF3,0x9F,0x3A,0x56,0xF3,0x8C,0x20,0x9F,0x3A,0xDE,
    0x70,0x46,0x1B,0xF9,0x67,0x31,0xCA,0x12,0x0E,0xB9,0x80,0xB0,0x10,0xDA,0x75,0x64,
    0x52,0xD2,0x09,0xD7,0xC0,0x9D,0x2C,0x79,0x5C,0x9A,0x19,0x0A,0x92,0xF6,0x6C,0x19,
    0xCC,0x56,0x04,0xE7,0x48,0xE6,0xCF,0x8D,0x1A,0x04,0xA8,0x05,0x79,0xDA,0x51,0xDF,
    0xC3,0xD3,0xAD,0xCE,0x6A,0xD1,0x4B,0x8E,0x12,0x96,0xE5,0x74,0x22,0xB8,0x48,0xE7,
    0x7E,0x10,0xA0,0x45,0x1E,0x28,0xA1,0x7E,0xC7,0x7E,0xA9,0xA8,0xDE,0xFF,0x3D,0x59,
    0x76,0xA0,0xC1,0xDB,0x57,0xF6,0x0E,0xAF,0xEA,0xB4,0xEB,0x47,0x76,0xE3,0xF2,0x77,
    0x31,0x27,0xCE,0xAE,0xDA,0xAA,0x80,0xD1,0x92,0x0C,0xA4,0x64,0xFD,0xDC,0x60,0xC5,
    0x6E,0xAE,0x49,0x78,0x41,0x1E,0x34,0xA4,0xD1,0xCC,0x6E,0x9D,0xE5,0x75,0x54,0x3D,
    0x0A,0x98,0x2D,0xAF,0x8C,0x90,0x37,0xA0,0x7F,0xDF,0x78,0x17,0xD6,0x1E,0x5B,0xDA,
    0x73,0xD3,0xFF,0x92,0xD3,0x1D,0x35,0xED,0x31,0xEA,0x07,0x0E,0xF3,0xD9,0x6B,0x00,
    0x87,0x68,0xEB,0x46,0x64,0x35,0xFC,0x52,0xAE,0xCE,0x7E,0x42,0x35,0x34,0x39,0x04,
    0xED,0x95,0xD2,0xC0,0xCB,0x60,0x39,0xA4,0x83,0x00,0x7E,0x4A,0x52,0x66,0x51,0x38,
    0xC2,0x5F,0xF4,0x14,0x2A,0xFF,0xFE,0xAF,0x60,0x44,0x4D,0xF2,0xF5,0xA5,0xE7,0x61,
    0x97,0xF9,0xE8,0x1F,0x38,0xE1,0x9D,0x53,0xCC,0x27,0x64,0x78,0x80,0x9F,0x59,0x1A,
    0x84,0xEF,0x41,0xF9,0x62,0x50,0x6D,0xF1,0x4F,0x35,0x06,0xF2,0x66,0xF3,0x94,0x42,
    0xF5,0x93,0x61,0xF7,0x73,0xB4,0xB0,0x68,0xE3,0x0C,0x61,0x12,0xC5,0x87,0x2B,0x63,
    0x83,0xB2,0x91,0xD7,0xFB,0x6E,0xC9,0x54,0xD7,0x55,0x1A,0xA5,0xF8,0xC6,0xF8,0xD1,
    0xD6,0x03,0xDE,0x8A,0x5F,0xA3,0x6D,0x63,0xA9,0xD9,0x42,0x05,0x25,0x1E,0xF3,0x42,
    0x9B,0xC3,0x07,0x8F,0x33,0xE0,0x85,0x8C,0x05,0xD9,0x18,0x4F,0x64,0x30,0xBC,0x7D,
    0x18,0x0A,0x73,0x9C,0xC0,0xFA,0x35,0x50,0x3E,0xF3,0x55,0xAC,0x78,0x43,0x9A,0x3B,
    0x75,0x09,0xAB,0x6B,0x44,0x23,0xA8,0x53,0xB8,0x60,0x20,0xC2,0x58,0x23,0x69,0xA7,
    0xC7,0xA6,0x3F,0x42,0xC1,0x12,0x37,0x7E,0xBB,0x99,0x80,0xDA,0x72,0x1E,0xCF,0xFF,
    0x46,0x98,0x53,0x97,0x4C,0xD2,0xA1,0x9F,0x0A,0x24,0x83,0xF1,0x28,0x50,0x47,0x37,
    0x08,0x20,0x4F,0xB0,0x32,0x9E,0xA0,0xC5,0x7C,0x85,0x64,0xD1,0x69,0x4A,0xFE,0xDC,
    0x9B,0x6E,0x5A,0x4D,0xB9,0xD8,0x56,0xCB,0x29,0xAD,0x6B,0x64,0xE2,0xAD,0x84,0xBB,
};
HI_U8 CW_S0_KL_AES_L2_TS_CSA_TA_CEK_pT[] = {0xCE,0x68,0xD3,0xCC,0x5B,0x8C,0x4E,0x05,0x2B,0x77,0xEE,0xE3,0x10,0xD4,0xB5,0x74};
HI_U8 Org_CW_S0_KL_AES_L2_TS_CSA_TA[188] = {
    0x47,0x42,0x10,0x90,0x4F,0x0C,0xCC,0xA6,0xD3,0xA2,0x71,0x41,0x2D,0xAA,0x76,0xD0,0xED,0x57,0xC0,0xC5,
    0x00,0xAA,0xF2,0xA4,0x5C,0xE9,0xF6,0x2E,0xA4,0x06,0xAC,0x41,0x5E,0xDC,0x42,0xD9,
    0x8A,0x76,0x4E,0x45,0xBF,0xC0,0xE7,0xE9,0x9C,0x83,0x95,0xF6,0x22,0xF5,0x3D,0xFA,
    0x92,0x76,0xBF,0x17,0x40,0x59,0x88,0xE0,0x45,0xC9,0xE3,0x47,0xDD,0x68,0x4E,0x94,
    0x00,0x2A,0x43,0x36,0xF6,0xBB,0xF2,0x99,0x9D,0x4E,0x5C,0x76,0xAC,0x54,0x6C,0xB7,
    0xDA,0x69,0x22,0x40,0x58,0x22,0x27,0xB9,0xB5,0xD2,0x21,0x69,0x96,0x24,0x9D,0xCF,
    0xD7,0x8E,0xF6,0x7D,0xF0,0xFC,0x10,0x4B,0xC8,0x63,0xC8,0x3A,0x76,0x4A,0x25,0x05,
    0x58,0x3D,0xDE,0xE6,0xA9,0x8B,0x79,0xF4,0x73,0xCD,0xEF,0xC6,0xA7,0x43,0x76,0xC5,
    0xF2,0x64,0x47,0x4B,0x89,0xB1,0x07,0xB2,0xA4,0xC1,0x95,0xFC,0x94,0xA9,0xC3,0xBA,
    0x82,0x5C,0xB0,0xDF,0xDA,0x11,0x9F,0xE1,0x31,0x44,0x3F,0x48,0xF9,0x41,0xD2,0x97,
    0x99,0x78,0x73,0x16,0x8E,0xB3,0x43,0x10,0x5A,0x41,0x4B,0x12,0x87,0x69,0xC7,0x5D,
    0x70,0xB9,0x6F,0x3C,0x8D,0x00,0x8D,0xBA
};

//3.22	CW_S0_KL-AES_L2_TS-CSA3
static HI_U8 CW_S0_KL_AES_L2_TS_CSA3_CWSKp[] = {0xE3,0xE7,0x06,0x82,0xC2,0x09,0x4C,0xAC,0x62,0x9F,0x6F,0xBE,0xD8,0x2C,0x07,0xCD};
static HI_U8 CW_S0_KL_AES_L2_TS_CSA3_CEK_p[] = {0xF7,0x7A,0xC0,0x2E,0xAA,0x6C,0x8D,0xFB,0x20,0x4E,0xD1,0xF9,0x44,0x13,0x3B,0x2E};
HI_U8 Org_CW_S0_KL_AES_L2_TS_CSA3[188] = {
    0x47,0x42,0x10,0x90,0x14,0x5C,0x5D,0x60,0xDE,0x00,0x06,0xBD,0x87,0xED,0xBE,0x80,
    0x55,0xB7,0xEF,0xE3,0xA1,0x29,0x1A,0x52,0xB8,0x22,0xDB,0x12,0xA1,0x8A,0x6B,0x1A,
    0x9F,0x2B,0x4C,0xD8,0x9B,0x68,0x38,0x39,0x1E,0xEF,0xB5,0x4F,0xF7,0xA2,0x7D,0xB9,
    0x5A,0xCA,0xE2,0xDC,0x33,0x44,0xAB,0x2F,0x58,0xB7,0xB0,0x85,0x26,0x68,0x5B,0x67,
    0xA0,0x28,0x33,0x4E,0xAB,0x11,0xF2,0x37,0x7B,0xA6,0xBC,0x54,0xE0,0x26,0x02,0x3D,
    0x54,0x57,0x61,0xD2,0x76,0x62,0xC0,0xCE,0x04,0xB4,0xC8,0x63,0x2F,0x4C,0x2E,0x8C,
    0x89,0x95,0x37,0xAD,0x9A,0xDB,0x2A,0x05,0x2A,0x7A,0xB6,0x75,0x3F,0x8B,0x3C,0x2A,
    0xA4,0x0F,0x4B,0x42,0x4E,0xE7,0x51,0x2A,0xE4,0xF5,0x9A,0x6A,0x64,0x4B,0x4A,0x4D,
    0x27,0x82,0x7F,0x2B,0x48,0xFE,0x38,0x0F,0x5B,0x6D,0xE3,0x2D,0x94,0x84,0x47,0x44,
    0xD7,0xD7,0x7D,0xF3,0x0C,0xFE,0xED,0x8C,0xB6,0x77,0xE9,0x88,0x00,0xEB,0xC6,0x78,
    0x3C,0x09,0x66,0x55,0x9E,0x01,0x97,0x8F,0xC0,0xDC,0xDD,0x2E,0x6F,0xDF,0x85,0x5E,
    0xFB,0xBD,0x73,0x91,0xF2,0x28,0x94,0x33,0x90,0xFA,0xDB,0xBD
};

//3.23	CW_S0_KL-AES_L2_TS-CSA3_TA
static HI_U8 CW_S0_KL_AES_L2_TS_CSA3_TA_CWSKp[]  = {0xE3,0xE7,0x06,0x82,0xC2,0x09,0x4C,0xAC,0x62,0x9F,0x6F,0xBE,0xD8,0x2C,0x07,0xCD};
static HI_U8 CW_S0_KL_AES_L2_TS_CSA3_TA_TASKp[]  = {0x82,0xE2,0xE6,0x62,0xF7,0x28,0xB4,0xFA,0x42,0x48,0x5E,0x3A,0x0A,0x5D,0x2F,0x34};
HI_U8 CW_S0_KL_AES_L2_TS_CSA3_TA_Transformation_Data[] = {
    0x01,0x3B,0x23,0x77,0x80,0x15,0xF3,0x9F,0x3A,0x56,0xF3,0x8C,0x20,0x9F,0x3A,0xDE,
    0x70,0x46,0x1B,0xF9,0x67,0x31,0xCA,0x12,0x0E,0xB9,0x80,0xB0,0x10,0xDA,0x75,0x64,
    0x52,0xD2,0x09,0xD7,0xC0,0x9D,0x2C,0x79,0x5C,0x9A,0x19,0x0A,0x92,0xF6,0x6C,0x19,
    0xCC,0x56,0x04,0xE7,0x48,0xE6,0xCF,0x8D,0x1A,0x04,0xA8,0x05,0x79,0xDA,0x51,0xDF,
    0xC3,0xD3,0xAD,0xCE,0x6A,0xD1,0x4B,0x8E,0x12,0x96,0xE5,0x74,0x22,0xB8,0x48,0xE7,
    0x7E,0x10,0xA0,0x45,0x1E,0x28,0xA1,0x7E,0xC7,0x7E,0xA9,0xA8,0xDE,0xFF,0x3D,0x59,
    0x76,0xA0,0xC1,0xDB,0x57,0xF6,0x0E,0xAF,0xEA,0xB4,0xEB,0x47,0x76,0xE3,0xF2,0x77,
    0x31,0x27,0xCE,0xAE,0xDA,0xAA,0x80,0xD1,0x92,0x0C,0xA4,0x64,0xFD,0xDC,0x60,0xC5,
    0x6E,0xAE,0x49,0x78,0x41,0x1E,0x34,0xA4,0xD1,0xCC,0x6E,0x9D,0xE5,0x75,0x54,0x3D,
    0x0A,0x98,0x2D,0xAF,0x8C,0x90,0x37,0xA0,0x7F,0xDF,0x78,0x17,0xD6,0x1E,0x5B,0xDA,
    0x73,0xD3,0xFF,0x92,0xD3,0x1D,0x35,0xED,0x31,0xEA,0x07,0x0E,0xF3,0xD9,0x6B,0x00,
    0x87,0x68,0xEB,0x46,0x64,0x35,0xFC,0x52,0xAE,0xCE,0x7E,0x42,0x35,0x34,0x39,0x04,
    0xED,0x95,0xD2,0xC0,0xCB,0x60,0x39,0xA4,0x83,0x00,0x7E,0x4A,0x52,0x66,0x51,0x38,
    0xC2,0x5F,0xF4,0x14,0x2A,0xFF,0xFE,0xAF,0x60,0x44,0x4D,0xF2,0xF5,0xA5,0xE7,0x61,
    0x97,0xF9,0xE8,0x1F,0x38,0xE1,0x9D,0x53,0xCC,0x27,0x64,0x78,0x80,0x9F,0x59,0x1A,
    0x84,0xEF,0x41,0xF9,0x62,0x50,0x6D,0xF1,0x4F,0x35,0x06,0xF2,0x66,0xF3,0x94,0x42,
    0xF5,0x93,0x61,0xF7,0x73,0xB4,0xB0,0x68,0xE3,0x0C,0x61,0x12,0xC5,0x87,0x2B,0x63,
    0x83,0xB2,0x91,0xD7,0xFB,0x6E,0xC9,0x54,0xD7,0x55,0x1A,0xA5,0xF8,0xC6,0xF8,0xD1,
    0xD6,0x03,0xDE,0x8A,0x5F,0xA3,0x6D,0x63,0xA9,0xD9,0x42,0x05,0x25,0x1E,0xF3,0x42,
    0x9B,0xC3,0x07,0x8F,0x33,0xE0,0x85,0x8C,0x05,0xD9,0x18,0x4F,0x64,0x30,0xBC,0x7D,
    0x18,0x0A,0x73,0x9C,0xC0,0xFA,0x35,0x50,0x3E,0xF3,0x55,0xAC,0x78,0x43,0x9A,0x3B,
    0x75,0x09,0xAB,0x6B,0x44,0x23,0xA8,0x53,0xB8,0x60,0x20,0xC2,0x58,0x23,0x69,0xA7,
    0xC7,0xA6,0x3F,0x42,0xC1,0x12,0x37,0x7E,0xBB,0x99,0x80,0xDA,0x72,0x1E,0xCF,0xFF,
    0x46,0x98,0x53,0x97,0x4C,0xD2,0xA1,0x9F,0x0A,0x24,0x83,0xF1,0x28,0x50,0x47,0x37,
    0x08,0x20,0x4F,0xB0,0x32,0x9E,0xA0,0xC5,0x7C,0x85,0x64,0xD1,0x69,0x4A,0xFE,0xDC,
    0x9B,0x6E,0x5A,0x4D,0xB9,0xD8,0x56,0xCB,0x29,0xAD,0x6B,0x64,0xE2,0xAD,0x84,0xBB,
};
HI_U8 CW_S0_KL_AES_L2_TS_CSA3_TA_CEK_pT[] = {0x29,0x05,0x6C,0xE2,0xA3,0x7C,0xBA,0xDF,0xDB,0x35,0x9A,0x48,0xA8,0xE2,0x06,0x5D};
HI_U8 Org_CW_S0_KL_AES_L2_TS_CSA3_TA[188] = {
    0x47,0x42,0x10,0x90,0x14,0x5C,0x5D,0x60,0xDE,0x00,0x06,0xBD,0x87,0xED,0xBE,0x80,
    0x55,0xB7,0xEF,0xE3,0xA1,0x29,0x1A,0x52,0xB8,0x22,0xDB,0x12,0xA1,0x8A,0x6B,0x1A,
    0x9F,0x2B,0x4C,0xD8,0x9B,0x68,0x38,0x39,0x1E,0xEF,0xB5,0x4F,0xF7,0xA2,0x7D,0xB9,
    0x5A,0xCA,0xE2,0xDC,0x33,0x44,0xAB,0x2F,0x58,0xB7,0xB0,0x85,0x26,0x68,0x5B,0x67,
    0xA0,0x28,0x33,0x4E,0xAB,0x11,0xF2,0x37,0x7B,0xA6,0xBC,0x54,0xE0,0x26,0x02,0x3D,
    0x54,0x57,0x61,0xD2,0x76,0x62,0xC0,0xCE,0x04,0xB4,0xC8,0x63,0x2F,0x4C,0x2E,0x8C,
    0x89,0x95,0x37,0xAD,0x9A,0xDB,0x2A,0x05,0x2A,0x7A,0xB6,0x75,0x3F,0x8B,0x3C,0x2A,
    0xA4,0x0F,0x4B,0x42,0x4E,0xE7,0x51,0x2A,0xE4,0xF5,0x9A,0x6A,0x64,0x4B,0x4A,0x4D,
    0x27,0x82,0x7F,0x2B,0x48,0xFE,0x38,0x0F,0x5B,0x6D,0xE3,0x2D,0x94,0x84,0x47,0x44,
    0xD7,0xD7,0x7D,0xF3,0x0C,0xFE,0xED,0x8C,0xB6,0x77,0xE9,0x88,0x00,0xEB,0xC6,0x78,
    0x3C,0x09,0x66,0x55,0x9E,0x01,0x97,0x8F,0xC0,0xDC,0xDD,0x2E,0x6F,0xDF,0x85,0x5E,
    0xFB,0xBD,0x73,0x91,0xF2,0x28,0x94,0x33,0x90,0xFA,0xDB,0xBD
};

//3.24	CW_S0_KL-AES_L2_TS-TCSA3
static HI_U8 CW_S0_KL_AES_L2_TS_TCSA3_CWSKp[] = {0xE3,0xE7,0x06,0x82,0xC2,0x09,0x4C,0xAC,0x62,0x9F,0x6F,0xBE,0xD8,0x2C,0x07,0xCD};
static HI_U8 CW_S0_KL_AES_L2_TS_TCSA3_CEK_p[] = {0xF7,0x7A,0xC0,0x2E,0xAA,0x6C,0x8D,0xFB,0x20,0x4E,0xD1,0xF9,0x44,0x13,0x3B,0x2E};
HI_U8 Org_CW_S0_KL_AES_L2_TS_TCSA3[188] = {
    0x47,0x42,0x10,0x90,0xE6,0x34,0x0B,0x6E,0xBA,0x46,0xF2,0xD4,0x12,0x25,0xF0,0xD7,0x1C,0xCC,0xF3,0x45,
    0x57,0x94,0x82,0x74,0xEA,0x50,0x44,0x87,0xB8,0x33,0xAF,0x09,0xF6,0x62,0x5C,0x12,
    0xCF,0x71,0x83,0x34,0x59,0xC8,0xE3,0x1F,0x66,0xFF,0xD7,0x3B,0x04,0x9C,0xF4,0xB1,
    0xC5,0x61,0xE2,0x74,0xAA,0xA8,0xCD,0xCA,0x88,0x13,0xAF,0x18,0x8D,0x71,0x3F,0x88,
    0x39,0xA4,0xC1,0xC3,0x9F,0x4A,0x40,0x9C,0xAA,0xF9,0x27,0xFD,0xF8,0x9A,0xFB,0xE5,
    0x2E,0x67,0x79,0xD3,0xF2,0x3B,0x5F,0x95,0x45,0x58,0xEB,0x38,0xF3,0x9B,0x66,0x7B,
    0xA0,0x1B,0xEE,0x32,0x4D,0xAA,0x0A,0x26,0xE8,0x59,0x10,0xDD,0x8B,0x9F,0x8A,0x43,
    0xDF,0xBA,0x85,0x41,0x45,0x40,0xF1,0x95,0xA7,0xA0,0x0D,0x10,0x2D,0x97,0xE3,0x17,
    0x55,0x62,0x26,0xB2,0xB3,0xE6,0xFD,0xC5,0x13,0x76,0x61,0x79,0xB9,0xB3,0xA9,0x34,
    0x80,0xC4,0x1D,0x90,0x33,0x68,0xAD,0xC6,0xB8,0x18,0x3C,0x9B,0x91,0x58,0x24,0xC3,
    0xB4,0x18,0x7A,0x3C,0x3F,0x4B,0x04,0xBC,0xC6,0xF7,0xD8,0x72,0x8F,0x28,0xA1,0x72,
    0x5E,0x5E,0x25,0xD2,0xD8,0x2B,0x35,0x57
};
HI_U8 CW_S0_KL_AES_L2_TS_TCSA3_ACTIVATION[] = {0x52,0xCE,0x03,0x7E,0xAF,0x3D,0x95,0x02,0x4A,0xDB,0x99,0x24,0xA1,0x41,0x7E,0xD8};

//3.25	CW_S0_KL-AES_L2_TS-TCSA3_TA
static HI_U8 CW_S0_KL_AES_L2_TS_TCSA3_TA_CWSKp[]  = {0xE3,0xE7,0x06,0x82,0xC2,0x09,0x4C,0xAC,0x62,0x9F,0x6F,0xBE,0xD8,0x2C,0x07,0xCD};
static HI_U8 CW_S0_KL_AES_L2_TS_TCSA3_TA_TASKp[]  = {0x82,0xE2,0xE6,0x62,0xF7,0x28,0xB4,0xFA,0x42,0x48,0x5E,0x3A,0x0A,0x5D,0x2F,0x34};
static HI_U8 CW_S0_KL_AES_L2_TS_TCSA3_TA_Transformation_Data[] = {
    0x01,0x3B,0x23,0x77,0x80,0x15,0xF3,0x9F,0x3A,0x56,0xF3,0x8C,0x20,0x9F,0x3A,0xDE,
    0x70,0x46,0x1B,0xF9,0x67,0x31,0xCA,0x12,0x0E,0xB9,0x80,0xB0,0x10,0xDA,0x75,0x64,
    0x52,0xD2,0x09,0xD7,0xC0,0x9D,0x2C,0x79,0x5C,0x9A,0x19,0x0A,0x92,0xF6,0x6C,0x19,
    0xCC,0x56,0x04,0xE7,0x48,0xE6,0xCF,0x8D,0x1A,0x04,0xA8,0x05,0x79,0xDA,0x51,0xDF,
    0xC3,0xD3,0xAD,0xCE,0x6A,0xD1,0x4B,0x8E,0x12,0x96,0xE5,0x74,0x22,0xB8,0x48,0xE7,
    0x7E,0x10,0xA0,0x45,0x1E,0x28,0xA1,0x7E,0xC7,0x7E,0xA9,0xA8,0xDE,0xFF,0x3D,0x59,
    0x76,0xA0,0xC1,0xDB,0x57,0xF6,0x0E,0xAF,0xEA,0xB4,0xEB,0x47,0x76,0xE3,0xF2,0x77,
    0x31,0x27,0xCE,0xAE,0xDA,0xAA,0x80,0xD1,0x92,0x0C,0xA4,0x64,0xFD,0xDC,0x60,0xC5,
    0x6E,0xAE,0x49,0x78,0x41,0x1E,0x34,0xA4,0xD1,0xCC,0x6E,0x9D,0xE5,0x75,0x54,0x3D,
    0x0A,0x98,0x2D,0xAF,0x8C,0x90,0x37,0xA0,0x7F,0xDF,0x78,0x17,0xD6,0x1E,0x5B,0xDA,
    0x73,0xD3,0xFF,0x92,0xD3,0x1D,0x35,0xED,0x31,0xEA,0x07,0x0E,0xF3,0xD9,0x6B,0x00,
    0x87,0x68,0xEB,0x46,0x64,0x35,0xFC,0x52,0xAE,0xCE,0x7E,0x42,0x35,0x34,0x39,0x04,
    0xED,0x95,0xD2,0xC0,0xCB,0x60,0x39,0xA4,0x83,0x00,0x7E,0x4A,0x52,0x66,0x51,0x38,
    0xC2,0x5F,0xF4,0x14,0x2A,0xFF,0xFE,0xAF,0x60,0x44,0x4D,0xF2,0xF5,0xA5,0xE7,0x61,
    0x97,0xF9,0xE8,0x1F,0x38,0xE1,0x9D,0x53,0xCC,0x27,0x64,0x78,0x80,0x9F,0x59,0x1A,
    0x84,0xEF,0x41,0xF9,0x62,0x50,0x6D,0xF1,0x4F,0x35,0x06,0xF2,0x66,0xF3,0x94,0x42,
    0xF5,0x93,0x61,0xF7,0x73,0xB4,0xB0,0x68,0xE3,0x0C,0x61,0x12,0xC5,0x87,0x2B,0x63,
    0x83,0xB2,0x91,0xD7,0xFB,0x6E,0xC9,0x54,0xD7,0x55,0x1A,0xA5,0xF8,0xC6,0xF8,0xD1,
    0xD6,0x03,0xDE,0x8A,0x5F,0xA3,0x6D,0x63,0xA9,0xD9,0x42,0x05,0x25,0x1E,0xF3,0x42,
    0x9B,0xC3,0x07,0x8F,0x33,0xE0,0x85,0x8C,0x05,0xD9,0x18,0x4F,0x64,0x30,0xBC,0x7D,
    0x18,0x0A,0x73,0x9C,0xC0,0xFA,0x35,0x50,0x3E,0xF3,0x55,0xAC,0x78,0x43,0x9A,0x3B,
    0x75,0x09,0xAB,0x6B,0x44,0x23,0xA8,0x53,0xB8,0x60,0x20,0xC2,0x58,0x23,0x69,0xA7,
    0xC7,0xA6,0x3F,0x42,0xC1,0x12,0x37,0x7E,0xBB,0x99,0x80,0xDA,0x72,0x1E,0xCF,0xFF,
    0x46,0x98,0x53,0x97,0x4C,0xD2,0xA1,0x9F,0x0A,0x24,0x83,0xF1,0x28,0x50,0x47,0x37,
    0x08,0x20,0x4F,0xB0,0x32,0x9E,0xA0,0xC5,0x7C,0x85,0x64,0xD1,0x69,0x4A,0xFE,0xDC,
    0x9B,0x6E,0x5A,0x4D,0xB9,0xD8,0x56,0xCB,0x29,0xAD,0x6B,0x64,0xE2,0xAD,0x84,0xBB,
};
static HI_U8 CW_S0_KL_AES_L2_TS_TCSA3_TA_CEK_pT[] = {0x29,0x05,0x6C,0xE2,0xA3,0x7C,0xBA,0xDF,0xDB,0x35,0x9A,0x48,0xA8,0xE2,0x06,0x5D};

HI_U8 Org_CW_S0_KL_AES_L2_TS_TCSA3_TA[188] = {
    0x47,0x42,0x10,0x90,0xE6,0x34,0x0B,0x6E,0xBA,0x46,0xF2,0xD4,0x12,0x25,0xF0,0xD7,0x1C,0xCC,0xF3,0x45,
    0x57,0x94,0x82,0x74,0xEA,0x50,0x44,0x87,0xB8,0x33,0xAF,0x09,0xF6,0x62,0x5C,0x12,
    0xCF,0x71,0x83,0x34,0x59,0xC8,0xE3,0x1F,0x66,0xFF,0xD7,0x3B,0x04,0x9C,0xF4,0xB1,
    0xC5,0x61,0xE2,0x74,0xAA,0xA8,0xCD,0xCA,0x88,0x13,0xAF,0x18,0x8D,0x71,0x3F,0x88,
    0x39,0xA4,0xC1,0xC3,0x9F,0x4A,0x40,0x9C,0xAA,0xF9,0x27,0xFD,0xF8,0x9A,0xFB,0xE5,
    0x2E,0x67,0x79,0xD3,0xF2,0x3B,0x5F,0x95,0x45,0x58,0xEB,0x38,0xF3,0x9B,0x66,0x7B,
    0xA0,0x1B,0xEE,0x32,0x4D,0xAA,0x0A,0x26,0xE8,0x59,0x10,0xDD,0x8B,0x9F,0x8A,0x43,
    0xDF,0xBA,0x85,0x41,0x45,0x40,0xF1,0x95,0xA7,0xA0,0x0D,0x10,0x2D,0x97,0xE3,0x17,
    0x55,0x62,0x26,0xB2,0xB3,0xE6,0xFD,0xC5,0x13,0x76,0x61,0x79,0xB9,0xB3,0xA9,0x34,
    0x80,0xC4,0x1D,0x90,0x33,0x68,0xAD,0xC6,0xB8,0x18,0x3C,0x9B,0x91,0x58,0x24,0xC3,
    0xB4,0x18,0x7A,0x3C,0x3F,0x4B,0x04,0xBC,0xC6,0xF7,0xD8,0x72,0x8F,0x28,0xA1,0x72,
    0x5E,0x5E,0x25,0xD2,0xD8,0x2B,0x35,0x57
};
HI_U8 CW_S0_KL_AES_L2_TS_TCSA3_TA_ACTIVATION[] = {0x52,0xCE,0x03,0x7E,0xAF,0x3D,0x95,0x02,0x4A,0xDB,0x99,0x24,0xA1,0x41,0x7E,0xD8};

//3.26	CW_S0_KL-AES_L3_TS-AES
static HI_U8 CW_S0_KL_AES_L3_TS_AES_CWAKp[] = {0x82,0xE2,0xE6,0x62,0xF7,0x28,0xB4,0xFA,0x42,0x48,0x5E,0x3A,0x0A,0x5D,0x2F,0x34};
static HI_U8 CW_S0_KL_AES_L3_TS_AES_CWSKp[] = {0xD4,0x71,0x3D,0x60,0xC8,0xA7,0x06,0x39,0xEB,0x11,0x67,0xB3,0x67,0xA9,0xC3,0x78};
static HI_U8 CW_S0_KL_AES_L3_TS_AES_CEK_p[] = {0xBF,0x74,0xC5,0xB2,0xBA,0xEF,0xAA,0x99,0x57,0xD7,0x1D,0x5F,0xC4,0x5D,0x06,0x00};
HI_U8 Org_CW_S0_KL_AES_L3_TS_AES[188] = {
    0x47,0x42,0x10,0x90,0x3a,0xfc,0x36,0x8d,0x00,0x40,0x06,0xc0,0xe4,0xa6,0x6e,0x83,
    0x77,0x82,0x2c,0xd0,0x60,0xb3,0xc8,0xb7,0xa9,0x0f,0xb2,0x32,0x62,0x4d,0x1e,0x36,
    0x9c,0x9a,0x68,0x2b,0x6c,0xcd,0x88,0xb0,0x8a,0x24,0x0a,0xc9,0xcc,0xb8,0x09,0x1c,
    0xcb,0xb5,0xab,0xd3,0xb3,0x15,0x2f,0x76,0xe7,0xa1,0xc9,0x7b,0xbe,0x29,0x6e,0xf1,
    0xf5,0x98,0x4f,0x1c,0x94,0x4a,0x93,0xc7,0x25,0xe8,0xb9,0xd5,0x29,0x76,0xc8,0x66,
    0xbf,0xd6,0x82,0xfd,0x97,0xea,0xb0,0x7c,0x10,0x00,0x06,0x19,0x5f,0x44,0xcd,0x60,
    0xad,0xff,0x99,0xc9,0x67,0x8e,0x81,0x75,0x86,0xe4,0x70,0x26,0xad,0xe5,0x95,0x34,
    0x6a,0x57,0xd0,0x52,0xc9,0xe5,0x7b,0x4d,0xc4,0xff,0x2d,0xfe,0xcc,0x2b,0x7b,0x41,
    0x9e,0x5e,0x85,0xc8,0x4c,0x5d,0xdf,0xe5,0xd7,0xb4,0xb5,0xd2,0x21,0x20,0x4e,0x51,
    0x76,0x78,0x4d,0x75,0xc4,0xf2,0x5c,0xa1,0x3d,0x33,0x6f,0xad,0xe5,0x3d,0xf6,0xde,
    0xcf,0x8f,0x1f,0xc8,0xa7,0x82,0xf8,0x55,0x3d,0x4a,0x20,0xe2,0xa1,0x68,0x82,0xc0,
    0x3d,0xd6,0x8c,0x1a,0x07,0x06,0x05,0x04,0x03,0x02,0x01,0x00
};

//3.27	CW_S0_KL-AES_L3_TS-AES_TA
static HI_U8 CW_S0_KL_AES_L3_TS_AES_TA_TASKp[16]  = {0x23,0xA7,0x71,0x1A,0x81,0x33,0x28,0x76,0x37,0xEB,0xDC,0xD9,0xE8,0x7A,0x16,0x13};
static HI_U8 CW_S0_KL_AES_L3_TS_AES_TA_Transformation_Data[] = {
    0x0F,0xE3,0xDB,0x95,0x88,0x64,0x13,0x3F,0x58,0x3D,0x9A,0x2A,0xA8,0xCA,0x32,0x95,
    0x77,0x8D,0x32,0x75,0xB8,0x69,0xDB,0x1B,0xBF,0x28,0xC4,0xE9,0x31,0x3C,0xAA,0x90,
    0xD8,0x8A,0x03,0x79,0x5A,0x2B,0x33,0xEA,0x8C,0xB9,0x03,0x70,0x1B,0xAF,0xE0,0xEE,
    0x0A,0xBF,0xDD,0xD0,0x76,0xF2,0x4E,0xCB,0xB5,0xD6,0x6C,0x7A,0x0E,0x16,0x6B,0xB9,
    0xC5,0xF0,0x6B,0x9B,0x52,0x76,0xA9,0x77,0x89,0xE4,0xF9,0xE7,0x68,0x02,0x91,0xC3,
    0x80,0x03,0x99,0xBC,0x96,0xF2,0xFD,0xAD,0x1F,0x09,0x1A,0xF3,0x69,0x61,0x09,0x72,
    0xD9,0xA4,0x92,0xFC,0x7B,0xAE,0xC5,0x76,0xAD,0x06,0x99,0x82,0x93,0x87,0xF9,0x94,
    0xAE,0x3A,0x78,0xB1,0x8B,0x46,0x5F,0x83,0xDB,0xBC,0x8A,0x00,0xC6,0xF1,0x95,0x99,
    0xCE,0x61,0x07,0xB9,0xAE,0xBE,0x80,0x23,0xB5,0xD4,0x0B,0x85,0xAD,0x92,0x5C,0xB0,
    0x75,0x98,0xAD,0x83,0xCC,0x79,0x13,0xBC,0x6A,0x3C,0xB1,0x3E,0xF7,0x80,0xC3,0x22,
    0x4B,0x36,0xE7,0x0D,0x20,0x50,0x52,0xFB,0x44,0x8B,0xB3,0x05,0x25,0x74,0x86,0x84,
    0x2F,0x52,0xC2,0x3E,0x78,0xEA,0xE4,0x7F,0x81,0x48,0x43,0x4E,0xF8,0x08,0x6F,0xA1,
    0x25,0x57,0xA4,0x56,0x1D,0x08,0xFF,0x9E,0x04,0x8F,0xD3,0x24,0x77,0x99,0x01,0x7E,
    0xD6,0x90,0x42,0x19,0x57,0x4D,0xA8,0x73,0x52,0xEC,0xB9,0x0E,0x8D,0xE9,0xA2,0xED,
    0x3C,0xE9,0x08,0x80,0xDA,0x2A,0xE6,0xF4,0x02,0xF4,0x88,0xCB,0x3A,0xEF,0x36,0xCB,
    0xC2,0x63,0x72,0x5A,0x26,0x06,0x48,0xDF,0xDB,0xDB,0xF0,0xE4,0x5C,0xD7,0x38,0x0C,
    0x89,0xBE,0x1C,0x4E,0x64,0xAF,0xDB,0x5F,0xF6,0xE9,0xC7,0x26,0x31,0xEF,0x58,0xB0,
    0xE4,0x07,0xEB,0x2C,0xE5,0x58,0x75,0xB7,0x3C,0x64,0x7A,0x2E,0x82,0x90,0xC5,0x49,
    0xDA,0x27,0x8E,0xF1,0x81,0x5E,0x90,0xA6,0x6C,0x6D,0x80,0x78,0x60,0x74,0xFE,0xFE,
    0x7E,0x29,0x5A,0x7A,0xDD,0xF3,0x43,0xCD,0xCB,0x08,0x71,0xDC,0xA2,0x09,0x20,0x81,
    0x3A,0x11,0xE8,0xBB,0x6D,0x3C,0xB8,0xE1,0x26,0x43,0x4D,0xA9,0x13,0x46,0xEA,0xD4,
    0x2B,0x44,0x0D,0x5B,0x04,0xE9,0xF0,0xBC,0x17,0x1C,0xA5,0x27,0xBF,0xEC,0xDB,0x33,
    0xFE,0x85,0x4B,0xBE,0x56,0x54,0xCC,0x0B,0xAD,0xDF,0x26,0xBB,0x8A,0x48,0xDA,0x7C,
    0xCA,0x94,0xD7,0x2C,0x9F,0x34,0xA3,0xA7,0x0B,0x74,0x4F,0xEF,0x90,0x68,0xD3,0x1C,
    0x18,0x15,0xED,0xE8,0x15,0xE8,0x07,0xFD,0x79,0x3E,0x5F,0x3C,0x63,0x65,0xD2,0xF5,
    0x50,0x09,0x54,0x44,0x08,0x38,0x2F,0xC9,0x76,0xA9,0xB7,0x13,0x9E,0x27,0x83,0x62,
};

static HI_U8 CW_S0_KL_AES_L3_TS_AES_TA_CWAKp[] = {0x82,0xE2,0xE6,0x62,0xF7,0x28,0xB4,0xFA,0x42,0x48,0x5E,0x3A,0x0A,0x5D,0x2F,0x34};
static HI_U8 CW_S0_KL_AES_L3_TS_AES_TA_CWSKp[] = {0xD4,0x71,0x3D,0x60,0xC8,0xA7,0x06,0x39,0xEB,0x11,0x67,0xB3,0x67,0xA9,0xC3,0x78};
static HI_U8 CW_S0_KL_AES_L3_TS_AES_TA_CEK_pT[] = {0x5F,0xEE,0x52,0x35,0x63,0x69,0x94,0x12,0xB6,0xB5,0xEB,0xD7,0xB9,0x8F,0x17,0x69};
static HI_U8 Org_CW_S0_KL_AES_L3_TS_AES_TA[188] = {
    0x47,0x42,0x10,0x90,0x3a,0xfc,0x36,0x8d,0x00,0x40,0x06,0xc0,0xe4,0xa6,0x6e,0x83,
    0x77,0x82,0x2c,0xd0,0x60,0xb3,0xc8,0xb7,0xa9,0x0f,0xb2,0x32,0x62,0x4d,0x1e,0x36,
    0x9c,0x9a,0x68,0x2b,0x6c,0xcd,0x88,0xb0,0x8a,0x24,0x0a,0xc9,0xcc,0xb8,0x09,0x1c,
    0xcb,0xb5,0xab,0xd3,0xb3,0x15,0x2f,0x76,0xe7,0xa1,0xc9,0x7b,0xbe,0x29,0x6e,0xf1,
    0xf5,0x98,0x4f,0x1c,0x94,0x4a,0x93,0xc7,0x25,0xe8,0xb9,0xd5,0x29,0x76,0xc8,0x66,
    0xbf,0xd6,0x82,0xfd,0x97,0xea,0xb0,0x7c,0x10,0x00,0x06,0x19,0x5f,0x44,0xcd,0x60,
    0xad,0xff,0x99,0xc9,0x67,0x8e,0x81,0x75,0x86,0xe4,0x70,0x26,0xad,0xe5,0x95,0x34,
    0x6a,0x57,0xd0,0x52,0xc9,0xe5,0x7b,0x4d,0xc4,0xff,0x2d,0xfe,0xcc,0x2b,0x7b,0x41,
    0x9e,0x5e,0x85,0xc8,0x4c,0x5d,0xdf,0xe5,0xd7,0xb4,0xb5,0xd2,0x21,0x20,0x4e,0x51,
    0x76,0x78,0x4d,0x75,0xc4,0xf2,0x5c,0xa1,0x3d,0x33,0x6f,0xad,0xe5,0x3d,0xf6,0xde,
    0xcf,0x8f,0x1f,0xc8,0xa7,0x82,0xf8,0x55,0x3d,0x4a,0x20,0xe2,0xa1,0x68,0x82,0xc0,
    0x3d,0xd6,0x8c,0x1a,0x07,0x06,0x05,0x04,0x03,0x02,0x01,0x00
};

//3.28	CW_S0_KL-AES_L3_TS-CSA
static HI_U8 CW_S0_KL_AES_L3_TS_CSA_CWAKp[] = {0xE3,0xE7,0x06,0x82,0xC2,0x09,0x4C,0xAC,0x62,0x9F,0x6F,0xBE,0xD8,0x2C,0x07,0xCD};
static HI_U8 CW_S0_KL_AES_L3_TS_CSA_CWSKp[] = {0x82,0xE2,0xE6,0x62,0xF7,0x28,0xB4,0xFA,0x42,0x48,0x5E,0x3A,0x0A,0x5D,0x2F,0x34};
static HI_U8 CW_S0_KL_AES_L3_TS_CSA_CEK_p[] = {0x42,0x22,0x27,0x3E,0xB5,0xBF,0x80,0x10,0xC4,0xEA,0xAC,0xDD,0x21,0xF8,0x0D,0x49};
HI_U8 Org_CW_S0_KL_AES_L3_TS_CSA[188] = {
    0x47,0x42,0x10,0x90,0x4F,0x0C,0xCC,0xA6,0xD3,0xA2,0x71,0x41,0x2D,0xAA,0x76,0xD0,
    0xED,0x57,0xC0,0xC5,0x00,0xAA,0xF2,0xA4,0x5C,0xE9,0xF6,0x2E,0xA4,0x06,0xAC,0x41,
    0x5E,0xDC,0x42,0xD9,0x8A,0x76,0x4E,0x45,0xBF,0xC0,0xE7,0xE9,0x9C,0x83,0x95,0xF6,
    0x22,0xF5,0x3D,0xFA,0x92,0x76,0xBF,0x17,0x40,0x59,0x88,0xE0,0x45,0xC9,0xE3,0x47,
    0xDD,0x68,0x4E,0x94,0x00,0x2A,0x43,0x36,0xF6,0xBB,0xF2,0x99,0x9D,0x4E,0x5C,0x76,
    0xAC,0x54,0x6C,0xB7,0xDA,0x69,0x22,0x40,0x58,0x22,0x27,0xB9,0xB5,0xD2,0x21,0x69,
    0x96,0x24,0x9D,0xCF,0xD7,0x8E,0xF6,0x7D,0xF0,0xFC,0x10,0x4B,0xC8,0x63,0xC8,0x3A,
    0x76,0x4A,0x25,0x05,0x58,0x3D,0xDE,0xE6,0xA9,0x8B,0x79,0xF4,0x73,0xCD,0xEF,0xC6,
    0xA7,0x43,0x76,0xC5,0xF2,0x64,0x47,0x4B,0x89,0xB1,0x07,0xB2,0xA4,0xC1,0x95,0xFC,
    0x94,0xA9,0xC3,0xBA,0x82,0x5C,0xB0,0xDF,0xDA,0x11,0x9F,0xE1,0x31,0x44,0x3F,0x48,
    0xF9,0x41,0xD2,0x97,0x99,0x78,0x73,0x16,0x8E,0xB3,0x43,0x10,0x5A,0x41,0x4B,0x12,
    0x87,0x69,0xC7,0x5D,0x70,0xB9,0x6F,0x3C,0x8D,0x00,0x8D,0xBA
};

//3.29	CW_S0_KL-AES_L3_TS-CSA_TA
static HI_U8 CW_S0_KL_AES_L3_TS_CSA_TA_CWAKp[]  = {0xE3,0xE7,0x06,0x82,0xC2,0x09,0x4C,0xAC,0x62,0x9F,0x6F,0xBE,0xD8,0x2C,0x07,0xCD};
static HI_U8 CW_S0_KL_AES_L3_TS_CSA_TA_CWSKp[]  = {0x82,0xE2,0xE6,0x62,0xF7,0x28,0xB4,0xFA,0x42,0x48,0x5E,0x3A,0x0A,0x5D,0x2F,0x34};
static HI_U8 CW_S0_KL_AES_L3_TS_CSA_TA_TASKp[]  = {0xD4,0x71,0x3D,0x60,0xC8,0xA7,0x06,0x39,0xEB,0x11,0x67,0xB3,0x67,0xA9,0xC3,0x78};
HI_U8 CW_S0_KL_AES_L3_TS_CSA_TA_Transformation_Data[] = {
    0x13,0x7C,0xD3,0xD8,0xD8,0xF7,0xDE,0x45,0x02,0x49,0x5D,0x2C,0xAE,0x87,0xE2,0xC9,
    0x29,0xF1,0x8D,0x89,0x58,0x19,0xFB,0xAC,0x45,0x50,0x68,0x99,0xEF,0xFB,0xAC,0x8C,
    0xD4,0x7E,0xA1,0x12,0x16,0x9D,0x5A,0x4D,0xC7,0xCA,0x44,0xA0,0xE1,0xDD,0xBE,0x47,
    0x5D,0xC7,0xB4,0x62,0xFB,0xA5,0x6B,0x70,0x5F,0xE9,0x0F,0x42,0xFB,0x6C,0x95,0x9D,
    0x87,0x0F,0xE5,0xFC,0x9F,0x34,0xB5,0x06,0x8C,0x76,0x21,0x0D,0x3A,0x65,0xB2,0xDE,
    0x6F,0x8D,0xA1,0xAF,0x86,0xCE,0x65,0xA0,0xC3,0xC2,0xE0,0xBB,0x46,0x90,0x4A,0xC5,
    0xC2,0x4D,0x34,0xF7,0xC7,0x6E,0x08,0x74,0xBE,0xE6,0x57,0xE0,0xD2,0xA1,0xB6,0x47,
    0x31,0xD9,0x3B,0x09,0xD8,0xF7,0x2C,0x02,0x34,0xC5,0xC5,0x11,0xDF,0xD9,0xA0,0x9A,
    0xA2,0x72,0xB7,0xF8,0x84,0x19,0x79,0x5A,0xBA,0xE0,0xE9,0x17,0x99,0x0D,0xF3,0x12,
    0x37,0x16,0x4D,0x03,0xCE,0x82,0x9A,0xAF,0xB2,0xEB,0xBC,0x2F,0x8F,0x12,0x3C,0xD4,
    0xD0,0x8D,0x48,0x99,0x63,0xCC,0xAD,0x99,0xEC,0x79,0xF3,0x60,0xB0,0x69,0xF4,0x51,
    0x7A,0xA0,0xC9,0x9C,0x21,0xDA,0x43,0x5A,0xDD,0x6B,0xCF,0x8C,0xCF,0x0C,0x19,0xC7,
    0x76,0x26,0xCE,0xE5,0x8A,0xAB,0x42,0x1B,0xA4,0x0A,0x86,0xD4,0xD4,0x0D,0xEE,0xE9,
    0xC1,0x12,0x27,0x67,0x94,0x97,0xF8,0xCA,0x70,0x60,0x20,0x58,0xBC,0x62,0x75,0x2A,
    0x8F,0xB5,0x19,0xE3,0xB7,0xC3,0x5E,0xB8,0xB4,0x3C,0xA9,0x10,0x63,0x5C,0x6E,0x8C,
    0xBE,0xDA,0xA7,0x1E,0xC5,0xD5,0x03,0x3E,0x58,0xF7,0x9F,0x3A,0x9C,0x56,0x84,0x33,
    0xB1,0x50,0x0C,0x13,0x6C,0x69,0xFB,0xBB,0x6B,0x4B,0x5D,0x5E,0x94,0x18,0x61,0x11,
    0x7D,0x4D,0x91,0x85,0x64,0x38,0x6C,0x3B,0xA0,0xE0,0x51,0xE2,0xD5,0x1C,0xCF,0x1A,
    0x68,0x52,0xFF,0x3A,0x80,0xD2,0xB3,0x04,0x50,0x31,0x10,0xB3,0xCB,0x3B,0x3E,0xCB,
    0x47,0x61,0xEA,0x38,0xD7,0x35,0x96,0x5A,0xCC,0xBE,0xF5,0xCE,0x35,0x6F,0xE4,0x70,
    0xB3,0x4C,0x4D,0xBA,0xE8,0x8C,0x23,0x89,0x4B,0x52,0xD1,0x13,0x87,0x3C,0xE7,0x2F,
    0x7D,0x41,0x66,0xC1,0x90,0xDC,0x95,0xDC,0xD9,0x0B,0xD3,0x7F,0xCB,0xF1,0x34,0x85,
    0xCA,0x96,0xA4,0x51,0x29,0xFA,0xD9,0xDC,0xAD,0x4E,0x45,0x69,0xAA,0xE8,0x5E,0xFD,
    0xDD,0x08,0x1A,0x04,0xFB,0x80,0x92,0xD5,0x3D,0x57,0x17,0x41,0x87,0xE6,0x22,0xF8,
    0xB2,0xBF,0x9C,0xE7,0x79,0x84,0x35,0x66,0x2E,0x68,0x78,0x31,0xED,0xF6,0x4D,0xA4,
    0x49,0xF0,0x59,0x98,0x4C,0x81,0xD2,0x27,0x91,0x64,0x66,0x37,0x12,0x40,0x71,0x45,
};
HI_U8 CW_S0_KL_AES_L3_TS_CSA_TA_CEK_pT[] = {0x36,0xE8,0xE6,0x75,0x18,0x1E,0xEE,0xE2,0x83,0x84,0x6C,0xCC,0x78,0x9B,0xFA,0x27};
HI_U8 Org_CW_S0_KL_AES_L3_TS_CSA_TA[188] = {
    0x47,0x42,0x10,0x90,0x4F,0x0C,0xCC,0xA6,0xD3,0xA2,0x71,0x41,0x2D,0xAA,0x76,0xD0,0xED,0x57,0xC0,0xC5,
    0x00,0xAA,0xF2,0xA4,0x5C,0xE9,0xF6,0x2E,0xA4,0x06,0xAC,0x41,0x5E,0xDC,0x42,0xD9,
    0x8A,0x76,0x4E,0x45,0xBF,0xC0,0xE7,0xE9,0x9C,0x83,0x95,0xF6,0x22,0xF5,0x3D,0xFA,
    0x92,0x76,0xBF,0x17,0x40,0x59,0x88,0xE0,0x45,0xC9,0xE3,0x47,0xDD,0x68,0x4E,0x94,
    0x00,0x2A,0x43,0x36,0xF6,0xBB,0xF2,0x99,0x9D,0x4E,0x5C,0x76,0xAC,0x54,0x6C,0xB7,
    0xDA,0x69,0x22,0x40,0x58,0x22,0x27,0xB9,0xB5,0xD2,0x21,0x69,0x96,0x24,0x9D,0xCF,
    0xD7,0x8E,0xF6,0x7D,0xF0,0xFC,0x10,0x4B,0xC8,0x63,0xC8,0x3A,0x76,0x4A,0x25,0x05,
    0x58,0x3D,0xDE,0xE6,0xA9,0x8B,0x79,0xF4,0x73,0xCD,0xEF,0xC6,0xA7,0x43,0x76,0xC5,
    0xF2,0x64,0x47,0x4B,0x89,0xB1,0x07,0xB2,0xA4,0xC1,0x95,0xFC,0x94,0xA9,0xC3,0xBA,
    0x82,0x5C,0xB0,0xDF,0xDA,0x11,0x9F,0xE1,0x31,0x44,0x3F,0x48,0xF9,0x41,0xD2,0x97,
    0x99,0x78,0x73,0x16,0x8E,0xB3,0x43,0x10,0x5A,0x41,0x4B,0x12,0x87,0x69,0xC7,0x5D,
    0x70,0xB9,0x6F,0x3C,0x8D,0x00,0x8D,0xBA
};

//3.30	CW_S0_KL-AES_L3_TS-CSA3
static HI_U8 CW_S0_KL_AES_L3_TS_CSA3_CWAKp[] = {0xE3,0xE7,0x06,0x82,0xC2,0x09,0x4C,0xAC,0x62,0x9F,0x6F,0xBE,0xD8,0x2C,0x07,0xCD};
static HI_U8 CW_S0_KL_AES_L3_TS_CSA3_CWSKp[] = {0x82,0xE2,0xE6,0x62,0xF7,0x28,0xB4,0xFA,0x42,0x48,0x5E,0x3A,0x0A,0x5D,0x2F,0x34};
static HI_U8 CW_S0_KL_AES_L3_TS_CSA3_CEK_p[] = {0xF0,0x97,0x94,0xC6,0x5B,0x11,0x0D,0x33,0x1B,0x83,0x0B,0x4E,0xFE,0x31,0x51,0x36};
HI_U8 Org_CW_S0_KL_AES_L3_TS_CSA3[188] = {
    0x47,0x42,0x10,0x90,0x14,0x5C,0x5D,0x60,0xDE,0x00,0x06,0xBD,0x87,0xED,0xBE,0x80,
    0x55,0xB7,0xEF,0xE3,0xA1,0x29,0x1A,0x52,0xB8,0x22,0xDB,0x12,0xA1,0x8A,0x6B,0x1A,
    0x9F,0x2B,0x4C,0xD8,0x9B,0x68,0x38,0x39,0x1E,0xEF,0xB5,0x4F,0xF7,0xA2,0x7D,0xB9,
    0x5A,0xCA,0xE2,0xDC,0x33,0x44,0xAB,0x2F,0x58,0xB7,0xB0,0x85,0x26,0x68,0x5B,0x67,
    0xA0,0x28,0x33,0x4E,0xAB,0x11,0xF2,0x37,0x7B,0xA6,0xBC,0x54,0xE0,0x26,0x02,0x3D,
    0x54,0x57,0x61,0xD2,0x76,0x62,0xC0,0xCE,0x04,0xB4,0xC8,0x63,0x2F,0x4C,0x2E,0x8C,
    0x89,0x95,0x37,0xAD,0x9A,0xDB,0x2A,0x05,0x2A,0x7A,0xB6,0x75,0x3F,0x8B,0x3C,0x2A,
    0xA4,0x0F,0x4B,0x42,0x4E,0xE7,0x51,0x2A,0xE4,0xF5,0x9A,0x6A,0x64,0x4B,0x4A,0x4D,
    0x27,0x82,0x7F,0x2B,0x48,0xFE,0x38,0x0F,0x5B,0x6D,0xE3,0x2D,0x94,0x84,0x47,0x44,
    0xD7,0xD7,0x7D,0xF3,0x0C,0xFE,0xED,0x8C,0xB6,0x77,0xE9,0x88,0x00,0xEB,0xC6,0x78,
    0x3C,0x09,0x66,0x55,0x9E,0x01,0x97,0x8F,0xC0,0xDC,0xDD,0x2E,0x6F,0xDF,0x85,0x5E,
    0xFB,0xBD,0x73,0x91,0xF2,0x28,0x94,0x33,0x90,0xFA,0xDB,0xBD
};

//3.31	CW_S0_KL-AES_L3_TS-CSA3_TA
static HI_U8 CW_S0_KL_AES_L3_TS_CSA3_TA_CWAKp[]  = {0xE3,0xE7,0x06,0x82,0xC2,0x09,0x4C,0xAC,0x62,0x9F,0x6F,0xBE,0xD8,0x2C,0x07,0xCD};
static HI_U8 CW_S0_KL_AES_L3_TS_CSA3_TA_CWSKp[]  = {0x82,0xE2,0xE6,0x62,0xF7,0x28,0xB4,0xFA,0x42,0x48,0x5E,0x3A,0x0A,0x5D,0x2F,0x34};
static HI_U8 CW_S0_KL_AES_L3_TS_CSA3_TA_TASKp[]  = {0xD4,0x71,0x3D,0x60,0xC8,0xA7,0x06,0x39,0xEB,0x11,0x67,0xB3,0x67,0xA9,0xC3,0x78};
HI_U8 CW_S0_KL_AES_L3_TS_CSA3_TA_Transformation_Data[] = {
    0x13,0x7C,0xD3,0xD8,0xD8,0xF7,0xDE,0x45,0x02,0x49,0x5D,0x2C,0xAE,0x87,0xE2,0xC9,
    0x29,0xF1,0x8D,0x89,0x58,0x19,0xFB,0xAC,0x45,0x50,0x68,0x99,0xEF,0xFB,0xAC,0x8C,
    0xD4,0x7E,0xA1,0x12,0x16,0x9D,0x5A,0x4D,0xC7,0xCA,0x44,0xA0,0xE1,0xDD,0xBE,0x47,
    0x5D,0xC7,0xB4,0x62,0xFB,0xA5,0x6B,0x70,0x5F,0xE9,0x0F,0x42,0xFB,0x6C,0x95,0x9D,
    0x87,0x0F,0xE5,0xFC,0x9F,0x34,0xB5,0x06,0x8C,0x76,0x21,0x0D,0x3A,0x65,0xB2,0xDE,
    0x6F,0x8D,0xA1,0xAF,0x86,0xCE,0x65,0xA0,0xC3,0xC2,0xE0,0xBB,0x46,0x90,0x4A,0xC5,
    0xC2,0x4D,0x34,0xF7,0xC7,0x6E,0x08,0x74,0xBE,0xE6,0x57,0xE0,0xD2,0xA1,0xB6,0x47,
    0x31,0xD9,0x3B,0x09,0xD8,0xF7,0x2C,0x02,0x34,0xC5,0xC5,0x11,0xDF,0xD9,0xA0,0x9A,
    0xA2,0x72,0xB7,0xF8,0x84,0x19,0x79,0x5A,0xBA,0xE0,0xE9,0x17,0x99,0x0D,0xF3,0x12,
    0x37,0x16,0x4D,0x03,0xCE,0x82,0x9A,0xAF,0xB2,0xEB,0xBC,0x2F,0x8F,0x12,0x3C,0xD4,
    0xD0,0x8D,0x48,0x99,0x63,0xCC,0xAD,0x99,0xEC,0x79,0xF3,0x60,0xB0,0x69,0xF4,0x51,
    0x7A,0xA0,0xC9,0x9C,0x21,0xDA,0x43,0x5A,0xDD,0x6B,0xCF,0x8C,0xCF,0x0C,0x19,0xC7,
    0x76,0x26,0xCE,0xE5,0x8A,0xAB,0x42,0x1B,0xA4,0x0A,0x86,0xD4,0xD4,0x0D,0xEE,0xE9,
    0xC1,0x12,0x27,0x67,0x94,0x97,0xF8,0xCA,0x70,0x60,0x20,0x58,0xBC,0x62,0x75,0x2A,
    0x8F,0xB5,0x19,0xE3,0xB7,0xC3,0x5E,0xB8,0xB4,0x3C,0xA9,0x10,0x63,0x5C,0x6E,0x8C,
    0xBE,0xDA,0xA7,0x1E,0xC5,0xD5,0x03,0x3E,0x58,0xF7,0x9F,0x3A,0x9C,0x56,0x84,0x33,
    0xB1,0x50,0x0C,0x13,0x6C,0x69,0xFB,0xBB,0x6B,0x4B,0x5D,0x5E,0x94,0x18,0x61,0x11,
    0x7D,0x4D,0x91,0x85,0x64,0x38,0x6C,0x3B,0xA0,0xE0,0x51,0xE2,0xD5,0x1C,0xCF,0x1A,
    0x68,0x52,0xFF,0x3A,0x80,0xD2,0xB3,0x04,0x50,0x31,0x10,0xB3,0xCB,0x3B,0x3E,0xCB,
    0x47,0x61,0xEA,0x38,0xD7,0x35,0x96,0x5A,0xCC,0xBE,0xF5,0xCE,0x35,0x6F,0xE4,0x70,
    0xB3,0x4C,0x4D,0xBA,0xE8,0x8C,0x23,0x89,0x4B,0x52,0xD1,0x13,0x87,0x3C,0xE7,0x2F,
    0x7D,0x41,0x66,0xC1,0x90,0xDC,0x95,0xDC,0xD9,0x0B,0xD3,0x7F,0xCB,0xF1,0x34,0x85,
    0xCA,0x96,0xA4,0x51,0x29,0xFA,0xD9,0xDC,0xAD,0x4E,0x45,0x69,0xAA,0xE8,0x5E,0xFD,
    0xDD,0x08,0x1A,0x04,0xFB,0x80,0x92,0xD5,0x3D,0x57,0x17,0x41,0x87,0xE6,0x22,0xF8,
    0xB2,0xBF,0x9C,0xE7,0x79,0x84,0x35,0x66,0x2E,0x68,0x78,0x31,0xED,0xF6,0x4D,0xA4,
    0x49,0xF0,0x59,0x98,0x4C,0x81,0xD2,0x27,0x91,0x64,0x66,0x37,0x12,0x40,0x71,0x45,
};
HI_U8 CW_S0_KL_AES_L3_TS_CSA3_TA_CEK_pT[] = {0x79,0xC1,0x7C,0xFF,0x35,0xF0,0x76,0xB6,0xF4,0x3D,0x22,0x95,0x1E,0xB3,0x1C,0xED};
HI_U8 Org_CW_S0_KL_AES_L3_TS_CSA3_TA[188] = {
    0x47,0x42,0x10,0x90,0x14,0x5C,0x5D,0x60,0xDE,0x00,0x06,0xBD,0x87,0xED,0xBE,0x80,
    0x55,0xB7,0xEF,0xE3,0xA1,0x29,0x1A,0x52,0xB8,0x22,0xDB,0x12,0xA1,0x8A,0x6B,0x1A,
    0x9F,0x2B,0x4C,0xD8,0x9B,0x68,0x38,0x39,0x1E,0xEF,0xB5,0x4F,0xF7,0xA2,0x7D,0xB9,
    0x5A,0xCA,0xE2,0xDC,0x33,0x44,0xAB,0x2F,0x58,0xB7,0xB0,0x85,0x26,0x68,0x5B,0x67,
    0xA0,0x28,0x33,0x4E,0xAB,0x11,0xF2,0x37,0x7B,0xA6,0xBC,0x54,0xE0,0x26,0x02,0x3D,
    0x54,0x57,0x61,0xD2,0x76,0x62,0xC0,0xCE,0x04,0xB4,0xC8,0x63,0x2F,0x4C,0x2E,0x8C,
    0x89,0x95,0x37,0xAD,0x9A,0xDB,0x2A,0x05,0x2A,0x7A,0xB6,0x75,0x3F,0x8B,0x3C,0x2A,
    0xA4,0x0F,0x4B,0x42,0x4E,0xE7,0x51,0x2A,0xE4,0xF5,0x9A,0x6A,0x64,0x4B,0x4A,0x4D,
    0x27,0x82,0x7F,0x2B,0x48,0xFE,0x38,0x0F,0x5B,0x6D,0xE3,0x2D,0x94,0x84,0x47,0x44,
    0xD7,0xD7,0x7D,0xF3,0x0C,0xFE,0xED,0x8C,0xB6,0x77,0xE9,0x88,0x00,0xEB,0xC6,0x78,
    0x3C,0x09,0x66,0x55,0x9E,0x01,0x97,0x8F,0xC0,0xDC,0xDD,0x2E,0x6F,0xDF,0x85,0x5E,
    0xFB,0xBD,0x73,0x91,0xF2,0x28,0x94,0x33,0x90,0xFA,0xDB,0xBD
};

//3.32	CW_S0_KL-AES_L3_TS-TCSA3
static HI_U8 CW_S0_KL_AES_L3_TS_TCSA3_CWAKp[] = {0xE3,0xE7,0x06,0x82,0xC2,0x09,0x4C,0xAC,0x62,0x9F,0x6F,0xBE,0xD8,0x2C,0x07,0xCD};
static HI_U8 CW_S0_KL_AES_L3_TS_TCSA3_CWSKp[] = {0x82,0xE2,0xE6,0x62,0xF7,0x28,0xB4,0xFA,0x42,0x48,0x5E,0x3A,0x0A,0x5D,0x2F,0x34};
static HI_U8 CW_S0_KL_AES_L3_TS_TCSA3_CEK_p[] = {0xF0,0x97,0x94,0xC6,0x5B,0x11,0x0D,0x33,0x1B,0x83,0x0B,0x4E,0xFE,0x31,0x51,0x36};
HI_U8 Org_CW_S0_KL_AES_L3_TS_TCSA3[188] = {
    0x47,0x42,0x10,0x90,0xE6,0x34,0x0B,0x6E,0xBA,0x46,0xF2,0xD4,0x12,0x25,0xF0,0xD7,0x1C,0xCC,0xF3,0x45,
    0x57,0x94,0x82,0x74,0xEA,0x50,0x44,0x87,0xB8,0x33,0xAF,0x09,0xF6,0x62,0x5C,0x12,
    0xCF,0x71,0x83,0x34,0x59,0xC8,0xE3,0x1F,0x66,0xFF,0xD7,0x3B,0x04,0x9C,0xF4,0xB1,
    0xC5,0x61,0xE2,0x74,0xAA,0xA8,0xCD,0xCA,0x88,0x13,0xAF,0x18,0x8D,0x71,0x3F,0x88,
    0x39,0xA4,0xC1,0xC3,0x9F,0x4A,0x40,0x9C,0xAA,0xF9,0x27,0xFD,0xF8,0x9A,0xFB,0xE5,
    0x2E,0x67,0x79,0xD3,0xF2,0x3B,0x5F,0x95,0x45,0x58,0xEB,0x38,0xF3,0x9B,0x66,0x7B,
    0xA0,0x1B,0xEE,0x32,0x4D,0xAA,0x0A,0x26,0xE8,0x59,0x10,0xDD,0x8B,0x9F,0x8A,0x43,
    0xDF,0xBA,0x85,0x41,0x45,0x40,0xF1,0x95,0xA7,0xA0,0x0D,0x10,0x2D,0x97,0xE3,0x17,
    0x55,0x62,0x26,0xB2,0xB3,0xE6,0xFD,0xC5,0x13,0x76,0x61,0x79,0xB9,0xB3,0xA9,0x34,
    0x80,0xC4,0x1D,0x90,0x33,0x68,0xAD,0xC6,0xB8,0x18,0x3C,0x9B,0x91,0x58,0x24,0xC3,
    0xB4,0x18,0x7A,0x3C,0x3F,0x4B,0x04,0xBC,0xC6,0xF7,0xD8,0x72,0x8F,0x28,0xA1,0x72,
    0x5E,0x5E,0x25,0xD2,0xD8,0x2B,0x35,0x57,
};
HI_U8 CW_S0_KL_AES_L3_TS_TCSA3_ACTIVATION[] = {0x7F,0xA0,0x40,0x74,0xA6,0x06,0x0C,0x2D,0x97,0x7C,0xE6,0x62,0x14,0x26,0xAE,0x5F};

//3.33	CW_S0_KL-AES_L3_TS-TCSA3_TA
static HI_U8 CW_S0_KL_AES_L3_TS_TCSA3_TA_CWAKp[]  = {0xE3,0xE7,0x06,0x82,0xC2,0x09,0x4C,0xAC,0x62,0x9F,0x6F,0xBE,0xD8,0x2C,0x07,0xCD};
static HI_U8 CW_S0_KL_AES_L3_TS_TCSA3_TA_CWSKp[]  = {0x82,0xE2,0xE6,0x62,0xF7,0x28,0xB4,0xFA,0x42,0x48,0x5E,0x3A,0x0A,0x5D,0x2F,0x34};
static HI_U8 CW_S0_KL_AES_L3_TS_TCSA3_TA_TASKp[]  = {0xD4,0x71,0x3D,0x60,0xC8,0xA7,0x06,0x39,0xEB,0x11,0x67,0xB3,0x67,0xA9,0xC3,0x78};
HI_U8 CW_S0_KL_AES_L3_TS_TCSA3_TA_Transformation_Data[] = {
    0x13,0x7C,0xD3,0xD8,0xD8,0xF7,0xDE,0x45,0x02,0x49,0x5D,0x2C,0xAE,0x87,0xE2,0xC9,
    0x29,0xF1,0x8D,0x89,0x58,0x19,0xFB,0xAC,0x45,0x50,0x68,0x99,0xEF,0xFB,0xAC,0x8C,
    0xD4,0x7E,0xA1,0x12,0x16,0x9D,0x5A,0x4D,0xC7,0xCA,0x44,0xA0,0xE1,0xDD,0xBE,0x47,
    0x5D,0xC7,0xB4,0x62,0xFB,0xA5,0x6B,0x70,0x5F,0xE9,0x0F,0x42,0xFB,0x6C,0x95,0x9D,
    0x87,0x0F,0xE5,0xFC,0x9F,0x34,0xB5,0x06,0x8C,0x76,0x21,0x0D,0x3A,0x65,0xB2,0xDE,
    0x6F,0x8D,0xA1,0xAF,0x86,0xCE,0x65,0xA0,0xC3,0xC2,0xE0,0xBB,0x46,0x90,0x4A,0xC5,
    0xC2,0x4D,0x34,0xF7,0xC7,0x6E,0x08,0x74,0xBE,0xE6,0x57,0xE0,0xD2,0xA1,0xB6,0x47,
    0x31,0xD9,0x3B,0x09,0xD8,0xF7,0x2C,0x02,0x34,0xC5,0xC5,0x11,0xDF,0xD9,0xA0,0x9A,
    0xA2,0x72,0xB7,0xF8,0x84,0x19,0x79,0x5A,0xBA,0xE0,0xE9,0x17,0x99,0x0D,0xF3,0x12,
    0x37,0x16,0x4D,0x03,0xCE,0x82,0x9A,0xAF,0xB2,0xEB,0xBC,0x2F,0x8F,0x12,0x3C,0xD4,
    0xD0,0x8D,0x48,0x99,0x63,0xCC,0xAD,0x99,0xEC,0x79,0xF3,0x60,0xB0,0x69,0xF4,0x51,
    0x7A,0xA0,0xC9,0x9C,0x21,0xDA,0x43,0x5A,0xDD,0x6B,0xCF,0x8C,0xCF,0x0C,0x19,0xC7,
    0x76,0x26,0xCE,0xE5,0x8A,0xAB,0x42,0x1B,0xA4,0x0A,0x86,0xD4,0xD4,0x0D,0xEE,0xE9,
    0xC1,0x12,0x27,0x67,0x94,0x97,0xF8,0xCA,0x70,0x60,0x20,0x58,0xBC,0x62,0x75,0x2A,
    0x8F,0xB5,0x19,0xE3,0xB7,0xC3,0x5E,0xB8,0xB4,0x3C,0xA9,0x10,0x63,0x5C,0x6E,0x8C,
    0xBE,0xDA,0xA7,0x1E,0xC5,0xD5,0x03,0x3E,0x58,0xF7,0x9F,0x3A,0x9C,0x56,0x84,0x33,
    0xB1,0x50,0x0C,0x13,0x6C,0x69,0xFB,0xBB,0x6B,0x4B,0x5D,0x5E,0x94,0x18,0x61,0x11,
    0x7D,0x4D,0x91,0x85,0x64,0x38,0x6C,0x3B,0xA0,0xE0,0x51,0xE2,0xD5,0x1C,0xCF,0x1A,
    0x68,0x52,0xFF,0x3A,0x80,0xD2,0xB3,0x04,0x50,0x31,0x10,0xB3,0xCB,0x3B,0x3E,0xCB,
    0x47,0x61,0xEA,0x38,0xD7,0x35,0x96,0x5A,0xCC,0xBE,0xF5,0xCE,0x35,0x6F,0xE4,0x70,
    0xB3,0x4C,0x4D,0xBA,0xE8,0x8C,0x23,0x89,0x4B,0x52,0xD1,0x13,0x87,0x3C,0xE7,0x2F,
    0x7D,0x41,0x66,0xC1,0x90,0xDC,0x95,0xDC,0xD9,0x0B,0xD3,0x7F,0xCB,0xF1,0x34,0x85,
    0xCA,0x96,0xA4,0x51,0x29,0xFA,0xD9,0xDC,0xAD,0x4E,0x45,0x69,0xAA,0xE8,0x5E,0xFD,
    0xDD,0x08,0x1A,0x04,0xFB,0x80,0x92,0xD5,0x3D,0x57,0x17,0x41,0x87,0xE6,0x22,0xF8,
    0xB2,0xBF,0x9C,0xE7,0x79,0x84,0x35,0x66,0x2E,0x68,0x78,0x31,0xED,0xF6,0x4D,0xA4,
    0x49,0xF0,0x59,0x98,0x4C,0x81,0xD2,0x27,0x91,0x64,0x66,0x37,0x12,0x40,0x71,0x45,
};
HI_U8 CW_S0_KL_AES_L3_TS_TCSA3_TA_CEK_pT[] = {0x79,0xC1,0x7C,0xFF,0x35,0xF0,0x76,0xB6,0xF4,0x3D,0x22,0x95,0x1E,0xB3,0x1C,0xED};
HI_U8 Org_CW_S0_KL_AES_L3_TS_TCSA3_TA[188] = {
    0x47,0x42,0x10,0x90,0xE6,0x34,0x0B,0x6E,0xBA,0x46,0xF2,0xD4,0x12,0x25,0xF0,0xD7,0x1C,0xCC,0xF3,0x45,
    0x57,0x94,0x82,0x74,0xEA,0x50,0x44,0x87,0xB8,0x33,0xAF,0x09,0xF6,0x62,0x5C,0x12,
    0xCF,0x71,0x83,0x34,0x59,0xC8,0xE3,0x1F,0x66,0xFF,0xD7,0x3B,0x04,0x9C,0xF4,0xB1,
    0xC5,0x61,0xE2,0x74,0xAA,0xA8,0xCD,0xCA,0x88,0x13,0xAF,0x18,0x8D,0x71,0x3F,0x88,
    0x39,0xA4,0xC1,0xC3,0x9F,0x4A,0x40,0x9C,0xAA,0xF9,0x27,0xFD,0xF8,0x9A,0xFB,0xE5,
    0x2E,0x67,0x79,0xD3,0xF2,0x3B,0x5F,0x95,0x45,0x58,0xEB,0x38,0xF3,0x9B,0x66,0x7B,
    0xA0,0x1B,0xEE,0x32,0x4D,0xAA,0x0A,0x26,0xE8,0x59,0x10,0xDD,0x8B,0x9F,0x8A,0x43,
    0xDF,0xBA,0x85,0x41,0x45,0x40,0xF1,0x95,0xA7,0xA0,0x0D,0x10,0x2D,0x97,0xE3,0x17,
    0x55,0x62,0x26,0xB2,0xB3,0xE6,0xFD,0xC5,0x13,0x76,0x61,0x79,0xB9,0xB3,0xA9,0x34,
    0x80,0xC4,0x1D,0x90,0x33,0x68,0xAD,0xC6,0xB8,0x18,0x3C,0x9B,0x91,0x58,0x24,0xC3,
    0xB4,0x18,0x7A,0x3C,0x3F,0x4B,0x04,0xBC,0xC6,0xF7,0xD8,0x72,0x8F,0x28,0xA1,0x72,
    0x5E,0x5E,0x25,0xD2,0xD8,0x2B,0x35,0x57
};
HI_U8 CW_S0_KL_AES_L3_TS_TCSA3_TA_ACTIVATION[] = {0x7F,0xA0,0x40,0x74,0xA6,0x06,0x0C,0x2D,0x97,0x7C,0xE6,0x62,0x14,0x26,0xAE,0x5F};

//3.34	PVR_S0_KL-2TDES_L2_TS-2TDES_CBC
static HI_U8 PVR_S0_KL_2TDES_L2_TS_2TDES_CBC_CPSKp[]  = {0x82,0xE2,0xE6,0x62,0xF7,0x28,0xB4,0xFA,0x42,0x48,0x5E,0x3A,0x0A,0x5D,0x2F,0x34};
static HI_U8 PVR_S0_KL_2TDES_L2_TS_2TDES_CBC_CEK_p[]  = {0x30,0x08,0x56,0xFC,0x9B,0x78,0x3A,0x60,0x0C,0x76,0x53,0x11,0xB2,0x6B,0x2D,0x2A};
static HI_U8 PVR_S0_KL_2TDES_L2_TS_2TDES_CBC_Encrypted_payload[] = {
    0xA7,0x98,0x53,0xD7,0x77,0x7E,0x85,0x3D,0xEC,0x8C,0x6B,0xC4,0xB3,0x5D,0xB7,0xAF,
    0xC8,0x24,0x61,0xC3,0xB7,0xB1,0x00,0x2D,0xB5,0x19,0xE1,0x10,0x88,0x36,0x0E,0xA4,
    0x71,0x07,0xA8,0xEC,0xF1,0xBA,0xBB,0xBA,0x8E,0x25,0xB8,0x26,0x46,0x57,0x82,0xD1,
    0x08,0xBA,0xD3,0xF0,0xB6,0x4F,0x94,0xCF,0x95,0xBE,0x26,0x55,0xF6,0x82,0xFE,0x31,
    0x87,0x1C,0x1A,0x40,0x98,0x9C,0xFF,0x7A,0xD8,0x30,0x6E,0xCE,0xE2,0x22,0xFF,0x54,
    0x69,0x14,0x8E,0xEE,0x45,0x45,0xAC,0xC7,0xB0,0x99,0xA5,0x47,0x8E,0x2B,0xEC,0x24,
    0xB0,0x3C,0xE3,0xB7,0xBA,0x4E,0xB2,0x99,0xEA,0xCD,0x82,0x67,0xB5,0xDF,0x93,0x7F,
    0x10,0x93,0x0A,0x55,0x5D,0xDB,0xDA,0x1E,0x21,0x52,0x57,0xEE,0xF5,0xD6,0x19,0xEB,
    0x90,0x08,0x84,0x55,0x1E,0x4C,0xC3,0xCE,0x82,0x0F,0xCB,0xB7,0xF5,0xD4,0xD5,0x39,
    0xB9,0x56,0xEC,0x8F,0x9B,0xBE,0x99,0x57,0x35,0x19,0xCF,0x5B,0x7B,0x7A,0x98,0x98,
    0xD0,0xB9,0x06,0xEB,0xE8,0xDB,0xF6,0xF4,0x8B,0xBD,0xDB,0x70,0x1E,0xBB,0x4D,0xE6,
    0x33,0x30,0x7E,0xC8,0x29,0x19,0xDF,0xDE
};

//3.35	PVR_S0_KL-2TDES_L2_TS-2TDES_ECB
static HI_U8 PVR_S0_KL_2TDES_L2_TS_2TDES_ECB_CPSKp[]  = {0x82,0xE2,0xE6,0x62,0xF7,0x28,0xB4,0xFA,0x42,0x48,0x5E,0x3A,0x0A,0x5D,0x2F,0x34};
static HI_U8 PVR_S0_KL_2TDES_L2_TS_2TDES_ECB_CEK_p[]  = {0x30,0x08,0x56,0xFC,0x9B,0x78,0x3A,0x60,0x0C,0x76,0x53,0x11,0xB2,0x6B,0x2D,0x2A};
static HI_U8 PVR_S0_KL_2TDES_L2_TS_2TDES_ECB_Encrypted_payload[] = {
    0xA7,0x98,0x53,0xD7,0x77,0x7E,0x85,0x3D,0x98,0x62,0x27,0x72,0x94,0x96,0x8C,0x4A,
    0x04,0x6D,0x66,0x19,0xC6,0x6F,0x8B,0x4C,0xE1,0xB8,0x84,0x74,0x25,0xAB,0xE2,0x73,
    0x32,0x26,0x2F,0xD5,0xF8,0xEE,0x6E,0x03,0x04,0x47,0x35,0xC1,0x72,0x69,0x63,0x84,
    0xDE,0xEA,0xAB,0xF2,0x73,0x34,0x53,0x09,0xE9,0x44,0xA5,0x49,0xCF,0x1C,0x81,0xC7,
    0x70,0x92,0xD7,0x4F,0xC2,0xD9,0x6F,0x2E,0x02,0x5C,0xCC,0xB5,0xDD,0x49,0xC0,0x0E,
    0xA2,0x18,0xA8,0xEA,0xE2,0x11,0x52,0x76,0xBE,0x53,0x4C,0xBA,0x5D,0xB2,0x03,0x19,
    0x46,0xFA,0xCD,0x67,0x2E,0x68,0x69,0x36,0xF2,0xEE,0x99,0x3B,0x2C,0x6C,0x27,0xFF,
    0xF3,0xCA,0x74,0xAA,0x46,0x9E,0xA3,0x04,0x58,0x64,0x44,0xBC,0x71,0x2F,0x2D,0x6D,
    0x05,0xB9,0x16,0xD0,0x34,0xE1,0xFF,0x3E,0xAB,0xF4,0x3B,0xC3,0xB0,0x50,0x28,0x0D,
    0xA4,0x66,0xED,0x92,0x20,0x36,0xB8,0x38,0x4C,0x64,0x8C,0x67,0x34,0xE2,0x81,0x3C,
    0xB4,0x4B,0xB5,0x1A,0x34,0x37,0x4C,0x86,0x1D,0x88,0x2E,0xB4,0xA3,0x6B,0xA7,0xE4,
    0x3E,0xA7,0x7A,0x38,0x9E,0x4A,0xEF,0x30
};

//3.36	PVR_S0_KL-2TDES_L2_TS-AES_CBC
static HI_U8 PVR_S0_KL_2TDES_L2_TS_AES_CBC_CPSKp[]  = {0x82,0xE2,0xE6,0x62,0xF7,0x28,0xB4,0xFA,0x42,0x48,0x5E,0x3A,0x0A,0x5D,0x2F,0x34};
static HI_U8 PVR_S0_KL_2TDES_L2_TS_AES_CBC_CEK_p[]  = {0x30,0x08,0x56,0xFC,0x9B,0x78,0x3A,0x60,0x0C,0x76,0x53,0x11,0xB2,0x6B,0x2D,0x2A};
static HI_U8 PVR_S0_KL_2TDES_L2_TS_AES_CBC_Encrypted_payload[] = {
    0x3A,0xFC,0x36,0x8D,0x00,0x40,0x06,0xC0,0xE4,0xA6,0x6E,0x83,0x77,0x82,0x2C,0xD0,
    0x60,0xB3,0xC8,0xB7,0xA9,0x0F,0xB2,0x32,0x62,0x4D,0x1E,0x36,0x9C,0x9A,0x68,0x2B,
    0x6C,0xCD,0x88,0xB0,0x8A,0x24,0x0A,0xC9,0xCC,0xB8,0x09,0x1C,0xCB,0xB5,0xAB,0xD3,
    0xB3,0x15,0x2F,0x76,0xE7,0xA1,0xC9,0x7B,0xBE,0x29,0x6E,0xF1,0xF5,0x98,0x4F,0x1C,
    0x94,0x4A,0x93,0xC7,0x25,0xE8,0xB9,0xD5,0x29,0x76,0xC8,0x66,0xBF,0xD6,0x82,0xFD,
    0x97,0xEA,0xB0,0x7C,0x10,0x00,0x06,0x19,0x5F,0x44,0xCD,0x60,0xAD,0xFF,0x99,0xC9,
    0x67,0x8E,0x81,0x75,0x86,0xE4,0x70,0x26,0xAD,0xE5,0x95,0x34,0x6A,0x57,0xD0,0x52,
    0xC9,0xE5,0x7B,0x4D,0xC4,0xFF,0x2D,0xFE,0xCC,0x2B,0x7B,0x41,0x9E,0x5E,0x85,0xC8,
    0x4C,0x5D,0xDF,0xE5,0xD7,0xB4,0xB5,0xD2,0x21,0x20,0x4E,0x51,0x76,0x78,0x4D,0x75,
    0xC4,0xF2,0x5C,0xA1,0x3D,0x33,0x6F,0xAD,0xE5,0x3D,0xF6,0xDE,0xCF,0x8F,0x1F,0xC8,
    0xA7,0x82,0xF8,0x55,0x3D,0x4A,0x20,0xE2,0xA1,0x68,0x82,0xC0,0x3D,0xD6,0x8C,0x1A,
    0x07,0x06,0x05,0x04,0x03,0x02,0x01,0x00
};

//3.37	PVR_S0_KL-2TDES_L2_TS-AES_ECB
static HI_U8 PVR_S0_KL_2TDES_L2_TS_AES_ECB_CPSKp[]  = {0x82,0xE2,0xE6,0x62,0xF7,0x28,0xB4,0xFA,0x42,0x48,0x5E,0x3A,0x0A,0x5D,0x2F,0x34};
static HI_U8 PVR_S0_KL_2TDES_L2_TS_AES_ECB_CEK_p[]  = {0x30,0x08,0x56,0xFC,0x9B,0x78,0x3A,0x60,0x0C,0x76,0x53,0x11,0xB2,0x6B,0x2D,0x2A};
static HI_U8 PVR_S0_KL_2TDES_L2_TS_AES_ECB_Encrypted_payload[] = {
    0x3A,0xFC,0x36,0x8D,0x00,0x40,0x06,0xC0,0xE4,0xA6,0x6E,0x83,0x77,0x82,0x2C,0xD0,
    0x88,0xB3,0x92,0x5D,0xF1,0xBC,0xD9,0xD6,0x8A,0xA2,0x15,0x24,0x64,0x53,0xB1,0x35,
    0x1D,0xF3,0xCA,0xED,0xA4,0x1C,0xCD,0x16,0xD1,0xB8,0xE8,0x8B,0x4D,0x2B,0xEE,0x29,
    0x98,0x3C,0x92,0xEA,0x35,0xEE,0x2E,0x3F,0x4D,0x0F,0x09,0x04,0x54,0x86,0xFF,0x73,
    0x37,0xFC,0xD4,0x2E,0x98,0x7C,0x99,0xC0,0x65,0x50,0x18,0x0A,0xCB,0x62,0xBC,0x29,
    0x4B,0x3D,0xC0,0xBF,0xE9,0x83,0xBE,0x16,0xF5,0xD0,0xC3,0x8A,0x90,0x53,0xDC,0x06,
    0xD2,0x38,0xA1,0x8D,0x0F,0x71,0xAA,0x8C,0x5D,0xEE,0xD0,0xBC,0x84,0x53,0x33,0x8D,
    0xF1,0x09,0xCA,0xB8,0x56,0x4A,0x5E,0x1A,0x43,0x89,0xAB,0x2B,0x72,0xFE,0xEF,0x54,
    0xB6,0x75,0x82,0xC2,0xC5,0x5F,0xC1,0xC5,0xEE,0x93,0xB7,0xAF,0xE1,0x9E,0x71,0xE7,
    0x66,0x9E,0xEE,0x12,0x73,0x4B,0xBD,0x31,0x1D,0xB7,0xF4,0x85,0x81,0xE9,0xB9,0xB6,
    0x00,0x66,0xED,0xEB,0x4A,0xAE,0xDC,0xD0,0x9A,0x95,0x4A,0x06,0x05,0x80,0x01,0xCE,
    0x07,0x06,0x05,0x04,0x03,0x02,0x01,0x00
};

//3.38	PVR_S0_KL-2TDES_L3_TS-2TDES_CBC
static HI_U8 PVR_S0_KL_2TDES_L3_TS_2TDES_CBC_CPAKp[] = {0x82,0xE2,0xE6,0x62,0xF7,0x28,0xB4,0xFA,0x42,0x48,0x5E,0x3A,0x0A,0x5D,0x2F,0x34};
static HI_U8 PVR_S0_KL_2TDES_L3_TS_2TDES_CBC_CPSKp[] = {0xD4,0x71,0x3D,0x60,0xC8,0xA7,0x06,0x39,0xEB,0x11,0x67,0xB3,0x67,0xA9,0xC3,0x78};
static HI_U8 PVR_S0_KL_2TDES_L3_TS_2TDES_CBC_CEK_p[] = {0x61,0x9F,0xAB,0x64,0x83,0xEE,0x4B,0xAA,0x48,0x11,0x20,0x4B,0x37,0x9C,0xAC,0x9D};
static HI_U8 PVR_S0_KL_2TDES_L3_TS_2TDES_CBC_Encrypted_payload[] = {
    0xA7,0x98,0x53,0xD7,0x77,0x7E,0x85,0x3D,0xEC,0x8C,0x6B,0xC4,0xB3,0x5D,0xB7,0xAF,
    0xC8,0x24,0x61,0xC3,0xB7,0xB1,0x00,0x2D,0xB5,0x19,0xE1,0x10,0x88,0x36,0x0E,0xA4,
    0x71,0x07,0xA8,0xEC,0xF1,0xBA,0xBB,0xBA,0x8E,0x25,0xB8,0x26,0x46,0x57,0x82,0xD1,
    0x08,0xBA,0xD3,0xF0,0xB6,0x4F,0x94,0xCF,0x95,0xBE,0x26,0x55,0xF6,0x82,0xFE,0x31,
    0x87,0x1C,0x1A,0x40,0x98,0x9C,0xFF,0x7A,0xD8,0x30,0x6E,0xCE,0xE2,0x22,0xFF,0x54,
    0x69,0x14,0x8E,0xEE,0x45,0x45,0xAC,0xC7,0xB0,0x99,0xA5,0x47,0x8E,0x2B,0xEC,0x24,
    0xB0,0x3C,0xE3,0xB7,0xBA,0x4E,0xB2,0x99,0xEA,0xCD,0x82,0x67,0xB5,0xDF,0x93,0x7F,
    0x10,0x93,0x0A,0x55,0x5D,0xDB,0xDA,0x1E,0x21,0x52,0x57,0xEE,0xF5,0xD6,0x19,0xEB,
    0x90,0x08,0x84,0x55,0x1E,0x4C,0xC3,0xCE,0x82,0x0F,0xCB,0xB7,0xF5,0xD4,0xD5,0x39,
    0xB9,0x56,0xEC,0x8F,0x9B,0xBE,0x99,0x57,0x35,0x19,0xCF,0x5B,0x7B,0x7A,0x98,0x98,
    0xD0,0xB9,0x06,0xEB,0xE8,0xDB,0xF6,0xF4,0x8B,0xBD,0xDB,0x70,0x1E,0xBB,0x4D,0xE6,
    0x33,0x30,0x7E,0xC8,0x29,0x19,0xDF,0xDE
};

//3.39	PVR_S0_KL-2TDES_L3_TS-2TDES_ECB
static HI_U8 PVR_S0_KL_2TDES_L3_TS_2TDES_ECB_CPAKp[] = {0x82,0xE2,0xE6,0x62,0xF7,0x28,0xB4,0xFA,0x42,0x48,0x5E,0x3A,0x0A,0x5D,0x2F,0x34};
static HI_U8 PVR_S0_KL_2TDES_L3_TS_2TDES_ECB_CPSKp[] = {0xD4,0x71,0x3D,0x60,0xC8,0xA7,0x06,0x39,0xEB,0x11,0x67,0xB3,0x67,0xA9,0xC3,0x78};
static HI_U8 PVR_S0_KL_2TDES_L3_TS_2TDES_ECB_CEK_p[] = {0x61,0x9F,0xAB,0x64,0x83,0xEE,0x4B,0xAA,0x48,0x11,0x20,0x4B,0x37,0x9C,0xAC,0x9D};
static HI_U8 PVR_S0_KL_2TDES_L3_TS_2TDES_ECB_Encrypted_payload[] = {
    0xA7,0x98,0x53,0xD7,0x77,0x7E,0x85,0x3D,0x98,0x62,0x27,0x72,0x94,0x96,0x8C,0x4A,
    0x04,0x6D,0x66,0x19,0xC6,0x6F,0x8B,0x4C,0xE1,0xB8,0x84,0x74,0x25,0xAB,0xE2,0x73,
    0x32,0x26,0x2F,0xD5,0xF8,0xEE,0x6E,0x03,0x04,0x47,0x35,0xC1,0x72,0x69,0x63,0x84,
    0xDE,0xEA,0xAB,0xF2,0x73,0x34,0x53,0x09,0xE9,0x44,0xA5,0x49,0xCF,0x1C,0x81,0xC7,
    0x70,0x92,0xD7,0x4F,0xC2,0xD9,0x6F,0x2E,0x02,0x5C,0xCC,0xB5,0xDD,0x49,0xC0,0x0E,
    0xA2,0x18,0xA8,0xEA,0xE2,0x11,0x52,0x76,0xBE,0x53,0x4C,0xBA,0x5D,0xB2,0x03,0x19,
    0x46,0xFA,0xCD,0x67,0x2E,0x68,0x69,0x36,0xF2,0xEE,0x99,0x3B,0x2C,0x6C,0x27,0xFF,
    0xF3,0xCA,0x74,0xAA,0x46,0x9E,0xA3,0x04,0x58,0x64,0x44,0xBC,0x71,0x2F,0x2D,0x6D,
    0x05,0xB9,0x16,0xD0,0x34,0xE1,0xFF,0x3E,0xAB,0xF4,0x3B,0xC3,0xB0,0x50,0x28,0x0D,
    0xA4,0x66,0xED,0x92,0x20,0x36,0xB8,0x38,0x4C,0x64,0x8C,0x67,0x34,0xE2,0x81,0x3C,
    0xB4,0x4B,0xB5,0x1A,0x34,0x37,0x4C,0x86,0x1D,0x88,0x2E,0xB4,0xA3,0x6B,0xA7,0xE4,
    0x3E,0xA7,0x7A,0x38,0x9E,0x4A,0xEF,0x30
};

//3.40	PVR_S0_KL-2TDES_L3_TS-AES_CBC
static HI_U8 PVR_S0_KL_2TDES_L3_TS_AES_CBC_CPAKp[] = {0x82,0xE2,0xE6,0x62,0xF7,0x28,0xB4,0xFA,0x42,0x48,0x5E,0x3A,0x0A,0x5D,0x2F,0x34};
static HI_U8 PVR_S0_KL_2TDES_L3_TS_AES_CBC_CPSKp[] = {0xD4,0x71,0x3D,0x60,0xC8,0xA7,0x06,0x39,0xEB,0x11,0x67,0xB3,0x67,0xA9,0xC3,0x78};
static HI_U8 PVR_S0_KL_2TDES_L3_TS_AES_CBC_CEK_p[] = {0x61,0x9F,0xAB,0x64,0x83,0xEE,0x4B,0xAA,0x48,0x11,0x20,0x4B,0x37,0x9C,0xAC,0x9D};
static HI_U8 PVR_S0_KL_2TDES_L3_TS_AES_CBC_Encrypted_payload[] = {
    0x3A,0xFC,0x36,0x8D,0x00,0x40,0x06,0xC0,0xE4,0xA6,0x6E,0x83,0x77,0x82,0x2C,0xD0,
    0x60,0xB3,0xC8,0xB7,0xA9,0x0F,0xB2,0x32,0x62,0x4D,0x1E,0x36,0x9C,0x9A,0x68,0x2B,
    0x6C,0xCD,0x88,0xB0,0x8A,0x24,0x0A,0xC9,0xCC,0xB8,0x09,0x1C,0xCB,0xB5,0xAB,0xD3,
    0xB3,0x15,0x2F,0x76,0xE7,0xA1,0xC9,0x7B,0xBE,0x29,0x6E,0xF1,0xF5,0x98,0x4F,0x1C,
    0x94,0x4A,0x93,0xC7,0x25,0xE8,0xB9,0xD5,0x29,0x76,0xC8,0x66,0xBF,0xD6,0x82,0xFD,
    0x97,0xEA,0xB0,0x7C,0x10,0x00,0x06,0x19,0x5F,0x44,0xCD,0x60,0xAD,0xFF,0x99,0xC9,
    0x67,0x8E,0x81,0x75,0x86,0xE4,0x70,0x26,0xAD,0xE5,0x95,0x34,0x6A,0x57,0xD0,0x52,
    0xC9,0xE5,0x7B,0x4D,0xC4,0xFF,0x2D,0xFE,0xCC,0x2B,0x7B,0x41,0x9E,0x5E,0x85,0xC8,
    0x4C,0x5D,0xDF,0xE5,0xD7,0xB4,0xB5,0xD2,0x21,0x20,0x4E,0x51,0x76,0x78,0x4D,0x75,
    0xC4,0xF2,0x5C,0xA1,0x3D,0x33,0x6F,0xAD,0xE5,0x3D,0xF6,0xDE,0xCF,0x8F,0x1F,0xC8,
    0xA7,0x82,0xF8,0x55,0x3D,0x4A,0x20,0xE2,0xA1,0x68,0x82,0xC0,0x3D,0xD6,0x8C,0x1A,
    0x07,0x06,0x05,0x04,0x03,0x02,0x01,0x00
};

//3.41	PVR_S0_KL-2TDES_L3_TS-AES_ECB
static HI_U8 PVR_S0_KL_2TDES_L3_TS_AES_ECB_CPAKp[] = {0x82,0xE2,0xE6,0x62,0xF7,0x28,0xB4,0xFA,0x42,0x48,0x5E,0x3A,0x0A,0x5D,0x2F,0x34};
static HI_U8 PVR_S0_KL_2TDES_L3_TS_AES_ECB_CPSKp[] = {0xD4,0x71,0x3D,0x60,0xC8,0xA7,0x06,0x39,0xEB,0x11,0x67,0xB3,0x67,0xA9,0xC3,0x78};
static HI_U8 PVR_S0_KL_2TDES_L3_TS_AES_ECB_CEK_p[] = {0x61,0x9F,0xAB,0x64,0x83,0xEE,0x4B,0xAA,0x48,0x11,0x20,0x4B,0x37,0x9C,0xAC,0x9D};
static HI_U8 PVR_S0_KL_2TDES_L3_TS_AES_ECB_Encrypted_payload[] = {
    0x3A,0xFC,0x36,0x8D,0x00,0x40,0x06,0xC0,0xE4,0xA6,0x6E,0x83,0x77,0x82,0x2C,0xD0,
    0x88,0xB3,0x92,0x5D,0xF1,0xBC,0xD9,0xD6,0x8A,0xA2,0x15,0x24,0x64,0x53,0xB1,0x35,
    0x1D,0xF3,0xCA,0xED,0xA4,0x1C,0xCD,0x16,0xD1,0xB8,0xE8,0x8B,0x4D,0x2B,0xEE,0x29,
    0x98,0x3C,0x92,0xEA,0x35,0xEE,0x2E,0x3F,0x4D,0x0F,0x09,0x04,0x54,0x86,0xFF,0x73,
    0x37,0xFC,0xD4,0x2E,0x98,0x7C,0x99,0xC0,0x65,0x50,0x18,0x0A,0xCB,0x62,0xBC,0x29,
    0x4B,0x3D,0xC0,0xBF,0xE9,0x83,0xBE,0x16,0xF5,0xD0,0xC3,0x8A,0x90,0x53,0xDC,0x06,
    0xD2,0x38,0xA1,0x8D,0x0F,0x71,0xAA,0x8C,0x5D,0xEE,0xD0,0xBC,0x84,0x53,0x33,0x8D,
    0xF1,0x09,0xCA,0xB8,0x56,0x4A,0x5E,0x1A,0x43,0x89,0xAB,0x2B,0x72,0xFE,0xEF,0x54,
    0xB6,0x75,0x82,0xC2,0xC5,0x5F,0xC1,0xC5,0xEE,0x93,0xB7,0xAF,0xE1,0x9E,0x71,0xE7,
    0x66,0x9E,0xEE,0x12,0x73,0x4B,0xBD,0x31,0x1D,0xB7,0xF4,0x85,0x81,0xE9,0xB9,0xB6,
    0x00,0x66,0xED,0xEB,0x4A,0xAE,0xDC,0xD0,0x9A,0x95,0x4A,0x06,0x05,0x80,0x01,0xCE,
    0x07,0x06,0x05,0x04,0x03,0x02,0x01,0x00
};

//3.42	PVR_S0_KL-AES_L2_TS-2TDES_CBC
static HI_U8 PVR_S0_KL_AES_L2_TS_2TDES_CBC_CPSKp[]  = {0x82,0xE2,0xE6,0x62,0xF7,0x28,0xB4,0xFA,0x42,0x48,0x5E,0x3A,0x0A,0x5D,0x2F,0x34};
static HI_U8 PVR_S0_KL_AES_L2_TS_2TDES_CBC_CEK_p[]  = {0x4A,0x0C,0xE1,0x27,0x54,0x07,0x53,0x73,0x52,0xEB,0x6B,0x27,0xB4,0xCE,0x55,0x65};
static HI_U8 PVR_S0_KL_AES_L2_TS_2TDES_CBC_Encrypted_payload[] = {
    0xA7,0x98,0x53,0xD7,0x77,0x7E,0x85,0x3D,0xEC,0x8C,0x6B,0xC4,0xB3,0x5D,0xB7,0xAF,
    0xC8,0x24,0x61,0xC3,0xB7,0xB1,0x00,0x2D,0xB5,0x19,0xE1,0x10,0x88,0x36,0x0E,0xA4,
    0x71,0x07,0xA8,0xEC,0xF1,0xBA,0xBB,0xBA,0x8E,0x25,0xB8,0x26,0x46,0x57,0x82,0xD1,
    0x08,0xBA,0xD3,0xF0,0xB6,0x4F,0x94,0xCF,0x95,0xBE,0x26,0x55,0xF6,0x82,0xFE,0x31,
    0x87,0x1C,0x1A,0x40,0x98,0x9C,0xFF,0x7A,0xD8,0x30,0x6E,0xCE,0xE2,0x22,0xFF,0x54,
    0x69,0x14,0x8E,0xEE,0x45,0x45,0xAC,0xC7,0xB0,0x99,0xA5,0x47,0x8E,0x2B,0xEC,0x24,
    0xB0,0x3C,0xE3,0xB7,0xBA,0x4E,0xB2,0x99,0xEA,0xCD,0x82,0x67,0xB5,0xDF,0x93,0x7F,
    0x10,0x93,0x0A,0x55,0x5D,0xDB,0xDA,0x1E,0x21,0x52,0x57,0xEE,0xF5,0xD6,0x19,0xEB,
    0x90,0x08,0x84,0x55,0x1E,0x4C,0xC3,0xCE,0x82,0x0F,0xCB,0xB7,0xF5,0xD4,0xD5,0x39,
    0xB9,0x56,0xEC,0x8F,0x9B,0xBE,0x99,0x57,0x35,0x19,0xCF,0x5B,0x7B,0x7A,0x98,0x98,
    0xD0,0xB9,0x06,0xEB,0xE8,0xDB,0xF6,0xF4,0x8B,0xBD,0xDB,0x70,0x1E,0xBB,0x4D,0xE6,
    0x33,0x30,0x7E,0xC8,0x29,0x19,0xDF,0xDE
};

//3.43	PVR_S0_KL-AES_L2_TS-2TDES_ECB
static HI_U8 PVR_S0_KL_AES_L2_TS_2TDES_ECB_CPSKp[]  = {0x82,0xE2,0xE6,0x62,0xF7,0x28,0xB4,0xFA,0x42,0x48,0x5E,0x3A,0x0A,0x5D,0x2F,0x34};
static HI_U8 PVR_S0_KL_AES_L2_TS_2TDES_ECB_CEK_p[]  = {0x4A,0x0C,0xE1,0x27,0x54,0x07,0x53,0x73,0x52,0xEB,0x6B,0x27,0xB4,0xCE,0x55,0x65};
static HI_U8 PVR_S0_KL_AES_L2_TS_2TDES_ECB_Encrypted_payload[] = {
    0xA7,0x98,0x53,0xD7,0x77,0x7E,0x85,0x3D,0x98,0x62,0x27,0x72,0x94,0x96,0x8C,0x4A,
    0x04,0x6D,0x66,0x19,0xC6,0x6F,0x8B,0x4C,0xE1,0xB8,0x84,0x74,0x25,0xAB,0xE2,0x73,
    0x32,0x26,0x2F,0xD5,0xF8,0xEE,0x6E,0x03,0x04,0x47,0x35,0xC1,0x72,0x69,0x63,0x84,
    0xDE,0xEA,0xAB,0xF2,0x73,0x34,0x53,0x09,0xE9,0x44,0xA5,0x49,0xCF,0x1C,0x81,0xC7,
    0x70,0x92,0xD7,0x4F,0xC2,0xD9,0x6F,0x2E,0x02,0x5C,0xCC,0xB5,0xDD,0x49,0xC0,0x0E,
    0xA2,0x18,0xA8,0xEA,0xE2,0x11,0x52,0x76,0xBE,0x53,0x4C,0xBA,0x5D,0xB2,0x03,0x19,
    0x46,0xFA,0xCD,0x67,0x2E,0x68,0x69,0x36,0xF2,0xEE,0x99,0x3B,0x2C,0x6C,0x27,0xFF,
    0xF3,0xCA,0x74,0xAA,0x46,0x9E,0xA3,0x04,0x58,0x64,0x44,0xBC,0x71,0x2F,0x2D,0x6D,
    0x05,0xB9,0x16,0xD0,0x34,0xE1,0xFF,0x3E,0xAB,0xF4,0x3B,0xC3,0xB0,0x50,0x28,0x0D,
    0xA4,0x66,0xED,0x92,0x20,0x36,0xB8,0x38,0x4C,0x64,0x8C,0x67,0x34,0xE2,0x81,0x3C,
    0xB4,0x4B,0xB5,0x1A,0x34,0x37,0x4C,0x86,0x1D,0x88,0x2E,0xB4,0xA3,0x6B,0xA7,0xE4,
    0x3E,0xA7,0x7A,0x38,0x9E,0x4A,0xEF,0x30
};

//3.44	PVR_S0_KL-AES_L2_TS-AES_CBC
static HI_U8 PVR_S0_KL_AES_L2_TS_AES_CBC_CPSKp[]  = {0x82,0xE2,0xE6,0x62,0xF7,0x28,0xB4,0xFA,0x42,0x48,0x5E,0x3A,0x0A,0x5D,0x2F,0x34};
static HI_U8 PVR_S0_KL_AES_L2_TS_AES_CBC_CEK_p[]  = {0x4A,0x0C,0xE1,0x27,0x54,0x07,0x53,0x73,0x52,0xEB,0x6B,0x27,0xB4,0xCE,0x55,0x65};
static HI_U8 PVR_S0_KL_AES_L2_TS_AES_CBC_Encrypted_payload[] = {
    0x3A,0xFC,0x36,0x8D,0x00,0x40,0x06,0xC0,0xE4,0xA6,0x6E,0x83,0x77,0x82,0x2C,0xD0,
    0x60,0xB3,0xC8,0xB7,0xA9,0x0F,0xB2,0x32,0x62,0x4D,0x1E,0x36,0x9C,0x9A,0x68,0x2B,
    0x6C,0xCD,0x88,0xB0,0x8A,0x24,0x0A,0xC9,0xCC,0xB8,0x09,0x1C,0xCB,0xB5,0xAB,0xD3,
    0xB3,0x15,0x2F,0x76,0xE7,0xA1,0xC9,0x7B,0xBE,0x29,0x6E,0xF1,0xF5,0x98,0x4F,0x1C,
    0x94,0x4A,0x93,0xC7,0x25,0xE8,0xB9,0xD5,0x29,0x76,0xC8,0x66,0xBF,0xD6,0x82,0xFD,
    0x97,0xEA,0xB0,0x7C,0x10,0x00,0x06,0x19,0x5F,0x44,0xCD,0x60,0xAD,0xFF,0x99,0xC9,
    0x67,0x8E,0x81,0x75,0x86,0xE4,0x70,0x26,0xAD,0xE5,0x95,0x34,0x6A,0x57,0xD0,0x52,
    0xC9,0xE5,0x7B,0x4D,0xC4,0xFF,0x2D,0xFE,0xCC,0x2B,0x7B,0x41,0x9E,0x5E,0x85,0xC8,
    0x4C,0x5D,0xDF,0xE5,0xD7,0xB4,0xB5,0xD2,0x21,0x20,0x4E,0x51,0x76,0x78,0x4D,0x75,
    0xC4,0xF2,0x5C,0xA1,0x3D,0x33,0x6F,0xAD,0xE5,0x3D,0xF6,0xDE,0xCF,0x8F,0x1F,0xC8,
    0xA7,0x82,0xF8,0x55,0x3D,0x4A,0x20,0xE2,0xA1,0x68,0x82,0xC0,0x3D,0xD6,0x8C,0x1A,
    0x07,0x06,0x05,0x04,0x03,0x02,0x01,0x00
};

//3.45	PVR_S0_KL-AES_L2_TS-AES_ECB
static HI_U8 PVR_S0_KL_AES_L2_TS_AES_ECB_CPSKp[]  = {0x82,0xE2,0xE6,0x62,0xF7,0x28,0xB4,0xFA,0x42,0x48,0x5E,0x3A,0x0A,0x5D,0x2F,0x34};
static HI_U8 PVR_S0_KL_AES_L2_TS_AES_ECB_CEK_p[]  = {0x4A,0x0C,0xE1,0x27,0x54,0x07,0x53,0x73,0x52,0xEB,0x6B,0x27,0xB4,0xCE,0x55,0x65};
static HI_U8 PVR_S0_KL_AES_L2_TS_AES_ECB_Encrypted_payload[] = {
    0x3A,0xFC,0x36,0x8D,0x00,0x40,0x06,0xC0,0xE4,0xA6,0x6E,0x83,0x77,0x82,0x2C,0xD0,
    0x88,0xB3,0x92,0x5D,0xF1,0xBC,0xD9,0xD6,0x8A,0xA2,0x15,0x24,0x64,0x53,0xB1,0x35,
    0x1D,0xF3,0xCA,0xED,0xA4,0x1C,0xCD,0x16,0xD1,0xB8,0xE8,0x8B,0x4D,0x2B,0xEE,0x29,
    0x98,0x3C,0x92,0xEA,0x35,0xEE,0x2E,0x3F,0x4D,0x0F,0x09,0x04,0x54,0x86,0xFF,0x73,
    0x37,0xFC,0xD4,0x2E,0x98,0x7C,0x99,0xC0,0x65,0x50,0x18,0x0A,0xCB,0x62,0xBC,0x29,
    0x4B,0x3D,0xC0,0xBF,0xE9,0x83,0xBE,0x16,0xF5,0xD0,0xC3,0x8A,0x90,0x53,0xDC,0x06,
    0xD2,0x38,0xA1,0x8D,0x0F,0x71,0xAA,0x8C,0x5D,0xEE,0xD0,0xBC,0x84,0x53,0x33,0x8D,
    0xF1,0x09,0xCA,0xB8,0x56,0x4A,0x5E,0x1A,0x43,0x89,0xAB,0x2B,0x72,0xFE,0xEF,0x54,
    0xB6,0x75,0x82,0xC2,0xC5,0x5F,0xC1,0xC5,0xEE,0x93,0xB7,0xAF,0xE1,0x9E,0x71,0xE7,
    0x66,0x9E,0xEE,0x12,0x73,0x4B,0xBD,0x31,0x1D,0xB7,0xF4,0x85,0x81,0xE9,0xB9,0xB6,
    0x00,0x66,0xED,0xEB,0x4A,0xAE,0xDC,0xD0,0x9A,0x95,0x4A,0x06,0x05,0x80,0x01,0xCE,
    0x07,0x06,0x05,0x04,0x03,0x02,0x01,0x00
};

//3.46	PVR_S0_KL-AES_L3_TS-2TDES_CBC
static HI_U8 PVR_S0_KL_AES_L3_TS_2TDES_CBC_CPAKp[] = {0x82,0xE2,0xE6,0x62,0xF7,0x28,0xB4,0xFA,0x42,0x48,0x5E,0x3A,0x0A,0x5D,0x2F,0x34};
static HI_U8 PVR_S0_KL_AES_L3_TS_2TDES_CBC_CPSKp[] = {0xD4,0x71,0x3D,0x60,0xC8,0xA7,0x06,0x39,0xEB,0x11,0x67,0xB3,0x67,0xA9,0xC3,0x78};
static HI_U8 PVR_S0_KL_AES_L3_TS_2TDES_CBC_CEK_p[] = {0xF8,0x7D,0x86,0x70,0x0B,0xA7,0xBB,0xD0,0x20,0xD3,0x9A,0xDE,0x3B,0x8C,0x81,0x31};
static HI_U8 PVR_S0_KL_AES_L3_TS_2TDES_CBC_Encrypted_payload[] = {
    0xA7,0x98,0x53,0xD7,0x77,0x7E,0x85,0x3D,0xEC,0x8C,0x6B,0xC4,0xB3,0x5D,0xB7,0xAF,
    0xC8,0x24,0x61,0xC3,0xB7,0xB1,0x00,0x2D,0xB5,0x19,0xE1,0x10,0x88,0x36,0x0E,0xA4,
    0x71,0x07,0xA8,0xEC,0xF1,0xBA,0xBB,0xBA,0x8E,0x25,0xB8,0x26,0x46,0x57,0x82,0xD1,
    0x08,0xBA,0xD3,0xF0,0xB6,0x4F,0x94,0xCF,0x95,0xBE,0x26,0x55,0xF6,0x82,0xFE,0x31,
    0x87,0x1C,0x1A,0x40,0x98,0x9C,0xFF,0x7A,0xD8,0x30,0x6E,0xCE,0xE2,0x22,0xFF,0x54,
    0x69,0x14,0x8E,0xEE,0x45,0x45,0xAC,0xC7,0xB0,0x99,0xA5,0x47,0x8E,0x2B,0xEC,0x24,
    0xB0,0x3C,0xE3,0xB7,0xBA,0x4E,0xB2,0x99,0xEA,0xCD,0x82,0x67,0xB5,0xDF,0x93,0x7F,
    0x10,0x93,0x0A,0x55,0x5D,0xDB,0xDA,0x1E,0x21,0x52,0x57,0xEE,0xF5,0xD6,0x19,0xEB,
    0x90,0x08,0x84,0x55,0x1E,0x4C,0xC3,0xCE,0x82,0x0F,0xCB,0xB7,0xF5,0xD4,0xD5,0x39,
    0xB9,0x56,0xEC,0x8F,0x9B,0xBE,0x99,0x57,0x35,0x19,0xCF,0x5B,0x7B,0x7A,0x98,0x98,
    0xD0,0xB9,0x06,0xEB,0xE8,0xDB,0xF6,0xF4,0x8B,0xBD,0xDB,0x70,0x1E,0xBB,0x4D,0xE6,
    0x33,0x30,0x7E,0xC8,0x29,0x19,0xDF,0xDE
};

//3.47	PVR_S0_KL-AES_L3_TS-2TDES_ECB
static HI_U8 PVR_S0_KL_AES_L3_TS_2TDES_ECB_CPAKp[] = {0x82,0xE2,0xE6,0x62,0xF7,0x28,0xB4,0xFA,0x42,0x48,0x5E,0x3A,0x0A,0x5D,0x2F,0x34};
static HI_U8 PVR_S0_KL_AES_L3_TS_2TDES_ECB_CPSKp[] = {0xD4,0x71,0x3D,0x60,0xC8,0xA7,0x06,0x39,0xEB,0x11,0x67,0xB3,0x67,0xA9,0xC3,0x78};
static HI_U8 PVR_S0_KL_AES_L3_TS_2TDES_ECB_CEK_p[] = {0xF8,0x7D,0x86,0x70,0x0B,0xA7,0xBB,0xD0,0x20,0xD3,0x9A,0xDE,0x3B,0x8C,0x81,0x31};
static HI_U8 PVR_S0_KL_AES_L3_TS_2TDES_ECB_Encrypted_payload[] = {
    0xA7,0x98,0x53,0xD7,0x77,0x7E,0x85,0x3D,0x98,0x62,0x27,0x72,0x94,0x96,0x8C,0x4A,
    0x04,0x6D,0x66,0x19,0xC6,0x6F,0x8B,0x4C,0xE1,0xB8,0x84,0x74,0x25,0xAB,0xE2,0x73,
    0x32,0x26,0x2F,0xD5,0xF8,0xEE,0x6E,0x03,0x04,0x47,0x35,0xC1,0x72,0x69,0x63,0x84,
    0xDE,0xEA,0xAB,0xF2,0x73,0x34,0x53,0x09,0xE9,0x44,0xA5,0x49,0xCF,0x1C,0x81,0xC7,
    0x70,0x92,0xD7,0x4F,0xC2,0xD9,0x6F,0x2E,0x02,0x5C,0xCC,0xB5,0xDD,0x49,0xC0,0x0E,
    0xA2,0x18,0xA8,0xEA,0xE2,0x11,0x52,0x76,0xBE,0x53,0x4C,0xBA,0x5D,0xB2,0x03,0x19,
    0x46,0xFA,0xCD,0x67,0x2E,0x68,0x69,0x36,0xF2,0xEE,0x99,0x3B,0x2C,0x6C,0x27,0xFF,
    0xF3,0xCA,0x74,0xAA,0x46,0x9E,0xA3,0x04,0x58,0x64,0x44,0xBC,0x71,0x2F,0x2D,0x6D,
    0x05,0xB9,0x16,0xD0,0x34,0xE1,0xFF,0x3E,0xAB,0xF4,0x3B,0xC3,0xB0,0x50,0x28,0x0D,
    0xA4,0x66,0xED,0x92,0x20,0x36,0xB8,0x38,0x4C,0x64,0x8C,0x67,0x34,0xE2,0x81,0x3C,
    0xB4,0x4B,0xB5,0x1A,0x34,0x37,0x4C,0x86,0x1D,0x88,0x2E,0xB4,0xA3,0x6B,0xA7,0xE4,
    0x3E,0xA7,0x7A,0x38,0x9E,0x4A,0xEF,0x30
};

//3.48	PVR_S0_KL-AES_L3_TS-AES_CBC
static HI_U8 PVR_S0_KL_AES_L3_TS_AES_CBC_CPAKp[] = {0x82,0xE2,0xE6,0x62,0xF7,0x28,0xB4,0xFA,0x42,0x48,0x5E,0x3A,0x0A,0x5D,0x2F,0x34};
static HI_U8 PVR_S0_KL_AES_L3_TS_AES_CBC_CPSKp[] = {0xD4,0x71,0x3D,0x60,0xC8,0xA7,0x06,0x39,0xEB,0x11,0x67,0xB3,0x67,0xA9,0xC3,0x78};
static HI_U8 PVR_S0_KL_AES_L3_TS_AES_CBC_CEK_p[] = {0xF8,0x7D,0x86,0x70,0x0B,0xA7,0xBB,0xD0,0x20,0xD3,0x9A,0xDE,0x3B,0x8C,0x81,0x31};
static HI_U8 PVR_S0_KL_AES_L3_TS_AES_CBC_Encrypted_payload[] = {
    0x3A,0xFC,0x36,0x8D,0x00,0x40,0x06,0xC0,0xE4,0xA6,0x6E,0x83,0x77,0x82,0x2C,0xD0,
    0x60,0xB3,0xC8,0xB7,0xA9,0x0F,0xB2,0x32,0x62,0x4D,0x1E,0x36,0x9C,0x9A,0x68,0x2B,
    0x6C,0xCD,0x88,0xB0,0x8A,0x24,0x0A,0xC9,0xCC,0xB8,0x09,0x1C,0xCB,0xB5,0xAB,0xD3,
    0xB3,0x15,0x2F,0x76,0xE7,0xA1,0xC9,0x7B,0xBE,0x29,0x6E,0xF1,0xF5,0x98,0x4F,0x1C,
    0x94,0x4A,0x93,0xC7,0x25,0xE8,0xB9,0xD5,0x29,0x76,0xC8,0x66,0xBF,0xD6,0x82,0xFD,
    0x97,0xEA,0xB0,0x7C,0x10,0x00,0x06,0x19,0x5F,0x44,0xCD,0x60,0xAD,0xFF,0x99,0xC9,
    0x67,0x8E,0x81,0x75,0x86,0xE4,0x70,0x26,0xAD,0xE5,0x95,0x34,0x6A,0x57,0xD0,0x52,
    0xC9,0xE5,0x7B,0x4D,0xC4,0xFF,0x2D,0xFE,0xCC,0x2B,0x7B,0x41,0x9E,0x5E,0x85,0xC8,
    0x4C,0x5D,0xDF,0xE5,0xD7,0xB4,0xB5,0xD2,0x21,0x20,0x4E,0x51,0x76,0x78,0x4D,0x75,
    0xC4,0xF2,0x5C,0xA1,0x3D,0x33,0x6F,0xAD,0xE5,0x3D,0xF6,0xDE,0xCF,0x8F,0x1F,0xC8,
    0xA7,0x82,0xF8,0x55,0x3D,0x4A,0x20,0xE2,0xA1,0x68,0x82,0xC0,0x3D,0xD6,0x8C,0x1A,
    0x07,0x06,0x05,0x04,0x03,0x02,0x01,0x00
};

//3.49	PVR_S0_KL-AES_L3_TS-AES_ECB
static HI_U8 PVR_S0_KL_AES_L3_TS_AES_ECB_CPAKp[] = {0x82,0xE2,0xE6,0x62,0xF7,0x28,0xB4,0xFA,0x42,0x48,0x5E,0x3A,0x0A,0x5D,0x2F,0x34};
static HI_U8 PVR_S0_KL_AES_L3_TS_AES_ECB_CPSKp[] = {0xD4,0x71,0x3D,0x60,0xC8,0xA7,0x06,0x39,0xEB,0x11,0x67,0xB3,0x67,0xA9,0xC3,0x78};
static HI_U8 PVR_S0_KL_AES_L3_TS_AES_ECB_CEK_p[] = {0xF8,0x7D,0x86,0x70,0x0B,0xA7,0xBB,0xD0,0x20,0xD3,0x9A,0xDE,0x3B,0x8C,0x81,0x31};
static HI_U8 PVR_S0_KL_AES_L3_TS_AES_ECB_Encrypted_payload[] = {
    0x3A,0xFC,0x36,0x8D,0x00,0x40,0x06,0xC0,0xE4,0xA6,0x6E,0x83,0x77,0x82,0x2C,0xD0,
    0x88,0xB3,0x92,0x5D,0xF1,0xBC,0xD9,0xD6,0x8A,0xA2,0x15,0x24,0x64,0x53,0xB1,0x35,
    0x1D,0xF3,0xCA,0xED,0xA4,0x1C,0xCD,0x16,0xD1,0xB8,0xE8,0x8B,0x4D,0x2B,0xEE,0x29,
    0x98,0x3C,0x92,0xEA,0x35,0xEE,0x2E,0x3F,0x4D,0x0F,0x09,0x04,0x54,0x86,0xFF,0x73,
    0x37,0xFC,0xD4,0x2E,0x98,0x7C,0x99,0xC0,0x65,0x50,0x18,0x0A,0xCB,0x62,0xBC,0x29,
    0x4B,0x3D,0xC0,0xBF,0xE9,0x83,0xBE,0x16,0xF5,0xD0,0xC3,0x8A,0x90,0x53,0xDC,0x06,
    0xD2,0x38,0xA1,0x8D,0x0F,0x71,0xAA,0x8C,0x5D,0xEE,0xD0,0xBC,0x84,0x53,0x33,0x8D,
    0xF1,0x09,0xCA,0xB8,0x56,0x4A,0x5E,0x1A,0x43,0x89,0xAB,0x2B,0x72,0xFE,0xEF,0x54,
    0xB6,0x75,0x82,0xC2,0xC5,0x5F,0xC1,0xC5,0xEE,0x93,0xB7,0xAF,0xE1,0x9E,0x71,0xE7,
    0x66,0x9E,0xEE,0x12,0x73,0x4B,0xBD,0x31,0x1D,0xB7,0xF4,0x85,0x81,0xE9,0xB9,0xB6,
    0x00,0x66,0xED,0xEB,0x4A,0xAE,0xDC,0xD0,0x9A,0x95,0x4A,0x06,0x05,0x80,0x01,0xCE,
    0x07,0x06,0x05,0x04,0x03,0x02,0x01,0x00
};


//3.51	AES CBC-MAC HIGH-LEVEL CODE AUTHENTICATION
static HI_U8 HIGH_LEVEL_CODE[] = {
    0xcc, 0x45, 0x78, 0x21, 0x98, 0xa6, 0x41, 0x6d, 0x17, 0x75, 0x33, 0x6d, 0x71, 0xea, 0xcd, 0x05, 
    0x49, 0xa3, 0xe8, 0x0e, 0x96, 0x6e, 0x12, 0x77, 0x8c, 0x17, 0x45, 0xa7, 0x9a, 0x6a, 0x5f, 0x92, 
    0xcc, 0xa7, 0x41, 0x47, 0xf6, 0xbe, 0x1f, 0x72, 0x34, 0x05, 0x09, 0x5c, 0x8a, 0x50, 0x06, 0xc1, 
    0xec, 0x18, 0x8e, 0xfb, 0xd0, 0x80, 0xe6, 0x6e, 0x55, 0x2f, 0x23, 0x3a, 0x8c, 0x25, 0x16, 0x6a, 
    0x1f, 0xf3, 0x98, 0x49, 0xb4, 0xe1, 0x35, 0x7d, 0x4a, 0x84, 0xeb, 0x03, 0x8d, 0x1f, 0xd9, 0xb7, 
    0x4d, 0x2b, 0x9d, 0xeb, 0x1b, 0xeb, 0x37, 0x11, 0x7d, 0x41, 0xe6, 0x02, 0xee, 0xce, 0x32, 0x8b, 
    0xff, 0x7b, 0x11, 0x8e, 0x82, 0x08, 0x65, 0xd6, 0xe0, 0x05, 0xb8, 0x60, 0x51, 0xef, 0x19, 0x22, 
    0xfe, 0x43, 0xc4, 0x9e, 0x14, 0x98, 0x18, 0xd1, 0x17, 0x59, 0xed, 0xc3, 0x72, 0xae, 0x22, 0x44, 
    0x8b, 0x01, 0x63, 0xc1, 0xcd, 0x9d, 0x2b, 0x7d, 0x24, 0x7a, 0x83, 0x33, 0xf7, 0xb0, 0xb7, 0xd2, 
    0xcd, 0xa8, 0x05, 0x6c, 0x3d, 0x15, 0xee, 0xf7, 0x38, 0xc1, 0x96, 0x2e, 0x91, 0x48, 0x62, 0x4f, 
    0xea, 0xc1, 0xc1, 0x4f, 0x30, 0xe9, 0xc5, 0xcc, 0x10, 0x1f, 0xbc, 0xcc, 0xde, 0xd7, 0x33, 0xe8, 
    0xb4, 0x21, 0xea, 0xeb, 0x53, 0x40, 0x97, 0xca, 0xba, 0xf3, 0x89, 0x7a, 0x3e, 0x70, 0xf1, 0x6a, 
    0x55, 0x48, 0x58, 0x22, 0xde, 0x1b, 0x37, 0x2a, 0xd3, 0xfb, 0xf4, 0x7a, 0x7e, 0x5b, 0x1e, 0x7f, 
    0x9c, 0xa5, 0x49, 0x9d, 0x00, 0x4a, 0xe5, 0x45, 0xa0, 0x11, 0x6b, 0xe5, 0xab, 0x0c, 0x16, 0x81, 
    0xc8, 0xf8, 0xe3, 0xd0, 0xd3, 0x29, 0x0a, 0x4c, 0xb5, 0xd3, 0x2b, 0x16, 0x66, 0x19, 0x4c, 0xb1, 
    0xd7, 0x10, 0x37, 0xd1, 0xb8, 0x3e, 0x90, 0xec, 0x17, 0xe0, 0xaa, 0x3c, 0x03, 0x98, 0x3c, 0xa8, 
};
static HI_U8 CBC_MAC[] = {0x58, 0x3C, 0x2F, 0x81, 0x74, 0xC0, 0xB2, 0x18, 0xC3, 0x2F, 0x90, 0x58, 0xEA, 0x92, 0x19, 0x1B};

static HI_VOID *PlayTsTthread(HI_VOID *args);
static HI_VOID *RecTsTthread(HI_VOID *args);
static HI_S32 AVPLAY_TS(HI_ADVCA_IRDETO_MSR2_2_CASE_ID enCaseID);
static HI_S32 AVPLAY_AttachDescramble(HI_HANDLE hAvplay,HI_HANDLE *phKey);
static HI_S32 AVPLAY_DetachDescramble(HI_HANDLE hAvplay,HI_HANDLE hKey);
static HI_S32 AVPLAY_SetCW(HI_HANDLE hKey);
static HI_S32 CBC_MAC_Test();
static HI_S32 PVR_Test(HI_ADVCA_IRDETO_MSR2_2_CASE_ID enCaseID);
static HI_S32 CW_Test(HI_ADVCA_IRDETO_MSR2_2_CASE_ID enCaseID);
static HI_S32 Chip_Confiuration_Check();


static HI_S32 DmxInit(HI_VOID)
{
    HI_S32   Ret;

    Ret = HI_UNF_DMX_Init();
    if (Ret != HI_SUCCESS)
    {
        HI_DEBUG_ADVCA("call HI_UNF_DMX_Init failed.\n");
        return Ret;
    }
#ifdef __HI3716MV310__
    Ret |= HI_UNF_DMX_AttachTSPort(PLAY_DMX_ID, HI_UNF_DMX_PORT_3_RAM);
#else	
    Ret = HI_UNF_DMX_AttachTSPort(PVR_DMX_ID_REC, HI_UNF_DMX_PORT_RAM_0);
#endif
    if (Ret != HI_SUCCESS)
    {
        HI_DEBUG_ADVCA("call HI_UNF_DMX_AttachTSPort for REC failed.\n");
        HI_UNF_DMX_DeInit();
        return Ret;
    }

    return HI_SUCCESS;
}

static HI_S32 DmxDeInit(HI_VOID)
{
    HI_S32 Ret;

    Ret = HI_UNF_DMX_DetachTSPort(PVR_DMX_ID_REC);
    if (Ret != HI_SUCCESS)
    {
        HI_DEBUG_ADVCA("call HI_UNF_DMX_DetachTSPort failed.\n");
        return Ret;
    }

    Ret = HI_UNF_DMX_DeInit();
    if (Ret != HI_SUCCESS)
    {
        HI_DEBUG_ADVCA("call HI_UNF_DMX_DeInit failed.\n");
        return Ret;
    }

    return HI_SUCCESS;
}

static HI_S32 CW_Test(HI_ADVCA_IRDETO_MSR2_2_CASE_ID enCaseID)
{    
    HI_S32 Ret = HI_SUCCESS;
    HI_UNF_DMX_REC_ATTR_S   attr;
    HI_UNF_DMX_DESCRAMBLER_ATTR_S stDesramblerAttr;

    (HI_VOID)HI_SYS_Init();
    Ret = HI_UNF_ADVCA_Init();
    if (HI_SUCCESS != Ret)
    {
        HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_Init failed, Ret = 0x%x\n", Ret);
        goto SYS_DEINIT;
    }    

    Ret = DmxInit();
    if (HI_SUCCESS != Ret)
    {
        HI_DEBUG_ADVCA("DmxInit failed! ret = 0x%x\n", Ret);
        goto ADVCA_DEINIT;
    }
#ifdef __HI3716MV310__
    Ret = HI_UNF_DMX_CreateTSBuffer(HI_UNF_DMX_PORT_3_RAM, 0x200000, &g_TsBuf);
#else	
    Ret = HI_UNF_DMX_CreateTSBuffer(HI_UNF_DMX_PORT_RAM_0, 0x200000, &g_TsBuf);
#endif
    if (Ret != HI_SUCCESS)
    {
        HI_DEBUG_ADVCA("Call HI_UNF_DMX_CreateTSBuffer failed, Ret = 0x%x\n", Ret);
        goto DMX_DEINIT;
    }

    Ret = HI_UNF_PVR_RecInit();
    if (Ret != HI_SUCCESS)
    {
        HI_DEBUG_ADVCA("call HI_UNF_PVR_RecInit failed. Ret = 0x%x\n", Ret);
        goto DMX_DEINIT;
    }    

    attr.u32DmxId            = PVR_DMX_ID_REC;
    attr.u32RecBufSize   = 4 * 1024 * 1024;
    attr.enRecType          = HI_UNF_DMX_REC_TYPE_SELECT_PID;
    attr.bDescramed       = HI_TRUE;
    attr.enIndexType      = HI_UNF_DMX_REC_INDEX_TYPE_VIDEO;
    attr.u32IndexSrcPid = TESTPID;
    attr.enVCodecType  = HI_UNF_VCODEC_TYPE_MPEG2;    

    Ret = HI_UNF_DMX_CreateRecChn(&attr, &g_RecChn);
    if (HI_SUCCESS != Ret)
    {
        HI_DEBUG_ADVCA("HI_UNF_DMX_CreateRecChn failed! Ret = 0x%x\n", Ret);
        goto REC_DEINIT;
    }
    
    Ret = HI_UNF_DMX_AddRecPid(g_RecChn, TESTPID, &g_hVideochannelhandle);
    if (HI_SUCCESS != Ret)
    {
        HI_DEBUG_ADVCA("HI_UNF_DMX_AddRecPid failed! Ret = 0x%x\n", Ret);
        goto REC_DEINIT;
    }

    stDesramblerAttr.enCaType = HI_UNF_DMX_CA_ADVANCE;
    switch(enCaseID)
    {
    case CW_S0_KL_2TDES_L2_TS_AES: //3.2	CW_S0_KL-2TDES_L2_TS-AES
    case CW_S0_KL_2TDES_L2_TS_AES_TA: //3.3	CW_S0_KL-2TDES_L2_TS-AES_TA
    case CW_S0_KL_2TDES_L3_TS_AES: //3.10	CW_S0_KL-2TDES_L3_TS-AES
    case CW_S0_KL_2TDES_L3_TS_AES_TA: //3.11	CW_S0_KL-2TDES_L3_TS-AES_TA
    case CW_S0_KL_AES_L2_TS_AES: //3.18	CW_S0_KL-AES_L2_TS-AES
    case CW_S0_KL_AES_L2_TS_AES_TA: //3.19	CW_S0_KL-AES_L2_TS-AES_TA
    case CW_S0_KL_AES_L3_TS_AES: //3.26	CW_S0_KL-AES_L3_TS-AES
    case CW_S0_KL_AES_L3_TS_AES_TA: //3.27	CW_S0_KL-AES_L3_TS-AES_TA
        stDesramblerAttr.enDescramblerType = HI_UNF_DMX_DESCRAMBLER_TYPE_AES_CI;
        break;
    case CW_S0_KL_2TDES_L2_TS_CSA: //3.4	CW_S0_KL-2TDES_L2_TS-CSA
    case CW_S0_KL_2TDES_L2_TS_CSA_TA: //3.5	CW_S0_KL-2TDES_L2_TS-CSA_TA
    case CW_S0_KL_2TDES_L3_TS_CSA: //3.12	CW_S0_KL-2TDES_L3_TS-CSA
    case CW_S0_KL_2TDES_L3_TS_CSA_TA: //3.13	CW_S0_KL-2TDES_L3_TS-CSA_TA
    case CW_S0_KL_AES_L2_TS_CSA://3.20	CW_S0_KL-AES_L2_TS-CSA
    case CW_S0_KL_AES_L2_TS_CSA_TA://3.21	CW_S0_KL-AES_L2_TS-CSA_TA
    case CW_S0_KL_AES_L3_TS_CSA://3.28	CW_S0_KL-AES_L3_TS-CSA
    case CW_S0_KL_AES_L3_TS_CSA_TA://3.29	CW_S0_KL-AES_L3_TS-CSA_TA
        stDesramblerAttr.enDescramblerType = HI_UNF_DMX_DESCRAMBLER_TYPE_CSA2;
        break;
    case CW_S0_KL_2TDES_L2_TS_CSA3: //3.6	CW_S0_KL-2TDES_L2_TS-CSA3
    case CW_S0_KL_2TDES_L2_TS_CSA3_TA: //3.7	CW_S0_KL-2TDES_L2_TS-CSA3_TA
    case CW_S0_KL_2TDES_L2_TS_TCSA3: //3.8	CW_S0_KL-2TDES_L2_TS-TCSA3
    case CW_S0_KL_2TDES_L2_TS_TCSA3_TA: //3.9	CW_S0_KL-2TDES_L2_TS-TCSA3_TA
    case CW_S0_KL_2TDES_L3_TS_CSA3: //3.14	CW_S0_KL-2TDES_L3_TS-CSA3
    case CW_S0_KL_2TDES_L3_TS_CSA3_TA: //3.15	CW_S0_KL-2TDES_L3_TS-CSA3_TA
    case CW_S0_KL_2TDES_L3_TS_TCSA3: //3.16	CW_S0_KL-2TDES_L3_TS-TCSA3
    case CW_S0_KL_2TDES_L3_TS_TCSA3_TA: //3.17	CW_S0_KL-2TDES_L3_TS-TCSA3_TA
    case CW_S0_KL_AES_L2_TS_CSA3://3.22	CW_S0_KL-AES_L2_TS-CSA3
    case CW_S0_KL_AES_L2_TS_CSA3_TA://3.23	CW_S0_KL-AES_L2_TS-CSA3_TA
    case CW_S0_KL_AES_L2_TS_TCSA3://3.24	CW_S0_KL-AES_L2_TS-TCSA3  
    case CW_S0_KL_AES_L2_TS_TCSA3_TA://3.25	CW_S0_KL-AES_L2_TS-TCSA3_TA  
    case CW_S0_KL_AES_L3_TS_CSA3: //3.30	CW_S0_KL-AES_L3_TS-CSA3
    case CW_S0_KL_AES_L3_TS_CSA3_TA: //3.31	CW_S0_KL-AES_L3_TS-CSA3_TA
    case CW_S0_KL_AES_L3_TS_TCSA3: //3.32	CW_S0_KL-AES_L3_TS-TCSA3
    case CW_S0_KL_AES_L3_TS_TCSA3_TA: //3.33	CW_S0_KL-AES_L3_TS-TCSA3_TA    
        stDesramblerAttr.enDescramblerType = HI_UNF_DMX_DESCRAMBLER_TYPE_CSA3;
        break;
    default:
        HI_DEBUG_ADVCA("Invalid CW type: %d\n", g_CwType);
        break;
    }
    stDesramblerAttr.enEntropyReduction = HI_UNF_DMX_CA_ENTROPY_REDUCTION_CLOSE;    
    Ret = HI_UNF_DMX_CreateDescramblerExt(PVR_DMX_ID_REC, &stDesramblerAttr, &g_RecDesc);
     if (HI_SUCCESS != Ret)
    {
        HI_DEBUG_ADVCA("HI_UNF_DMX_CreateDescramblerExt failed!Ret = 0x%x\n", Ret);
        goto REC_DEINIT;
    }     
    
    Ret = HI_UNF_DMX_AttachDescrambler(g_RecDesc, g_hVideochannelhandle);  //attach channel key
     if (HI_SUCCESS != Ret)
    {
        HI_DEBUG_ADVCA("HI_UNF_DMX_AttachDescrambler failed!Ret = 0x%x\n", Ret);
        goto DESC_DESTROY;
    }
     
     Ret = AVPLAY_SetCW(g_RecDesc);
     if (HI_SUCCESS != Ret)
    {
        HI_DEBUG_ADVCA("AVPLAY_SetCW failed!Ret = 0x%x\n", Ret);
        goto REC_CHN_DESTORY;
    }     

    Ret = HI_UNF_DMX_StartRecChn(g_RecChn);
    if (HI_SUCCESS != Ret)
    {
        HI_DEBUG_ADVCA("HI_UNF_DMX_StartRecChn failed! Ret = 0x%x\n", Ret);
        goto REC_CHN_DESTORY;
    }

    (HI_VOID)pthread_mutex_init(&g_TsMutex,NULL);
    g_bStopTsThread = HI_FALSE;
    (HI_VOID)pthread_create(&g_TsThd, HI_NULL, PlayTsTthread, HI_NULL);    

    (HI_VOID)pthread_create(&g_RecThd, HI_NULL, RecTsTthread, HI_NULL);
    while(!g_bStopTsThread)
     {
        HI_DEBUG_ADVCA(".");
        usleep(1000 * 1000);
     };

    (HI_VOID)pthread_join(g_TsThd, HI_NULL);
    (HI_VOID)pthread_mutex_destroy(&g_TsMutex);
    (HI_VOID)pthread_join(g_RecThd, HI_NULL);

REC_CHN_DESTORY:
    HI_UNF_DMX_StopRecChn(g_RecChn);
    HI_UNF_DMX_DestroyRecChn(g_RecChn);

DESC_DESTROY:
    HI_UNF_DMX_DestroyDescrambler(g_RecDesc);

REC_DEINIT:
    (HI_VOID)HI_UNF_PVR_RecDeInit();

DMX_DEINIT:
    (HI_VOID)DmxDeInit();

ADVCA_DEINIT:
    (HI_VOID)HI_UNF_ADVCA_DeInit();

SYS_DEINIT:
    (HI_VOID)HI_SYS_DeInit();    

    return Ret;
}

static HI_VOID *RecTsTthread(HI_VOID *args)
{
    HI_UNF_DMX_REC_DATA_S stDmxRecData;
    HI_S32 Ret;

    while (1)
    {
        memset(&stDmxRecData, 0, sizeof(stDmxRecData));
        Ret = HI_UNF_DMX_AcquireRecData(g_RecChn, &stDmxRecData, 5000);
        if(Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("HI_UNF_DMX_AcquireRecData failed, ret = 0x%x\n", Ret);
            continue;
        }
#if 0      
        HI_U32 i;
        HI_DEBUG_ADVCA("Rec data:\n");
        for(i = 0; i < 188; i++)
        {
            if(i % 16 == 0 && i != 0)
            {
                HI_DEBUG_ADVCA("\n");
            }        
            HI_DEBUG_ADVCA("0x%02x,", stDmxRecData.pDataAddr[i]);
        }
        HI_DEBUG_ADVCA("\n");
#endif
        Ret = memcmp(stDmxRecData.pDataAddr + 4, Clear_TS_packet_payload, 184); //skip the ts packet head 4 byte
        if(Ret == HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("\n\nTest Case Successfully!\n\n");
        }
        else
        {
            HI_DEBUG_ADVCA("\n\nTest Case Failed!\n\n");
        }

        HI_UNF_DMX_ReleaseRecData(g_RecChn, &stDmxRecData);        
        g_bStopTsThread = HI_TRUE;        
        break;
    }

    return HI_NULL;
}

static HI_VOID show_usage(HI_VOID)
{
    HI_DEBUG_ADVCA("Usage: ./sample_ca_tsplay\n");

    HI_DEBUG_ADVCA("\nTest case:\n\n");
    HI_DEBUG_ADVCA("0: Clear_CW (SST_V2.4.mpg)\n");
    HI_DEBUG_ADVCA("1: 8byte_CW-KL_ALG_TDES-KL_Level_2-TS_CSA2 (SST_V2.4.mpg)\n");
    HI_DEBUG_ADVCA("2: 8byte_CW-KL_ALG_AES-KL_Level_2-TS_CSA2 (SST_V2.4.mpg)\n");
    HI_DEBUG_ADVCA("3: 16byte_CW-KL_ALG_AES-KL_Level_2-TS_AES_CBC (IRDETO_AES_CBC.ts)\n\n");
    HI_DEBUG_ADVCA("4: CW_S0_KL-2TDES_L2_TS-AES\n");
    HI_DEBUG_ADVCA("5: CW_S0_KL-2TDES_L2_TS-AES_TA\n");
    HI_DEBUG_ADVCA("6: CW_S0_KL-2TDES_L2_TS-CSA\n");
    HI_DEBUG_ADVCA("7: CW_S0_KL-2TDES_L2_TS-CSA_TA\n");
    HI_DEBUG_ADVCA("8: CW_S0_KL-2TDES_L2_TS-CSA3\n");
    HI_DEBUG_ADVCA("9: CW_S0_KL-2TDES_L2_TS-CSA3_TA\n");
    HI_DEBUG_ADVCA("10: CW_S0_KL-2TDES_L2_TS-TCSA3\n");
    HI_DEBUG_ADVCA("11: CW_S0_KL-2TDES_L2_TS-TCSA3_TA\n\n");
    HI_DEBUG_ADVCA("12: CW_S0_KL-2TDES_L3_TS-AES\n");
    HI_DEBUG_ADVCA("13: CW_S0_KL-2TDES_L3_TS-AES_TA\n");
    HI_DEBUG_ADVCA("14: CW_S0_KL-2TDES_L3_TS-CSA\n");
    HI_DEBUG_ADVCA("15: CW_S0_KL-2TDES_L3_TS-CSA_TA\n");
    HI_DEBUG_ADVCA("16: CW_S0_KL-2TDES_L3_TS-CSA3\n");
    HI_DEBUG_ADVCA("17: CW_S0_KL-2TDES_L3_TS-CSA3_TA\n");
    HI_DEBUG_ADVCA("18: CW_S0_KL-2TDES_L3_TS-TCSA3\n");
    HI_DEBUG_ADVCA("19: CW_S0_KL-2TDES_L3_TS-TCSA3_TA\n\n");
    HI_DEBUG_ADVCA("20: CW_S0_KL-AES_L2_TS-AES\n");
    HI_DEBUG_ADVCA("21: CW_S0_KL-AES_L2_TS-AES_TA\n");
    HI_DEBUG_ADVCA("22: CW_S0_KL-AES_L2_TS-CSA\n");
    HI_DEBUG_ADVCA("23: CW_S0_KL-AES_L2_TS-CSA_TA\n");
    HI_DEBUG_ADVCA("24: CW_S0_KL-AES_L2_TS-CSA3\n");
    HI_DEBUG_ADVCA("25: CW_S0_KL-AES_L2_TS-CSA3_TA\n");
    HI_DEBUG_ADVCA("26: CW_S0_KL-AES_L2_TS-TCSA3\n");
    HI_DEBUG_ADVCA("27: CW_S0_KL-AES_L2_TS-TCSA3_TA\n\n");
    HI_DEBUG_ADVCA("28: CW_S0_KL-AES_L3_TS-AES\n");
    HI_DEBUG_ADVCA("29: CW_S0_KL-AES_L3_TS-AES_TA\n");
    HI_DEBUG_ADVCA("30: CW_S0_KL-AES_L3_TS-CSA\n");
    HI_DEBUG_ADVCA("31: CW_S0_KL-AES_L3_TS-CSA_TA\n");
    HI_DEBUG_ADVCA("32: CW_S0_KL-AES_L3_TS-CSA3\n");
    HI_DEBUG_ADVCA("33: CW_S0_KL-AES_L3_TS-CSA3_TA\n"); 
    HI_DEBUG_ADVCA("34: CW_S0_KL-AES_L3_TS-TCSA3\n");
    HI_DEBUG_ADVCA("35: CW_S0_KL-AES_L3_TS-TCSA3_TA\n\n");
    HI_DEBUG_ADVCA("36: PVR_S0_KL-2TDES_L2_TS-2TDES_CBC\n");
    HI_DEBUG_ADVCA("37: PVR_S0_KL-2TDES_L2_TS-2TDES_ECB\n");
    HI_DEBUG_ADVCA("38: PVR_S0_KL-2TDES_L2_TS-AES_CBC\n");
    HI_DEBUG_ADVCA("39: PVR_S0_KL-2TDES_L2_TS-AES_ECB\n\n");
    HI_DEBUG_ADVCA("40: PVR_S0_KL-2TDES_L3_TS-2TDES_CBC\n");
    HI_DEBUG_ADVCA("41: PVR_S0_KL-2TDES_L3_TS-2TDES_ECB\n");
    HI_DEBUG_ADVCA("42: PVR_S0_KL-2TDES_L3_TS-AES_CBC\n");
    HI_DEBUG_ADVCA("43: PVR_S0_KL-2TDES_L3_TS-AES_ECB\n\n");
    HI_DEBUG_ADVCA("44: PVR_S0_KL-AES_L2_TS-2TDES_CBC\n");
    HI_DEBUG_ADVCA("45: PVR_S0_KL-AES_L2_TS-2TDES_ECB\n");
    HI_DEBUG_ADVCA("46: PVR_S0_KL-AES_L2_TS-AES_CBC\n");
    HI_DEBUG_ADVCA("47: PVR_S0_KL-AES_L2_TS-AES_ECB\n\n");
    HI_DEBUG_ADVCA("48: PVR_S0_KL-AES_L3_TS-2TDES_CBC\n");
    HI_DEBUG_ADVCA("49: PVR_S0_KL-AES_L3_TS-2TDES_ECB\n");    
    HI_DEBUG_ADVCA("50: PVR_S0_KL-AES_L3_TS-AES_CBC\n");    
    HI_DEBUG_ADVCA("51: PVR_S0_KL-AES_L3_TS-AES_ECB\n\n"); 
    HI_DEBUG_ADVCA("52: AES CBC-MAC HIGH-LEVEL CODE AUTHENTICATION\n\n"); 
    HI_DEBUG_ADVCA("53: AES CBC-MAC CHIP CONFIGURATION CHECK\n\n"); 
    HI_DEBUG_ADVCA("q: Exit\n");
}

static HI_S32 run_cmdline(HI_S32 argc, HI_CHAR** argv)
{
    HI_S32 Ret = HI_SUCCESS;
    HI_U32 u32TestCase = 0;
    HI_CHAR cUserInput[512];

    while(1)
    {
        show_usage();
        memset(cUserInput, 0, sizeof(cUserInput));
        fgets(cUserInput, 512, stdin);
        if(cUserInput[0] == 'q' || cUserInput[0] == 'Q')
        {
            break;
        }
        u32TestCase = strtol(cUserInput, NULL, 10);
        g_CwType = u32TestCase;
        switch(u32TestCase)
        {
        case Clear_CW: //0: Clear_CW (SST_V2.4.mpg)
        case CW_8byte_KL_ALG_TDES_KL_Level_2_TS_CSA2: //1: 8byte_CW-KL_ALG_TDES-KL_Level_2-TS_CSA2 (SST_V2.4.mpg)
        case CW_8byte_KL_ALG_AES_KL_Level_2_TS_CSA2: //2: 8byte_CW-KL_ALG_AES-KL_Level_2-TS_CSA2 (SST_V2.4.mpg)
        case CW_16byte_KL_ALG_AES_KL_Level_2_TS_AES_CBC: //3: 16byte_CW-KL_ALG_AES-KL_Level_2-TS_AES_CBC (IRDETO_AES_CBC.ts)
            Ret = AVPLAY_TS(u32TestCase);
            break;
        case AES_CBC_MAC_HIGH_LEVEL_CODE_AUTHENTICATION:
            Ret = CBC_MAC_Test();
            break;
        case AES_CBC_MAC_CHIP_CONFIGURATION_CHECK:
            Ret = Chip_Confiuration_Check();
            break;
        case PVR_S0_KL_2TDES_L2_TS_2TDES_CBC:
        case PVR_S0_KL_2TDES_L2_TS_2TDES_ECB:
        case PVR_S0_KL_2TDES_L2_TS_AES_CBC:
        case PVR_S0_KL_2TDES_L2_TS_AES_ECB:
    
        case PVR_S0_KL_2TDES_L3_TS_2TDES_CBC:
        case PVR_S0_KL_2TDES_L3_TS_2TDES_ECB:
        case PVR_S0_KL_2TDES_L3_TS_AES_CBC:
        case PVR_S0_KL_2TDES_L3_TS_AES_ECB:
    
        case PVR_S0_KL_AES_L2_TS_2TDES_CBC:
        case PVR_S0_KL_AES_L2_TS_2TDES_ECB:
        case PVR_S0_KL_AES_L2_TS_AES_CBC:
        case PVR_S0_KL_AES_L2_TS_AES_ECB:
    
        case PVR_S0_KL_AES_L3_TS_2TDES_CBC:
        case PVR_S0_KL_AES_L3_TS_2TDES_ECB:
        case PVR_S0_KL_AES_L3_TS_AES_CBC:
        case PVR_S0_KL_AES_L3_TS_AES_ECB:
            Ret = PVR_Test(u32TestCase);
            break;            
        default:
            Ret = CW_Test(u32TestCase);
            break; 
        }        
    }
    
    return Ret;    
}

static HI_S32 ConfigCipher(HI_HANDLE hHandle,
                                                            HI_UNF_CIPHER_ALG_E enAlg, 
                                                            HI_UNF_CIPHER_WORK_MODE_E enWorkMode,
                                                            HI_UNF_CIPHER_BIT_WIDTH_E enBitWidth,
                                                            HI_UNF_CIPHER_KEY_LENGTH_E enKeyLen,
                                                            HI_U8 u8Key[]
)
{
    HI_S32 Ret = HI_FAILURE;
    HI_UNF_CIPHER_CTRL_S CipherCtrl;

    memset(&CipherCtrl, 0, sizeof(CipherCtrl));
    CipherCtrl.bKeyByCA = HI_TRUE;
    CipherCtrl.enCaType = HI_UNF_CIPHER_CA_TYPE_R2R;
    CipherCtrl.enAlg = enAlg;
    CipherCtrl.enWorkMode = enWorkMode;
    CipherCtrl.enBitWidth = enBitWidth;
    CipherCtrl.enKeyLen = enKeyLen;
    if(enWorkMode == HI_UNF_CIPHER_WORK_MODE_CBC)
    {
        CipherCtrl.stChangeFlags.bit1IV = 1;
    }
    memcpy(CipherCtrl.u32Key, u8Key, 16);
    memset(CipherCtrl.u32IV, 0, 16);

    Ret = HI_UNF_CIPHER_ConfigHandle(hHandle, &CipherCtrl);
    return Ret;
}

static HI_S32 ConfigR2RKeyladder(HI_U32 u32TotalLevel,
                                                            HI_UNF_ADVCA_ALG_TYPE_E enAlg, 
                                                            HI_U8 u8Lev1SessionKey[],
                                                            HI_U8 u8Lev2SessionKey[]
)
{
    HI_S32 Ret = HI_FAILURE;
    HI_UNF_ADVCA_KEYLADDER_LEV_E enKeyladderLev;

    Ret = HI_UNF_ADVCA_SetR2RAlg(enAlg);
    if(Ret != HI_SUCCESS)
    {
        HI_DEBUG_ADVCA("HI_UNF_ADVCA_SetR2RAlg failed! Ret = 0x%x\n", Ret);
        return Ret;
    }
    
    Ret = HI_UNF_ADVCA_GetR2RKeyLadderStage(&enKeyladderLev);
    if(Ret != HI_SUCCESS)
    {
        HI_DEBUG_ADVCA("HI_UNF_ADVCA_GetR2RKeyLadderStage failed! Ret = 0x%x\n", Ret);
        return Ret;
    }
    
    if(u32TotalLevel == 2)
    {
        if(enKeyladderLev == HI_UNF_ADVCA_KEYLADDER_LEV3)
        {
            HI_DEBUG_ADVCA("R2R keyladder stage is 3, should be 2\n");
            return Ret;            
        }
        Ret = HI_UNF_ADVCA_SetR2RSessionKey(HI_UNF_ADVCA_KEYLADDER_LEV1, u8Lev1SessionKey);
    }
    else if(u32TotalLevel == 3) //if keyladder stage is 3, set the level 2 session key
    {
        if(enKeyladderLev == HI_UNF_ADVCA_KEYLADDER_LEV2)
        {
            HI_DEBUG_ADVCA("R2R keyladder stage is 2, should be 3\n");
            return Ret;            
        }    
        Ret = HI_UNF_ADVCA_SetR2RSessionKey(HI_UNF_ADVCA_KEYLADDER_LEV1, u8Lev1SessionKey);
        Ret = HI_UNF_ADVCA_SetR2RSessionKey(HI_UNF_ADVCA_KEYLADDER_LEV2, u8Lev2SessionKey);
    }
    else
    {
        Ret = HI_FAILURE;
        HI_DEBUG_ADVCA("Unknown keyladder level: %d\n", u32TotalLevel);
    }

    return Ret;
}

static HI_S32 PVR_Test(HI_ADVCA_IRDETO_MSR2_2_CASE_ID enCaseID)
{
    HI_S32 Ret = HI_FAILURE;
    HI_U32 u32InputAddrPhy, u32OutPutAddrPhy;
    HI_U8 *pu8InputAddrVir, *pu8OutputAddrVir;
    HI_HANDLE hCipherHandle = 0;
    HI_UNF_CIPHER_ATTS_S stCipherAttr;
    HI_U32 u32DataLen = 0;

    memset(&stCipherAttr, 0, sizeof(stCipherAttr));
    stCipherAttr.enCipherType = HI_UNF_CIPHER_TYPE_NORMAL;
    (HI_VOID)HI_SYS_Init();

    Ret = HI_UNF_CIPHER_Init();
    if(Ret != HI_SUCCESS)
    {
        HI_DEBUG_ADVCA("HI_UNF_CIPHER_Init failed! Ret = 0x%x\n", Ret);
        goto SYS_DEINIT;
    }
    
    Ret = HI_UNF_ADVCA_Init();
    if(Ret != HI_SUCCESS)
    {
        HI_DEBUG_ADVCA("HI_UNF_ADVCA_Init failed! Ret = 0x%x\n", Ret);
        goto CIPHER_DEINIT;
    }
    
    Ret = HI_UNF_CIPHER_CreateHandle(&hCipherHandle, &stCipherAttr);
    if(Ret != HI_SUCCESS)
    {
        HI_DEBUG_ADVCA("HI_UNF_CIPHER_CreateHandle failed! Ret = 0x%x\n", Ret);
        goto CIPHER_DESTROY;
    }    
  
    u32InputAddrPhy = (HI_U32)HI_MMZ_New(1024, 0, NULL, "cipherIn");
    if (0 == u32InputAddrPhy)
    {
        HI_DEBUG_ADVCA("Malloc phyaddr for Input failed!\n");
        goto CIPHER_DESTROY;
    }
    pu8InputAddrVir = HI_MMZ_Map(u32InputAddrPhy, 0);

    u32OutPutAddrPhy = (HI_U32)HI_MMZ_New(1024, 0, NULL, "cipherOut");
    if (0 == u32OutPutAddrPhy)
    {
        HI_DEBUG_ADVCA("Malloc phyaddr for Output failed!\n");
        goto INPUT_ADDR_PHY_DEL;
    }
    pu8OutputAddrVir = HI_MMZ_Map(u32OutPutAddrPhy, 0);
    memcpy(pu8InputAddrVir, Clear_TS_packet_payload, sizeof(Clear_TS_packet_payload));
    memset(pu8OutputAddrVir, 0, 1024);
    switch(enCaseID)
    {
    case PVR_S0_KL_2TDES_L2_TS_2TDES_CBC:
        ConfigR2RKeyladder(2, HI_UNF_ADVCA_ALG_TYPE_TDES, PVR_S0_KL_2TDES_L2_TS_2TDES_CBC_CPSKp, NULL);
        ConfigCipher(hCipherHandle, 
                                    HI_UNF_CIPHER_ALG_3DES,
                                    HI_UNF_CIPHER_WORK_MODE_CBC,
                                    HI_UNF_CIPHER_BIT_WIDTH_64BIT,
                                    HI_UNF_CIPHER_KEY_DES_2KEY,
                                    PVR_S0_KL_2TDES_L2_TS_2TDES_CBC_CEK_p);
        u32DataLen = (sizeof(Clear_TS_packet_payload) / 8) * 8; //should be aligned to 8 bytes for TDES
        Ret = HI_UNF_CIPHER_Encrypt(hCipherHandle, u32InputAddrPhy, u32OutPutAddrPhy, u32DataLen);
        if (Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("HI_UNF_CIPHER_Encrypt failed! Ret = 0x%x\n", Ret);
            goto OUTPUT_ADDR_PHY_DEL;
        }
        Ret = memcmp(pu8OutputAddrVir, PVR_S0_KL_2TDES_L2_TS_2TDES_CBC_Encrypted_payload, u32DataLen);        
        break;
    case PVR_S0_KL_2TDES_L2_TS_2TDES_ECB:
        ConfigR2RKeyladder(2, HI_UNF_ADVCA_ALG_TYPE_TDES, PVR_S0_KL_2TDES_L2_TS_2TDES_ECB_CPSKp, NULL);
        ConfigCipher(hCipherHandle, 
                                    HI_UNF_CIPHER_ALG_3DES,
                                    HI_UNF_CIPHER_WORK_MODE_ECB,
                                    HI_UNF_CIPHER_BIT_WIDTH_64BIT,
                                    HI_UNF_CIPHER_KEY_DES_2KEY,
                                    PVR_S0_KL_2TDES_L2_TS_2TDES_ECB_CEK_p);
        u32DataLen = (sizeof(Clear_TS_packet_payload) / 8) * 8; //should be aligned to 8 bytes for TDES
        Ret = HI_UNF_CIPHER_Encrypt(hCipherHandle, u32InputAddrPhy, u32OutPutAddrPhy, u32DataLen);
        if (Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("HI_UNF_CIPHER_Encrypt failed! Ret = 0x%x\n", Ret);
            goto OUTPUT_ADDR_PHY_DEL;
        }
        Ret = memcmp(pu8OutputAddrVir, PVR_S0_KL_2TDES_L2_TS_2TDES_ECB_Encrypted_payload, u32DataLen);        
        break;
    case PVR_S0_KL_2TDES_L2_TS_AES_CBC:
        ConfigR2RKeyladder(2, HI_UNF_ADVCA_ALG_TYPE_TDES, PVR_S0_KL_2TDES_L2_TS_AES_CBC_CPSKp, NULL);
        ConfigCipher(hCipherHandle, 
                                    HI_UNF_CIPHER_ALG_AES,
                                    HI_UNF_CIPHER_WORK_MODE_CBC,
                                    HI_UNF_CIPHER_BIT_WIDTH_128BIT,
                                    HI_UNF_CIPHER_KEY_AES_128BIT,
                                    PVR_S0_KL_2TDES_L2_TS_AES_CBC_CEK_p);
        u32DataLen = (sizeof(Clear_TS_packet_payload) / 16) * 16; //should be aligned to 16 bytes for AES
        Ret = HI_UNF_CIPHER_Encrypt(hCipherHandle, u32InputAddrPhy, u32OutPutAddrPhy, u32DataLen);
        if (Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("HI_UNF_CIPHER_Encrypt failed! Ret = 0x%x\n", Ret);
            goto OUTPUT_ADDR_PHY_DEL;
        }
        Ret = memcmp(pu8OutputAddrVir, PVR_S0_KL_2TDES_L2_TS_AES_CBC_Encrypted_payload, u32DataLen);        
        break;
    case PVR_S0_KL_2TDES_L2_TS_AES_ECB:
        ConfigR2RKeyladder(2, HI_UNF_ADVCA_ALG_TYPE_TDES, PVR_S0_KL_2TDES_L2_TS_AES_ECB_CPSKp, NULL);
        ConfigCipher(hCipherHandle, 
                                    HI_UNF_CIPHER_ALG_AES,
                                    HI_UNF_CIPHER_WORK_MODE_ECB,
                                    HI_UNF_CIPHER_BIT_WIDTH_128BIT,
                                    HI_UNF_CIPHER_KEY_AES_128BIT,
                                    PVR_S0_KL_2TDES_L2_TS_AES_ECB_CEK_p);
        u32DataLen = (sizeof(Clear_TS_packet_payload) / 16) * 16; //should be aligned to 16 bytes for AES
        Ret = HI_UNF_CIPHER_Encrypt(hCipherHandle, u32InputAddrPhy, u32OutPutAddrPhy, u32DataLen);
        if (Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("HI_UNF_CIPHER_Encrypt failed! Ret = 0x%x\n", Ret);
            goto OUTPUT_ADDR_PHY_DEL;
        }
        Ret = memcmp(pu8OutputAddrVir, PVR_S0_KL_2TDES_L2_TS_AES_ECB_Encrypted_payload, u32DataLen);        
        break;
    case PVR_S0_KL_2TDES_L3_TS_2TDES_CBC:
        ConfigR2RKeyladder(3, HI_UNF_ADVCA_ALG_TYPE_TDES, PVR_S0_KL_2TDES_L3_TS_2TDES_CBC_CPAKp, PVR_S0_KL_2TDES_L3_TS_2TDES_CBC_CPSKp);
        ConfigCipher(hCipherHandle, 
                                    HI_UNF_CIPHER_ALG_3DES,
                                    HI_UNF_CIPHER_WORK_MODE_CBC,
                                    HI_UNF_CIPHER_BIT_WIDTH_64BIT,
                                    HI_UNF_CIPHER_KEY_DES_2KEY,
                                    PVR_S0_KL_2TDES_L3_TS_2TDES_CBC_CEK_p);
        u32DataLen = (sizeof(Clear_TS_packet_payload) / 8) * 8; //should be aligned to 8 bytes for TDES
        Ret = HI_UNF_CIPHER_Encrypt(hCipherHandle, u32InputAddrPhy, u32OutPutAddrPhy, u32DataLen);
        if (Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("HI_UNF_CIPHER_Encrypt failed! Ret = 0x%x\n", Ret);
            goto OUTPUT_ADDR_PHY_DEL;
        }
        Ret = memcmp(pu8OutputAddrVir, PVR_S0_KL_2TDES_L3_TS_2TDES_CBC_Encrypted_payload, u32DataLen);        
        break;
    case PVR_S0_KL_2TDES_L3_TS_2TDES_ECB:
        ConfigR2RKeyladder(3, HI_UNF_ADVCA_ALG_TYPE_TDES, PVR_S0_KL_2TDES_L3_TS_2TDES_ECB_CPAKp, PVR_S0_KL_2TDES_L3_TS_2TDES_ECB_CPSKp);
        ConfigCipher(hCipherHandle, 
                                    HI_UNF_CIPHER_ALG_3DES,
                                    HI_UNF_CIPHER_WORK_MODE_ECB,
                                    HI_UNF_CIPHER_BIT_WIDTH_64BIT,
                                    HI_UNF_CIPHER_KEY_DES_2KEY,
                                    PVR_S0_KL_2TDES_L3_TS_2TDES_ECB_CEK_p);
        u32DataLen = (sizeof(Clear_TS_packet_payload) / 8) * 8; //should be aligned to 8 bytes for TDES
        Ret = HI_UNF_CIPHER_Encrypt(hCipherHandle, u32InputAddrPhy, u32OutPutAddrPhy, u32DataLen);
        if (Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("HI_UNF_CIPHER_Encrypt failed! Ret = 0x%x\n", Ret);
            goto OUTPUT_ADDR_PHY_DEL;
        }
        Ret = memcmp(pu8OutputAddrVir, PVR_S0_KL_2TDES_L3_TS_2TDES_ECB_Encrypted_payload, u32DataLen);        
        break;
    case PVR_S0_KL_2TDES_L3_TS_AES_CBC:
        ConfigR2RKeyladder(3, HI_UNF_ADVCA_ALG_TYPE_TDES, PVR_S0_KL_2TDES_L3_TS_AES_CBC_CPAKp, PVR_S0_KL_2TDES_L3_TS_AES_CBC_CPSKp);
        ConfigCipher(hCipherHandle, 
                                    HI_UNF_CIPHER_ALG_AES,
                                    HI_UNF_CIPHER_WORK_MODE_CBC,
                                    HI_UNF_CIPHER_BIT_WIDTH_128BIT,
                                    HI_UNF_CIPHER_KEY_AES_128BIT,
                                    PVR_S0_KL_2TDES_L3_TS_AES_CBC_CEK_p);
        u32DataLen = (sizeof(Clear_TS_packet_payload) / 16) * 16; //should be aligned to 16 bytes for AES
        Ret = HI_UNF_CIPHER_Encrypt(hCipherHandle, u32InputAddrPhy, u32OutPutAddrPhy, u32DataLen);
        if (Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("HI_UNF_CIPHER_Encrypt failed! Ret = 0x%x\n", Ret);
            goto OUTPUT_ADDR_PHY_DEL;
        }
        Ret = memcmp(pu8OutputAddrVir, PVR_S0_KL_2TDES_L3_TS_AES_CBC_Encrypted_payload, u32DataLen);        
        break;
    case PVR_S0_KL_2TDES_L3_TS_AES_ECB:
        ConfigR2RKeyladder(3, HI_UNF_ADVCA_ALG_TYPE_TDES, PVR_S0_KL_2TDES_L3_TS_AES_ECB_CPAKp, PVR_S0_KL_2TDES_L3_TS_AES_ECB_CPSKp);
        ConfigCipher(hCipherHandle, 
                                    HI_UNF_CIPHER_ALG_AES,
                                    HI_UNF_CIPHER_WORK_MODE_ECB,
                                    HI_UNF_CIPHER_BIT_WIDTH_128BIT,
                                    HI_UNF_CIPHER_KEY_AES_128BIT,
                                    PVR_S0_KL_2TDES_L3_TS_AES_ECB_CEK_p);
        u32DataLen = (sizeof(Clear_TS_packet_payload) / 16) * 16; //should be aligned to 16 bytes for AES
        Ret = HI_UNF_CIPHER_Encrypt(hCipherHandle, u32InputAddrPhy, u32OutPutAddrPhy, u32DataLen);
        if (Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("HI_UNF_CIPHER_Encrypt failed! Ret = 0x%x\n", Ret);
            goto OUTPUT_ADDR_PHY_DEL;
        }
        Ret = memcmp(pu8OutputAddrVir, PVR_S0_KL_2TDES_L3_TS_AES_ECB_Encrypted_payload, u32DataLen);        
        break;       
    case PVR_S0_KL_AES_L2_TS_2TDES_CBC:
        ConfigR2RKeyladder(2, HI_UNF_ADVCA_ALG_TYPE_AES, PVR_S0_KL_AES_L2_TS_2TDES_CBC_CPSKp, NULL);
        ConfigCipher(hCipherHandle, 
                                    HI_UNF_CIPHER_ALG_3DES,
                                    HI_UNF_CIPHER_WORK_MODE_CBC,
                                    HI_UNF_CIPHER_BIT_WIDTH_64BIT,
                                    HI_UNF_CIPHER_KEY_DES_2KEY,
                                    PVR_S0_KL_AES_L2_TS_2TDES_CBC_CEK_p);
        u32DataLen = (sizeof(Clear_TS_packet_payload) / 8) * 8; //should be aligned to 8 bytes for TDES
        Ret = HI_UNF_CIPHER_Encrypt(hCipherHandle, u32InputAddrPhy, u32OutPutAddrPhy, u32DataLen);
        if (Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("HI_UNF_CIPHER_Encrypt failed! Ret = 0x%x\n", Ret);
            goto OUTPUT_ADDR_PHY_DEL;
        }
        Ret = memcmp(pu8OutputAddrVir, PVR_S0_KL_AES_L2_TS_2TDES_CBC_Encrypted_payload, u32DataLen);        
        break;
    case PVR_S0_KL_AES_L2_TS_2TDES_ECB:
        ConfigR2RKeyladder(2, HI_UNF_ADVCA_ALG_TYPE_AES, PVR_S0_KL_AES_L2_TS_2TDES_ECB_CPSKp, NULL);
        ConfigCipher(hCipherHandle, 
                                    HI_UNF_CIPHER_ALG_3DES,
                                    HI_UNF_CIPHER_WORK_MODE_ECB,
                                    HI_UNF_CIPHER_BIT_WIDTH_64BIT,
                                    HI_UNF_CIPHER_KEY_DES_2KEY,
                                    PVR_S0_KL_AES_L2_TS_2TDES_ECB_CEK_p);
        u32DataLen = (sizeof(Clear_TS_packet_payload) / 8) * 8; //should be aligned to 8 bytes for TDES
        Ret = HI_UNF_CIPHER_Encrypt(hCipherHandle, u32InputAddrPhy, u32OutPutAddrPhy, u32DataLen);
        if (Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("HI_UNF_CIPHER_Encrypt failed! Ret = 0x%x\n", Ret);
            goto OUTPUT_ADDR_PHY_DEL;
        }
        Ret = memcmp(pu8OutputAddrVir, PVR_S0_KL_AES_L2_TS_2TDES_ECB_Encrypted_payload, u32DataLen);        
        break;
    case PVR_S0_KL_AES_L2_TS_AES_CBC:
        ConfigR2RKeyladder(2, HI_UNF_ADVCA_ALG_TYPE_AES, PVR_S0_KL_AES_L2_TS_AES_CBC_CPSKp, NULL);
        ConfigCipher(hCipherHandle, 
                                    HI_UNF_CIPHER_ALG_AES,
                                    HI_UNF_CIPHER_WORK_MODE_CBC,
                                    HI_UNF_CIPHER_BIT_WIDTH_128BIT,
                                    HI_UNF_CIPHER_KEY_AES_128BIT,
                                    PVR_S0_KL_AES_L2_TS_AES_CBC_CEK_p);
        u32DataLen = (sizeof(Clear_TS_packet_payload) / 16) * 16; //should be aligned to 16 bytes for AES
        Ret = HI_UNF_CIPHER_Encrypt(hCipherHandle, u32InputAddrPhy, u32OutPutAddrPhy, u32DataLen);
        if (Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("HI_UNF_CIPHER_Encrypt failed! Ret = 0x%x\n", Ret);
            goto OUTPUT_ADDR_PHY_DEL;
        }
        Ret = memcmp(pu8OutputAddrVir, PVR_S0_KL_AES_L2_TS_AES_CBC_Encrypted_payload, u32DataLen);        
        break;
    case PVR_S0_KL_AES_L2_TS_AES_ECB:
        ConfigR2RKeyladder(2, HI_UNF_ADVCA_ALG_TYPE_AES, PVR_S0_KL_AES_L2_TS_AES_ECB_CPSKp, NULL);
        ConfigCipher(hCipherHandle, 
                                    HI_UNF_CIPHER_ALG_AES,
                                    HI_UNF_CIPHER_WORK_MODE_ECB,
                                    HI_UNF_CIPHER_BIT_WIDTH_128BIT,
                                    HI_UNF_CIPHER_KEY_AES_128BIT,
                                    PVR_S0_KL_AES_L2_TS_AES_ECB_CEK_p);
        u32DataLen = (sizeof(Clear_TS_packet_payload) / 16) * 16; //should be aligned to 16 bytes for AES
        Ret = HI_UNF_CIPHER_Encrypt(hCipherHandle, u32InputAddrPhy, u32OutPutAddrPhy, u32DataLen);
        if (Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("HI_UNF_CIPHER_Encrypt failed! Ret = 0x%x\n", Ret);
            goto OUTPUT_ADDR_PHY_DEL;
        }
        Ret = memcmp(pu8OutputAddrVir, PVR_S0_KL_AES_L2_TS_AES_ECB_Encrypted_payload, u32DataLen);        
        break;
    case PVR_S0_KL_AES_L3_TS_2TDES_CBC:
        ConfigR2RKeyladder(3, HI_UNF_ADVCA_ALG_TYPE_AES, PVR_S0_KL_AES_L3_TS_2TDES_CBC_CPAKp, PVR_S0_KL_AES_L3_TS_2TDES_CBC_CPSKp);
        ConfigCipher(hCipherHandle, 
                                    HI_UNF_CIPHER_ALG_3DES,
                                    HI_UNF_CIPHER_WORK_MODE_CBC,
                                    HI_UNF_CIPHER_BIT_WIDTH_64BIT,
                                    HI_UNF_CIPHER_KEY_DES_2KEY,
                                    PVR_S0_KL_AES_L3_TS_2TDES_CBC_CEK_p);
        u32DataLen = (sizeof(Clear_TS_packet_payload) / 8) * 8; //should be aligned to 8 bytes for TDES
        Ret = HI_UNF_CIPHER_Encrypt(hCipherHandle, u32InputAddrPhy, u32OutPutAddrPhy, u32DataLen);
        if (Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("HI_UNF_CIPHER_Encrypt failed! Ret = 0x%x\n", Ret);
            goto OUTPUT_ADDR_PHY_DEL;
        }
        Ret = memcmp(pu8OutputAddrVir, PVR_S0_KL_AES_L3_TS_2TDES_CBC_Encrypted_payload, u32DataLen);        
        break;
    case PVR_S0_KL_AES_L3_TS_2TDES_ECB:
        ConfigR2RKeyladder(3, HI_UNF_ADVCA_ALG_TYPE_AES, PVR_S0_KL_AES_L3_TS_2TDES_ECB_CPAKp, PVR_S0_KL_AES_L3_TS_2TDES_ECB_CPSKp);
        ConfigCipher(hCipherHandle, 
                                    HI_UNF_CIPHER_ALG_3DES,
                                    HI_UNF_CIPHER_WORK_MODE_ECB,
                                    HI_UNF_CIPHER_BIT_WIDTH_64BIT,
                                    HI_UNF_CIPHER_KEY_DES_2KEY,
                                    PVR_S0_KL_AES_L3_TS_2TDES_ECB_CEK_p);
        u32DataLen = (sizeof(Clear_TS_packet_payload) / 8) * 8; //should be aligned to 8 bytes for TDES
        Ret = HI_UNF_CIPHER_Encrypt(hCipherHandle, u32InputAddrPhy, u32OutPutAddrPhy, u32DataLen);
        if (Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("HI_UNF_CIPHER_Encrypt failed! Ret = 0x%x\n", Ret);
            goto OUTPUT_ADDR_PHY_DEL;
        }
        Ret = memcmp(pu8OutputAddrVir, PVR_S0_KL_AES_L3_TS_2TDES_ECB_Encrypted_payload, u32DataLen);        
        break;      
    case PVR_S0_KL_AES_L3_TS_AES_CBC:
        ConfigR2RKeyladder(3, HI_UNF_ADVCA_ALG_TYPE_AES, PVR_S0_KL_AES_L3_TS_AES_CBC_CPAKp, PVR_S0_KL_AES_L3_TS_AES_CBC_CPSKp);
        ConfigCipher(hCipherHandle, 
                                    HI_UNF_CIPHER_ALG_AES,
                                    HI_UNF_CIPHER_WORK_MODE_CBC,
                                    HI_UNF_CIPHER_BIT_WIDTH_128BIT,
                                    HI_UNF_CIPHER_KEY_AES_128BIT,
                                    PVR_S0_KL_AES_L3_TS_AES_CBC_CEK_p);
        u32DataLen = (sizeof(Clear_TS_packet_payload) / 16) * 16; //should be aligned to 16 bytes for AES
        Ret = HI_UNF_CIPHER_Encrypt(hCipherHandle, u32InputAddrPhy, u32OutPutAddrPhy, u32DataLen);
        if (Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("HI_UNF_CIPHER_Encrypt failed! Ret = 0x%x\n", Ret);
            goto OUTPUT_ADDR_PHY_DEL;
        }
        Ret = memcmp(pu8OutputAddrVir, PVR_S0_KL_AES_L3_TS_AES_CBC_Encrypted_payload, u32DataLen);        
        break;       
    case PVR_S0_KL_AES_L3_TS_AES_ECB:
        ConfigR2RKeyladder(3, HI_UNF_ADVCA_ALG_TYPE_AES, PVR_S0_KL_AES_L3_TS_AES_ECB_CPAKp, PVR_S0_KL_AES_L3_TS_AES_ECB_CPSKp);
        ConfigCipher(hCipherHandle, 
                                    HI_UNF_CIPHER_ALG_AES,
                                    HI_UNF_CIPHER_WORK_MODE_ECB,
                                    HI_UNF_CIPHER_BIT_WIDTH_128BIT,
                                    HI_UNF_CIPHER_KEY_AES_128BIT,
                                    PVR_S0_KL_AES_L3_TS_AES_ECB_CEK_p);
        u32DataLen = (sizeof(Clear_TS_packet_payload) / 16) * 16; //should be aligned to 16 bytes for AES
        Ret = HI_UNF_CIPHER_Encrypt(hCipherHandle, u32InputAddrPhy, u32OutPutAddrPhy, u32DataLen);
        if (Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("HI_UNF_CIPHER_Encrypt failed! Ret = 0x%x\n", Ret);
            goto OUTPUT_ADDR_PHY_DEL;
        }
        Ret = memcmp(pu8OutputAddrVir, PVR_S0_KL_AES_L3_TS_AES_ECB_Encrypted_payload, u32DataLen);
        break; 
    default:
        HI_DEBUG_ADVCA("Unknown test case %d\n", enCaseID);
        goto OUTPUT_ADDR_PHY_DEL;
        break;
    }    

    if(Ret == 0)
    {
        HI_DEBUG_ADVCA("\nPVR Test successfully!\n\n");
    }
    else
    {
        HI_DEBUG_ADVCA("\nPVR Test failed!\n\n");
    }

OUTPUT_ADDR_PHY_DEL:
    (HI_VOID)HI_MMZ_Unmap(u32OutPutAddrPhy);
    (HI_VOID)HI_MMZ_Delete(u32OutPutAddrPhy);

INPUT_ADDR_PHY_DEL:
    (HI_VOID)HI_MMZ_Unmap(u32InputAddrPhy);
    (HI_VOID)HI_MMZ_Delete(u32InputAddrPhy);

CIPHER_DESTROY:
    HI_UNF_CIPHER_DestroyHandle(hCipherHandle);

CIPHER_DEINIT:    
    HI_UNF_CIPHER_DeInit();

SYS_DEINIT:
    (HI_VOID)HI_SYS_DeInit();
    return Ret;
}

static HI_S32 CBC_MAC_Test()
{
    HI_S32 Ret = HI_FAILURE;
    HI_UNF_ADVCA_CA_VENDOR_OPT_S stCaVendorOpt;
    HI_U8 u8OutputCbcMac[16];

     (HI_VOID)HI_UNF_CIPHER_Init();
     (HI_VOID)HI_UNF_ADVCA_Init();
     stCaVendorOpt.enCaVendorOpt = HI_UNF_ADVCA_CA_VENDOR_OPT_IRDETO_CBCMAC_CALC;
     stCaVendorOpt.unCaVendorOpt.stIrdetoCbcMac.pu8InputData = HIGH_LEVEL_CODE;
     stCaVendorOpt.unCaVendorOpt.stIrdetoCbcMac.u32InputDataLen = sizeof(HIGH_LEVEL_CODE);
     Ret = HI_UNF_ADVCA_CaVendorOperation(HI_UNF_ADVCA_IRDETO, &stCaVendorOpt);
     if(Ret != HI_SUCCESS)
     {
         HI_DEBUG_ADVCA("HI_UNF_ADVCA_CaVendorOperation failed!\n");
         goto CIPHER_DEINIT;
     }            
     memcpy(u8OutputCbcMac, stCaVendorOpt.unCaVendorOpt.stIrdetoCbcMac.au8OutputCBCMAC, 16);
     if(memcmp(u8OutputCbcMac, CBC_MAC, 16) == 0)
     {
         HI_DEBUG_ADVCA("AES CBC-MAC HIGH-LEVEL CODE AUTHENTICATION successfully!\n");
     }
     else
     {
         HI_DEBUG_ADVCA("AES CBC-MAC HIGH-LEVEL CODE AUTHENTICATION failed!\n");
     }

CIPHER_DEINIT:     
    (HI_VOID)HI_UNF_CIPHER_DeInit();
    (HI_VOID)HI_UNF_ADVCA_DeInit();
    
    return Ret;
}

static HI_S32 Chip_Confiuration_Check()
{
    HI_S32 Ret = HI_FAILURE;
    HI_UNF_ADVCA_CA_VENDOR_OPT_S stCaVendorOpt;
    HI_U8 u8OutputCbcMac[16];
    HI_U8 u8ChipConfBitm[16];
    HI_U32 i;

     (HI_VOID)HI_UNF_CIPHER_Init();
     (HI_VOID)HI_UNF_ADVCA_Init();
     memset(u8ChipConfBitm, 0xff, sizeof(u8ChipConfBitm));
     stCaVendorOpt.enCaVendorOpt = HI_UNF_ADVCA_CA_VENDOR_OPT_IRDETO_CHIP_CONF_CMAC;
     memcpy(stCaVendorOpt.unCaVendorOpt.stIrdetoChipConfCmac.au8ChipConfBitm, u8ChipConfBitm, 16);
     Ret = HI_UNF_ADVCA_CaVendorOperation(HI_UNF_ADVCA_IRDETO, &stCaVendorOpt);
     if(Ret != HI_SUCCESS)
     {
         HI_DEBUG_ADVCA("HI_UNF_ADVCA_CaVendorOperation failed!\n");
         goto CIPHER_DEINIT;
     }            
     memcpy(u8OutputCbcMac, stCaVendorOpt.unCaVendorOpt.stIrdetoChipConfCmac.au8ChipConfCmac, 16);
     for(i = 0; i < 16; i++)
     {
        HI_DEBUG_ADVCA("0x%02x,", u8OutputCbcMac[i]);
     }
     HI_DEBUG_ADVCA("\n");

CIPHER_DEINIT:     
    (HI_VOID)HI_UNF_CIPHER_DeInit();
    (HI_VOID)HI_UNF_ADVCA_DeInit();
    
    return Ret;
}


static HI_S32 AVPLAY_SetCW(HI_HANDLE hKey)
{
    HI_S32 Ret;
    HI_UNF_ADVCA_KEYLADDER_ATTR_S stKeyladderAttr;
    HI_UNF_ADVCA_KEYLADDER_LEV_E enKeyladderLev;
    HI_UNF_ADVCA_CA_VENDOR_OPT_S stCaVendorOpt;

    switch(g_CwType)
    {
    case Clear_CW: //Clear_CW (SST_V2.4.mpg)
        Ret = HI_UNF_DMX_SetDescramblerOddKey(hKey, g_u8ClearOddKey);
        Ret |= HI_UNF_DMX_SetDescramblerEvenKey(hKey, g_u8ClearEvenKey);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_DMX_SetDescramblerKey failed\n");
            return Ret;
        }
        break;
    case CW_8byte_KL_ALG_TDES_KL_Level_2_TS_CSA2: //8byte_CW-KL_ALG_TDES-KL_Level_2-TS_CSA2 (SST_V2.4.mpg)
        Ret = HI_UNF_ADVCA_SetDVBAlg(HI_UNF_ADVCA_ALG_TYPE_TDES);

        /* first level */
        Ret |= HI_UNF_ADVCA_SetDVBSessionKey(HI_UNF_ADVCA_KEYLADDER_LEV1, g_u8TDesEncrptedCwpk);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");            
            return HI_FAILURE;
        }
        Ret = HI_UNF_DMX_SetDescramblerOddKey(hKey, g_u8TDesEncrytedOddKey);
        Ret |= HI_UNF_DMX_SetDescramblerEvenKey(hKey, g_u8TDesEncrytedEvenKey);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_DMX_SetDescramblerEvenKey failed\n");
            return HI_FAILURE;
        }
        break;

    case CW_8byte_KL_ALG_AES_KL_Level_2_TS_CSA2: //8byte_CW-KL_ALG_AES-KL_Level_2-TS_CSA2 (SST_V2.4.mpg)
        Ret = HI_UNF_ADVCA_SetDVBAlg(HI_UNF_ADVCA_ALG_TYPE_AES);
        /* first level */
        Ret |= HI_UNF_ADVCA_SetDVBSessionKey(HI_UNF_ADVCA_KEYLADDER_LEV1, g_u8AesEncrptedCwpk);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");            
            return HI_FAILURE;
        }
        Ret = HI_UNF_DMX_SetDescramblerOddKey(hKey, g_u8AesEncrytedOddKey);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_DMX_SetDescramblerOddKey failed\n");
            return HI_FAILURE;
        }
        
        Ret = HI_UNF_DMX_SetDescramblerEvenKey(hKey, g_u8AesEncrytedEvenKey);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_DMX_SetDescramblerEvenKey failed\n");
            return HI_FAILURE;
        }
        break;

    case CW_16byte_KL_ALG_AES_KL_Level_2_TS_AES_CBC: //16byte_CW-KL_ALG_AES-KL_Level_2-TS_AES_CBC (IRDETO_AES_CBC.ts)

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_SP_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_TRUE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_SP, &stKeyladderAttr);

        Ret = HI_UNF_ADVCA_SetSPAlg(HI_UNF_ADVCA_ALG_TYPE_AES);
        Ret |= HI_UNF_ADVCA_SetSPDscMode(HI_UNF_ADVCA_SP_DSC_MODE_PAYLOAD_AES_CBC_CI);
        Ret |= HI_UNF_DMX_SetDescramblerOddIVKey(hKey, g_u8IV);
        Ret |= HI_UNF_DMX_SetDescramblerEvenIVKey(hKey, g_u8IV);
        /* first level */        
        Ret |= HI_UNF_ADVCA_SetSPSessionKey(HI_UNF_ADVCA_KEYLADDER_LEV1, g_u8AesCbcEncrptedCwpk);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");
            return HI_FAILURE;
        }        
        Ret = HI_UNF_DMX_SetDescramblerOddKey(hKey, g_u8AesCbcEncrytedOddKey);
        Ret |= HI_UNF_DMX_SetDescramblerEvenKey(hKey, g_u8AesCbcEncrytedEvenKey);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_DMX_SetDescramblerEvenKey failed, Ret = 0x%x\n", Ret);
            return HI_FAILURE;        
        }

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_SP_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_FALSE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_SP, &stKeyladderAttr);        
        break;

    case CW_S0_KL_2TDES_L2_TS_AES: //CW_S0_KL-2TDES_L2_TS-AES

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_SP_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_TRUE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_SP, &stKeyladderAttr);

        Ret = HI_UNF_ADVCA_SetSPAlg(HI_UNF_ADVCA_ALG_TYPE_TDES);
        Ret |= HI_UNF_ADVCA_SetSPDscMode(HI_UNF_ADVCA_SP_DSC_MODE_PAYLOAD_AES_CBC_CI);
        Ret |= HI_UNF_DMX_SetDescramblerOddIVKey(hKey, g_u8IV_Zero);
        Ret |= HI_UNF_DMX_SetDescramblerEvenIVKey(hKey, g_u8IV_Zero);
        /* first level */        
        Ret |= HI_UNF_ADVCA_SetSPSessionKey(HI_UNF_ADVCA_KEYLADDER_LEV1, CW_S0_KL_2TDES_L2_TS_AES_CWSKp);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");
            return HI_FAILURE;
        }        
        Ret = HI_UNF_DMX_SetDescramblerOddKey(hKey, CW_S0_KL_2TDES_L2_TS_AES_CEK_p);
        Ret |= HI_UNF_DMX_SetDescramblerEvenKey(hKey, CW_S0_KL_2TDES_L2_TS_AES_CEK_p);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_DMX_SetDescramblerEvenKey failed, Ret = 0x%x\n", Ret);
            return HI_FAILURE; 
        }

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_SP_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_FALSE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_SP, &stKeyladderAttr);        
        break;

    case CW_S0_KL_2TDES_L2_TS_AES_TA: //CW_S0_KL-2TDES_L2_TS-AES_TA

        //set the Tranformation Alg keyladder
        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_TRUE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ALG;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enAlgType = HI_UNF_ADVCA_ALG_TYPE_AES;
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_SESSION_KEY;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enStage = HI_UNF_ADVCA_KEYLADDER_LEV1;
        memcpy(stKeyladderAttr.unKlAttr.stTAKlAttr.au8SessionKey, CW_S0_KL_2TDES_L2_TS_AES_TA_TASKp, 16);
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_LOAD_TRANDATA;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enStage = HI_UNF_ADVCA_KEYLADDER_LEV2;
        stKeyladderAttr.unKlAttr.stTAKlAttr.pu8TranData = CW_S0_KL_2TDES_L2_TS_AES_TA_Transformation_Data;
        stKeyladderAttr.unKlAttr.stTAKlAttr.u32TranDataLen = sizeof(CW_S0_KL_2TDES_L2_TS_AES_TA_Transformation_Data);
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
        if(Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("Set TA keyladder attr, Ret = 0x%x\n", Ret);
            return HI_FAILURE; 
        }

        //set the sp keyladder
        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_SP_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_TRUE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_SP, &stKeyladderAttr);
        
        Ret = HI_UNF_ADVCA_SetSPAlg(HI_UNF_ADVCA_ALG_TYPE_TDES);
        Ret |= HI_UNF_ADVCA_SetSPDscMode(HI_UNF_ADVCA_SP_DSC_MODE_PAYLOAD_AES_CBC_CI);

        //load the IV
        Ret |= HI_UNF_DMX_SetDescramblerOddIVKey(hKey, g_u8IV_Zero);
        Ret |= HI_UNF_DMX_SetDescramblerEvenIVKey(hKey, g_u8IV_Zero);
        
        /* first level */        
        Ret |= HI_UNF_ADVCA_SetSPSessionKey(HI_UNF_ADVCA_KEYLADDER_LEV1, CW_S0_KL_2TDES_L2_TS_AES_TA_CWSKp);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");
            return HI_FAILURE;
        }
        
        Ret = HI_UNF_DMX_SetDescramblerOddKey(hKey, CW_S0_KL_2TDES_L2_TS_AES_TA_CEK_pT);
        Ret |= HI_UNF_DMX_SetDescramblerEvenKey(hKey, CW_S0_KL_2TDES_L2_TS_AES_TA_CEK_pT);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_DMX_SetDescramblerEvenKey failed, Ret = 0x%x\n", Ret);
            return HI_FAILURE;        
        }

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_SP_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_FALSE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_SP, &stKeyladderAttr);        

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_FALSE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
        if(Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("Set TA keyladder attr, Ret = 0x%x\n", Ret);
            return HI_FAILURE; 
        }        
        break;
    case CW_S0_KL_2TDES_L2_TS_CSA: //3.4	CW_S0_KL-2TDES_L2_TS-CSA
        Ret = HI_UNF_ADVCA_SetDVBAlg(HI_UNF_ADVCA_ALG_TYPE_TDES);

        /* first level */
        Ret |= HI_UNF_ADVCA_SetDVBSessionKey(HI_UNF_ADVCA_KEYLADDER_LEV1, CW_S0_KL_2TDES_L2_TS_CSA_CWSKp);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");            
            return HI_FAILURE;
        }
        Ret = HI_UNF_DMX_SetDescramblerOddKey(hKey, CW_S0_KL_2TDES_L2_TS_CSA_CEK_p);
        Ret |= HI_UNF_DMX_SetDescramblerEvenKey(hKey, CW_S0_KL_2TDES_L2_TS_CSA_CEK_p);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_DMX_SetDescramblerEvenKey failed\n");
            return HI_FAILURE;
        }
        break;
    case CW_S0_KL_2TDES_L2_TS_CSA_TA: //3.5	CW_S0_KL-2TDES_L2_TS-CSA_TA

        //set the Tranformation Alg keyladder
        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_TRUE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ALG;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enAlgType = HI_UNF_ADVCA_ALG_TYPE_AES;
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_SESSION_KEY;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enStage = HI_UNF_ADVCA_KEYLADDER_LEV1;
        memcpy(stKeyladderAttr.unKlAttr.stTAKlAttr.au8SessionKey, CW_S0_KL_2TDES_L2_TS_CSA_TA_TASKp, 16);
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_LOAD_TRANDATA;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enStage = HI_UNF_ADVCA_KEYLADDER_LEV2;
        stKeyladderAttr.unKlAttr.stTAKlAttr.pu8TranData = CW_S0_KL_2TDES_L2_TS_CSA_TA_Transformation_Data;
        stKeyladderAttr.unKlAttr.stTAKlAttr.u32TranDataLen = sizeof(CW_S0_KL_2TDES_L2_TS_CSA_TA_Transformation_Data);
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
        if(Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("Set TA keyladder attr, Ret = 0x%x\n", Ret);
            return HI_FAILURE; 
        }

        //set the DVB keyladder
        Ret = HI_UNF_ADVCA_SetDVBAlg(HI_UNF_ADVCA_ALG_TYPE_TDES);

        //load the IV
        Ret |= HI_UNF_DMX_SetDescramblerOddIVKey(hKey, g_u8IV_Zero);
        Ret |= HI_UNF_DMX_SetDescramblerEvenIVKey(hKey, g_u8IV_Zero);
        
        /* first level */        
        Ret |= HI_UNF_ADVCA_SetDVBSessionKey(HI_UNF_ADVCA_KEYLADDER_LEV1, CW_S0_KL_2TDES_L2_TS_CSA_TA_CWSKp);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");
            return HI_FAILURE;
        }
        
        Ret = HI_UNF_DMX_SetDescramblerOddKey(hKey, CW_S0_KL_2TDES_L2_TS_CSA_TA_CEK_pT);
        Ret |= HI_UNF_DMX_SetDescramblerEvenKey(hKey, CW_S0_KL_2TDES_L2_TS_CSA_TA_CEK_pT);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_DMX_SetDescramblerEvenKey failed, Ret = 0x%x\n", Ret);
            return HI_FAILURE;        
        }

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_FALSE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
        if(Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("Set TA keyladder attr, Ret = 0x%x\n", Ret);
            return HI_FAILURE; 
        }        
        break;
    case CW_S0_KL_2TDES_L2_TS_CSA3: //3.6	CW_S0_KL-2TDES_L2_TS-CSA3
        Ret = HI_UNF_ADVCA_SetCSA3Alg(HI_UNF_ADVCA_ALG_TYPE_TDES);

        /* first level */
        Ret |= HI_UNF_ADVCA_SetCSA3SessionKey(HI_UNF_ADVCA_KEYLADDER_LEV1, CW_S0_KL_2TDES_L2_TS_CSA3_CWSKp);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");            
            return HI_FAILURE;
        }
        Ret = HI_UNF_DMX_SetDescramblerOddKey(hKey, CW_S0_KL_2TDES_L2_TS_CSA3_CEK_p);
        Ret |= HI_UNF_DMX_SetDescramblerEvenKey(hKey, CW_S0_KL_2TDES_L2_TS_CSA3_CEK_p);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_DMX_SetDescramblerEvenKey failed\n");
            return HI_FAILURE;
        }      
        break;
    case CW_S0_KL_2TDES_L2_TS_CSA3_TA: //3.7	CW_S0_KL-2TDES_L2_TS-CSA3_TA

        //set the Tranformation Alg keyladder
        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_TRUE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ALG;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enAlgType = HI_UNF_ADVCA_ALG_TYPE_TDES;
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_SESSION_KEY;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enStage = HI_UNF_ADVCA_KEYLADDER_LEV1;
        memcpy(stKeyladderAttr.unKlAttr.stTAKlAttr.au8SessionKey, CW_S0_KL_2TDES_L2_TS_CSA3_TA_TASKp, 16);
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_LOAD_TRANDATA;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enStage = HI_UNF_ADVCA_KEYLADDER_LEV2;
        stKeyladderAttr.unKlAttr.stTAKlAttr.pu8TranData = CW_S0_KL_2TDES_L2_TS_CSA3_TA_Transformation_Data;
        stKeyladderAttr.unKlAttr.stTAKlAttr.u32TranDataLen = sizeof(CW_S0_KL_2TDES_L2_TS_CSA3_TA_Transformation_Data);
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
        if(Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("Set TA keyladder attr, Ret = 0x%x\n", Ret);
            return HI_FAILURE; 
        }

        //set the CSA3 keyladder
        Ret = HI_UNF_ADVCA_SetCSA3Alg(HI_UNF_ADVCA_ALG_TYPE_TDES);

        //load the IV
        Ret |= HI_UNF_DMX_SetDescramblerOddIVKey(hKey, g_u8IV_Zero);
        Ret |= HI_UNF_DMX_SetDescramblerEvenIVKey(hKey, g_u8IV_Zero);
        
        /* first level */        
        Ret |= HI_UNF_ADVCA_SetCSA3SessionKey(HI_UNF_ADVCA_KEYLADDER_LEV1, CW_S0_KL_2TDES_L2_TS_CSA3_TA_CWSKp);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetCSA3SessionKey failed\n");
            return HI_FAILURE;
        }
        
        Ret = HI_UNF_DMX_SetDescramblerOddKey(hKey, CW_S0_KL_2TDES_L2_TS_CSA3_TA_CEK_pT);
        Ret |= HI_UNF_DMX_SetDescramblerEvenKey(hKey, CW_S0_KL_2TDES_L2_TS_CSA3_TA_CEK_pT);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_DMX_SetDescramblerEvenKey failed, Ret = 0x%x\n", Ret);
            return HI_FAILURE;        
        }

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_FALSE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
        if(Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("Set TA keyladder attr, Ret = 0x%x\n", Ret);
            return HI_FAILURE; 
        }        
        break;
    case CW_S0_KL_2TDES_L2_TS_TCSA3: //3.8	CW_S0_KL-2TDES_L2_TS-TCSA3
        Ret = HI_UNF_ADVCA_SetCSA3Alg(HI_UNF_ADVCA_ALG_TYPE_TDES);

        /* first level */
        Ret |= HI_UNF_ADVCA_SetCSA3SessionKey(HI_UNF_ADVCA_KEYLADDER_LEV1, CW_S0_KL_2TDES_L2_TS_TCSA3_CWSKp);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");            
            return HI_FAILURE;
        }

        stCaVendorOpt.enCaVendorOpt = HI_UNF_ADVCA_CA_VENDOR_OPT_IRDETO_ACTIVATION_CODE;
        memcpy(stCaVendorOpt.unCaVendorOpt.stIrdetoCsa3ActCode.au8CSA3ActCode,
            CW_S0_KL_2TDES_L2_TS_TCSA3_ACTIVATION, 16);
        Ret = HI_UNF_ADVCA_CaVendorOperation(HI_UNF_ADVCA_IRDETO, &stCaVendorOpt);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_CaVendorOperation failed\n");            
            return HI_FAILURE;
        }
       
        Ret = HI_UNF_DMX_SetDescramblerOddKey(hKey, CW_S0_KL_2TDES_L2_TS_TCSA3_CEK_p);
        Ret |= HI_UNF_DMX_SetDescramblerEvenKey(hKey, CW_S0_KL_2TDES_L2_TS_TCSA3_CEK_p);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_DMX_SetDescramblerEvenKey failed\n");
            return HI_FAILURE;
        }      
        break;

    case CW_S0_KL_2TDES_L2_TS_TCSA3_TA: //3.9	CW_S0_KL-2TDES_L2_TS-TCSA3_TA

        //set the Tranformation Alg keyladder
        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_TRUE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ALG;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enAlgType = HI_UNF_ADVCA_ALG_TYPE_TDES;
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_SESSION_KEY;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enStage = HI_UNF_ADVCA_KEYLADDER_LEV1;
        memcpy(stKeyladderAttr.unKlAttr.stTAKlAttr.au8SessionKey, CW_S0_KL_2TDES_L2_TS_TCSA3_TA_TASKp, 16);
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_LOAD_TRANDATA;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enStage = HI_UNF_ADVCA_KEYLADDER_LEV2;
        stKeyladderAttr.unKlAttr.stTAKlAttr.pu8TranData = CW_S0_KL_2TDES_L2_TS_TCSA3_TA_Transformation_Data;
        stKeyladderAttr.unKlAttr.stTAKlAttr.u32TranDataLen = sizeof(CW_S0_KL_2TDES_L2_TS_TCSA3_TA_Transformation_Data);
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
        if(Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("Set TA keyladder attr, Ret = 0x%x\n", Ret);
            return HI_FAILURE; 
        }

        //set the CSA3 keyladder
        Ret = HI_UNF_ADVCA_SetCSA3Alg(HI_UNF_ADVCA_ALG_TYPE_TDES);

        //load the IV
        Ret |= HI_UNF_DMX_SetDescramblerOddIVKey(hKey, g_u8IV_Zero);
        Ret |= HI_UNF_DMX_SetDescramblerEvenIVKey(hKey, g_u8IV_Zero);
        
        /* first level */        
        Ret |= HI_UNF_ADVCA_SetCSA3SessionKey(HI_UNF_ADVCA_KEYLADDER_LEV1, CW_S0_KL_2TDES_L2_TS_TCSA3_TA_CWSKp);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetCSA3SessionKey failed\n");
            return HI_FAILURE;
        }

        stCaVendorOpt.enCaVendorOpt = HI_UNF_ADVCA_CA_VENDOR_OPT_IRDETO_ACTIVATION_CODE;
        memcpy(stCaVendorOpt.unCaVendorOpt.stIrdetoCsa3ActCode.au8CSA3ActCode,
            CW_S0_KL_2TDES_L2_TS_TCSA3_TA_ACTIVATION, 16);
        Ret = HI_UNF_ADVCA_CaVendorOperation(HI_UNF_ADVCA_IRDETO, &stCaVendorOpt);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_CaVendorOperation failed\n");            
            return HI_FAILURE;
        }
        
        Ret = HI_UNF_DMX_SetDescramblerOddKey(hKey, CW_S0_KL_2TDES_L2_TS_TCSA3_TA_CEK_pT);
        Ret |= HI_UNF_DMX_SetDescramblerEvenKey(hKey, CW_S0_KL_2TDES_L2_TS_TCSA3_TA_CEK_pT);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_DMX_SetDescramblerEvenKey failed, Ret = 0x%x\n", Ret);
            return HI_FAILURE;        
        }

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_FALSE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
        if(Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("Set TA keyladder attr, Ret = 0x%x\n", Ret);
            return HI_FAILURE; 
        }        
        break;        
    case CW_S0_KL_2TDES_L3_TS_AES: //CW_S0_KL-2TDES_L3_TS-AES

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_SP_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_TRUE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_SP, &stKeyladderAttr);

        (HI_VOID)HI_UNF_ADVCA_GetSPKeyLadderStage(&enKeyladderLev);
        if(enKeyladderLev != HI_UNF_ADVCA_KEYLADDER_LEV3)
        {
            HI_DEBUG_ADVCA("SP keyladder stage is 2, should be 3\n");
            return HI_FAILURE;            
        }
        
        Ret = HI_UNF_ADVCA_SetSPAlg(HI_UNF_ADVCA_ALG_TYPE_TDES);
        Ret |= HI_UNF_ADVCA_SetSPDscMode(HI_UNF_ADVCA_SP_DSC_MODE_PAYLOAD_AES_CBC_CI);
        Ret |= HI_UNF_DMX_SetDescramblerOddIVKey(hKey, g_u8IV_Zero);
        Ret |= HI_UNF_DMX_SetDescramblerEvenIVKey(hKey, g_u8IV_Zero);
        /* first level */        
        Ret |= HI_UNF_ADVCA_SetSPSessionKey(HI_UNF_ADVCA_KEYLADDER_LEV1, CW_S0_KL_2TDES_L3_TS_AES_CWAKp);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");
            return HI_FAILURE;
        }

        Ret |= HI_UNF_ADVCA_SetSPSessionKey(HI_UNF_ADVCA_KEYLADDER_LEV2, CW_S0_KL_2TDES_L3_TS_AES_CWSKp);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");
            return HI_FAILURE;
        }
        
        Ret = HI_UNF_DMX_SetDescramblerOddKey(hKey, CW_S0_KL_2TDES_L3_TS_AES_CEK_p);
        Ret |= HI_UNF_DMX_SetDescramblerEvenKey(hKey, CW_S0_KL_2TDES_L3_TS_AES_CEK_p);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_DMX_SetDescramblerEvenKey failed, Ret = 0x%x\n", Ret);
            return HI_FAILURE; 
        }

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_SP_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_FALSE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_SP, &stKeyladderAttr);        
        break;

    case CW_S0_KL_2TDES_L3_TS_AES_TA: //CW_S0_KL-2TDES_L3_TS-AES_TA

         (HI_VOID)HI_UNF_ADVCA_GetSPKeyLadderStage(&enKeyladderLev);
         if(enKeyladderLev != HI_UNF_ADVCA_KEYLADDER_LEV3)
         {
             HI_DEBUG_ADVCA("SP keyladder stage is 2, should be 3\n");
             return HI_FAILURE;            
         }
    
         //set the Tranformation Alg keyladder
         stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ENABLE;
         stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_TRUE;
         Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
    
         stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ALG;
         stKeyladderAttr.unKlAttr.stTAKlAttr.enAlgType = HI_UNF_ADVCA_ALG_TYPE_AES;
         Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
    
         stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_SESSION_KEY;
         stKeyladderAttr.unKlAttr.stTAKlAttr.enStage = HI_UNF_ADVCA_KEYLADDER_LEV1;
         memcpy(stKeyladderAttr.unKlAttr.stTAKlAttr.au8SessionKey, CW_S0_KL_2TDES_L3_TS_AES_TA_TASKp, 16);
         Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
    
         stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_LOAD_TRANDATA;
         stKeyladderAttr.unKlAttr.stTAKlAttr.enStage = HI_UNF_ADVCA_KEYLADDER_LEV2;
         stKeyladderAttr.unKlAttr.stTAKlAttr.pu8TranData = CW_S0_KL_2TDES_L3_TS_AES_TA_Transformation_Data;
         stKeyladderAttr.unKlAttr.stTAKlAttr.u32TranDataLen = sizeof(CW_S0_KL_2TDES_L3_TS_AES_TA_Transformation_Data);
         Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
         if(Ret != HI_SUCCESS)
         {
             HI_DEBUG_ADVCA("Set TA keyladder attr, Ret = 0x%x\n", Ret);
             return HI_FAILURE; 
         }
    
         //set the sp keyladder
         stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_SP_ATTR_ENABLE;
         stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_TRUE;
         Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_SP, &stKeyladderAttr);
         
         Ret = HI_UNF_ADVCA_SetSPAlg(HI_UNF_ADVCA_ALG_TYPE_TDES);
         Ret |= HI_UNF_ADVCA_SetSPDscMode(HI_UNF_ADVCA_SP_DSC_MODE_PAYLOAD_AES_CBC_CI);
    
         //load the IV
         Ret |= HI_UNF_DMX_SetDescramblerOddIVKey(hKey, g_u8IV_Zero);
         Ret |= HI_UNF_DMX_SetDescramblerEvenIVKey(hKey, g_u8IV_Zero);
         
         /* first level */        
         Ret |= HI_UNF_ADVCA_SetSPSessionKey(HI_UNF_ADVCA_KEYLADDER_LEV1, CW_S0_KL_2TDES_L3_TS_AES_TA_CWAKp);
         if (HI_SUCCESS != Ret)
         {            
             HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");
             return HI_FAILURE;
         }

         Ret |= HI_UNF_ADVCA_SetSPSessionKey(HI_UNF_ADVCA_KEYLADDER_LEV2, CW_S0_KL_2TDES_L3_TS_AES_TA_CWSKp);
         if (HI_SUCCESS != Ret)
         {            
             HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");
             return HI_FAILURE;
         }         
         
         Ret = HI_UNF_DMX_SetDescramblerOddKey(hKey, CW_S0_KL_2TDES_L3_TS_AES_TA_CEK_pT);
         Ret |= HI_UNF_DMX_SetDescramblerEvenKey(hKey, CW_S0_KL_2TDES_L3_TS_AES_TA_CEK_pT);
         if (HI_SUCCESS != Ret)
         {            
             HI_DEBUG_ADVCA("Call HI_UNF_DMX_SetDescramblerEvenKey failed, Ret = 0x%x\n", Ret);
             return HI_FAILURE;        
         }

         stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_SP_ATTR_ENABLE;
         stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_FALSE;
         Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_SP, &stKeyladderAttr);         
    
         stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ENABLE;
         stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_FALSE;
         Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
         if(Ret != HI_SUCCESS)
         {
             HI_DEBUG_ADVCA("Set TA keyladder attr, Ret = 0x%x\n", Ret);
             return HI_FAILURE; 
         }        
         break;

    case CW_S0_KL_2TDES_L3_TS_CSA: //3.12	CW_S0_KL-2TDES_L3_TS-CSA

         (HI_VOID)HI_UNF_ADVCA_GetDVBKeyLadderStage(&enKeyladderLev);
         if(enKeyladderLev != HI_UNF_ADVCA_KEYLADDER_LEV3)
         {
             HI_DEBUG_ADVCA("CSA2 keyladder stage is 2, should be 3\n");
             return HI_FAILURE;            
         }
         
        Ret = HI_UNF_ADVCA_SetDVBAlg(HI_UNF_ADVCA_ALG_TYPE_TDES);

        /* first level */
        Ret |= HI_UNF_ADVCA_SetDVBSessionKey(HI_UNF_ADVCA_KEYLADDER_LEV1, CW_S0_KL_2TDES_L3_TS_CSA_CWAKp);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");            
            return HI_FAILURE;
        }

        Ret |= HI_UNF_ADVCA_SetDVBSessionKey(HI_UNF_ADVCA_KEYLADDER_LEV2, CW_S0_KL_2TDES_L3_TS_CSA_CWSKp);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");            
            return HI_FAILURE;
        }
        
        Ret = HI_UNF_DMX_SetDescramblerOddKey(hKey, CW_S0_KL_2TDES_L3_TS_CSA_CEK_p);
        Ret |= HI_UNF_DMX_SetDescramblerEvenKey(hKey, CW_S0_KL_2TDES_L3_TS_CSA_CEK_p);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_DMX_SetDescramblerEvenKey failed\n");
            return HI_FAILURE;
        }
        break;

    case CW_S0_KL_2TDES_L3_TS_CSA_TA: //3.13	CW_S0_KL-2TDES_L3_TS-CSA_TA

         (HI_VOID)HI_UNF_ADVCA_GetDVBKeyLadderStage(&enKeyladderLev);
         if(enKeyladderLev != HI_UNF_ADVCA_KEYLADDER_LEV3)
         {
             HI_DEBUG_ADVCA("CSA2 keyladder stage is 2, should be 3\n");
             return HI_FAILURE;            
         }

        //set the Tranformation Alg keyladder
        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_TRUE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ALG;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enAlgType = HI_UNF_ADVCA_ALG_TYPE_AES;
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_SESSION_KEY;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enStage = HI_UNF_ADVCA_KEYLADDER_LEV1;
        memcpy(stKeyladderAttr.unKlAttr.stTAKlAttr.au8SessionKey, CW_S0_KL_2TDES_L3_TS_CSA_TA_TASKp, 16);
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_LOAD_TRANDATA;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enStage = HI_UNF_ADVCA_KEYLADDER_LEV2;
        stKeyladderAttr.unKlAttr.stTAKlAttr.pu8TranData = CW_S0_KL_2TDES_L3_TS_CSA_TA_Transformation_Data;
        stKeyladderAttr.unKlAttr.stTAKlAttr.u32TranDataLen = sizeof(CW_S0_KL_2TDES_L3_TS_CSA_TA_Transformation_Data);
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
        if(Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("Set TA keyladder attr, Ret = 0x%x\n", Ret);
            return HI_FAILURE; 
        }

        //set the DVB keyladder
        Ret = HI_UNF_ADVCA_SetDVBAlg(HI_UNF_ADVCA_ALG_TYPE_TDES);

        //load the IV
        Ret |= HI_UNF_DMX_SetDescramblerOddIVKey(hKey, g_u8IV_Zero);
        Ret |= HI_UNF_DMX_SetDescramblerEvenIVKey(hKey, g_u8IV_Zero);
        
        /* first level */        
        Ret |= HI_UNF_ADVCA_SetDVBSessionKey(HI_UNF_ADVCA_KEYLADDER_LEV1, CW_S0_KL_2TDES_L3_TS_CSA_TA_CWAKp);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");
            return HI_FAILURE;
        }

        Ret |= HI_UNF_ADVCA_SetDVBSessionKey(HI_UNF_ADVCA_KEYLADDER_LEV2, CW_S0_KL_2TDES_L3_TS_CSA_TA_CWSKp);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");
            return HI_FAILURE;
        }        
        
        Ret = HI_UNF_DMX_SetDescramblerOddKey(hKey, CW_S0_KL_2TDES_L3_TS_CSA_TA_CEK_pT);
        Ret |= HI_UNF_DMX_SetDescramblerEvenKey(hKey, CW_S0_KL_2TDES_L3_TS_CSA_TA_CEK_pT);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_DMX_SetDescramblerEvenKey failed, Ret = 0x%x\n", Ret);
            return HI_FAILURE;        
        }

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_FALSE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
        if(Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("Set TA keyladder attr, Ret = 0x%x\n", Ret);
            return HI_FAILURE; 
        }        
        break;
        
    case CW_S0_KL_2TDES_L3_TS_CSA3: //3.14	CW_S0_KL-2TDES_L3_TS-CSA3

        (HI_VOID)HI_UNF_ADVCA_GetCSA3KeyLadderStage(&enKeyladderLev);
        if(enKeyladderLev != HI_UNF_ADVCA_KEYLADDER_LEV3)
        {
            HI_DEBUG_ADVCA("CSA3 keyladder stage is 2, should be 3\n");
            return HI_FAILURE;            
        }
    
        Ret = HI_UNF_ADVCA_SetCSA3Alg(HI_UNF_ADVCA_ALG_TYPE_TDES);
    
        /* first level */
        Ret |= HI_UNF_ADVCA_SetCSA3SessionKey(HI_UNF_ADVCA_KEYLADDER_LEV1, CW_S0_KL_2TDES_L3_TS_CSA3_CWAKp);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");            
            return HI_FAILURE;
        }

        Ret |= HI_UNF_ADVCA_SetCSA3SessionKey(HI_UNF_ADVCA_KEYLADDER_LEV2, CW_S0_KL_2TDES_L3_TS_CSA3_CWSKp);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");            
            return HI_FAILURE;
        }
        
        Ret = HI_UNF_DMX_SetDescramblerOddKey(hKey, CW_S0_KL_2TDES_L3_TS_CSA3_CEK_p);
        Ret |= HI_UNF_DMX_SetDescramblerEvenKey(hKey, CW_S0_KL_2TDES_L3_TS_CSA3_CEK_p);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_DMX_SetDescramblerEvenKey failed\n");
            return HI_FAILURE;
        }      
        break;

    case CW_S0_KL_2TDES_L3_TS_CSA3_TA: //3.15	CW_S0_KL-2TDES_L3_TS-CSA3_TA

        (HI_VOID)HI_UNF_ADVCA_GetCSA3KeyLadderStage(&enKeyladderLev);
        if(enKeyladderLev != HI_UNF_ADVCA_KEYLADDER_LEV3)
        {
            HI_DEBUG_ADVCA("CSA3 keyladder stage is 2, should be 3\n");
            return HI_FAILURE;            
        }

        //set the Tranformation Alg keyladder
        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_TRUE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ALG;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enAlgType = HI_UNF_ADVCA_ALG_TYPE_TDES;
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_SESSION_KEY;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enStage = HI_UNF_ADVCA_KEYLADDER_LEV1;
        memcpy(stKeyladderAttr.unKlAttr.stTAKlAttr.au8SessionKey, CW_S0_KL_2TDES_L3_TS_CSA3_TA_TASKp, 16);
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_LOAD_TRANDATA;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enStage = HI_UNF_ADVCA_KEYLADDER_LEV2;
        stKeyladderAttr.unKlAttr.stTAKlAttr.pu8TranData = CW_S0_KL_2TDES_L3_TS_CSA3_TA_Transformation_Data;
        stKeyladderAttr.unKlAttr.stTAKlAttr.u32TranDataLen = sizeof(CW_S0_KL_2TDES_L3_TS_CSA3_TA_Transformation_Data);
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
        if(Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("Set TA keyladder attr, Ret = 0x%x\n", Ret);
            return HI_FAILURE; 
        }

        //set the CSA3 keyladder
        Ret = HI_UNF_ADVCA_SetCSA3Alg(HI_UNF_ADVCA_ALG_TYPE_TDES);

        //load the IV
        Ret |= HI_UNF_DMX_SetDescramblerOddIVKey(hKey, g_u8IV_Zero);
        Ret |= HI_UNF_DMX_SetDescramblerEvenIVKey(hKey, g_u8IV_Zero);
        
        /* first level */        
        Ret |= HI_UNF_ADVCA_SetCSA3SessionKey(HI_UNF_ADVCA_KEYLADDER_LEV1, CW_S0_KL_2TDES_L3_TS_CSA3_TA_CWAKp);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetCSA3SessionKey failed\n");
            return HI_FAILURE;
        }

        Ret |= HI_UNF_ADVCA_SetCSA3SessionKey(HI_UNF_ADVCA_KEYLADDER_LEV2, CW_S0_KL_2TDES_L3_TS_CSA3_TA_CWSKp);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetCSA3SessionKey failed\n");
            return HI_FAILURE;
        }        
        
        Ret = HI_UNF_DMX_SetDescramblerOddKey(hKey, CW_S0_KL_2TDES_L3_TS_CSA3_TA_CEK_pT);
        Ret |= HI_UNF_DMX_SetDescramblerEvenKey(hKey, CW_S0_KL_2TDES_L3_TS_CSA3_TA_CEK_pT);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_DMX_SetDescramblerEvenKey failed, Ret = 0x%x\n", Ret);
            return HI_FAILURE;        
        }

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_FALSE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
        if(Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("Set TA keyladder attr, Ret = 0x%x\n", Ret);
            return HI_FAILURE; 
        }        
        break;
    case CW_S0_KL_2TDES_L3_TS_TCSA3: //3.16	CW_S0_KL-2TDES_L3_TS-TCSA3
    
        (HI_VOID)HI_UNF_ADVCA_GetCSA3KeyLadderStage(&enKeyladderLev);
        if(enKeyladderLev != HI_UNF_ADVCA_KEYLADDER_LEV3)
        {
            HI_DEBUG_ADVCA("CSA3 keyladder stage is 2, should be 3\n");
            return HI_FAILURE;            
        }
    
        Ret = HI_UNF_ADVCA_SetCSA3Alg(HI_UNF_ADVCA_ALG_TYPE_TDES);
    
        /* first level */
        Ret |= HI_UNF_ADVCA_SetCSA3SessionKey(HI_UNF_ADVCA_KEYLADDER_LEV1, CW_S0_KL_2TDES_L3_TS_TCSA3_CWAKp);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");            
            return HI_FAILURE;
        }
    
        Ret |= HI_UNF_ADVCA_SetCSA3SessionKey(HI_UNF_ADVCA_KEYLADDER_LEV2, CW_S0_KL_2TDES_L3_TS_TCSA3_CWSKp);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");            
            return HI_FAILURE;
        }

        stCaVendorOpt.enCaVendorOpt = HI_UNF_ADVCA_CA_VENDOR_OPT_IRDETO_ACTIVATION_CODE;
        memcpy(stCaVendorOpt.unCaVendorOpt.stIrdetoCsa3ActCode.au8CSA3ActCode,
            CW_S0_KL_2TDES_L3_TS_TCSA3_ACTIVATION, 16);
        Ret = HI_UNF_ADVCA_CaVendorOperation(HI_UNF_ADVCA_IRDETO, &stCaVendorOpt);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_CaVendorOperation failed\n");            
            return HI_FAILURE;
        }
        
        Ret = HI_UNF_DMX_SetDescramblerOddKey(hKey, CW_S0_KL_2TDES_L3_TS_TCSA3_CEK_p);
        Ret |= HI_UNF_DMX_SetDescramblerEvenKey(hKey, CW_S0_KL_2TDES_L3_TS_TCSA3_CEK_p);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_DMX_SetDescramblerEvenKey failed\n");
            return HI_FAILURE;
        }      
        break;

    case CW_S0_KL_2TDES_L3_TS_TCSA3_TA: //3.17	CW_S0_KL-2TDES_L3_TS-TCSA3_TA

         (HI_VOID)HI_UNF_ADVCA_GetCSA3KeyLadderStage(&enKeyladderLev);
         if(enKeyladderLev != HI_UNF_ADVCA_KEYLADDER_LEV3)
         {
             HI_DEBUG_ADVCA("CSA3 keyladder stage is 2, should be 3\n");
             return HI_FAILURE;
         }

        //set the Tranformation Alg keyladder
        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_TRUE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ALG;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enAlgType = HI_UNF_ADVCA_ALG_TYPE_TDES;
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_SESSION_KEY;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enStage = HI_UNF_ADVCA_KEYLADDER_LEV1;
        memcpy(stKeyladderAttr.unKlAttr.stTAKlAttr.au8SessionKey, CW_S0_KL_2TDES_L3_TS_TCSA3_TA_TASKp, 16);
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_LOAD_TRANDATA;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enStage = HI_UNF_ADVCA_KEYLADDER_LEV2;
        stKeyladderAttr.unKlAttr.stTAKlAttr.pu8TranData = CW_S0_KL_2TDES_L3_TS_TCSA3_TA_Transformation_Data;
        stKeyladderAttr.unKlAttr.stTAKlAttr.u32TranDataLen = sizeof(CW_S0_KL_2TDES_L3_TS_TCSA3_TA_Transformation_Data);
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
        if(Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("Set TA keyladder attr, Ret = 0x%x\n", Ret);
            return HI_FAILURE; 
        }

        //set the CSA3 keyladder
        Ret = HI_UNF_ADVCA_SetCSA3Alg(HI_UNF_ADVCA_ALG_TYPE_TDES);

        //load the IV
        Ret |= HI_UNF_DMX_SetDescramblerOddIVKey(hKey, g_u8IV_Zero);
        Ret |= HI_UNF_DMX_SetDescramblerEvenIVKey(hKey, g_u8IV_Zero);
        
        /* first level */        
        Ret |= HI_UNF_ADVCA_SetCSA3SessionKey(HI_UNF_ADVCA_KEYLADDER_LEV1, CW_S0_KL_2TDES_L3_TS_TCSA3_TA_CWAKp);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");
            return HI_FAILURE;
        }

        Ret |= HI_UNF_ADVCA_SetCSA3SessionKey(HI_UNF_ADVCA_KEYLADDER_LEV2, CW_S0_KL_2TDES_L3_TS_TCSA3_TA_CWSKp);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");
            return HI_FAILURE;
        }

        stCaVendorOpt.enCaVendorOpt = HI_UNF_ADVCA_CA_VENDOR_OPT_IRDETO_ACTIVATION_CODE;
        memcpy(stCaVendorOpt.unCaVendorOpt.stIrdetoCsa3ActCode.au8CSA3ActCode,
            CW_S0_KL_2TDES_L3_TS_TCSA3_TA_ACTIVATION, 16);
        Ret = HI_UNF_ADVCA_CaVendorOperation(HI_UNF_ADVCA_IRDETO, &stCaVendorOpt);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_CaVendorOperation failed\n");            
            return HI_FAILURE;
        }        
        
        Ret = HI_UNF_DMX_SetDescramblerOddKey(hKey, CW_S0_KL_2TDES_L3_TS_TCSA3_TA_CEK_pT);
        Ret |= HI_UNF_DMX_SetDescramblerEvenKey(hKey, CW_S0_KL_2TDES_L3_TS_TCSA3_TA_CEK_pT);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_DMX_SetDescramblerEvenKey failed, Ret = 0x%x\n", Ret);
            return HI_FAILURE;        
        }

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_FALSE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
        if(Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("Set TA keyladder attr, Ret = 0x%x\n", Ret);
            return HI_FAILURE; 
        }        
        break;       
    case CW_S0_KL_AES_L2_TS_AES: //CW_S0_KL-AES_L2_TS-AES

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_SP_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_TRUE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_SP, &stKeyladderAttr);    

        Ret = HI_UNF_ADVCA_SetSPAlg(HI_UNF_ADVCA_ALG_TYPE_AES);
        Ret |= HI_UNF_ADVCA_SetSPDscMode(HI_UNF_ADVCA_SP_DSC_MODE_PAYLOAD_AES_CBC_CI);
        Ret |= HI_UNF_DMX_SetDescramblerOddIVKey(hKey, g_u8IV_Zero);
        Ret |= HI_UNF_DMX_SetDescramblerEvenIVKey(hKey, g_u8IV_Zero);
        /* first level */        
        Ret |= HI_UNF_ADVCA_SetSPSessionKey(HI_UNF_ADVCA_KEYLADDER_LEV1, CW_S0_KL_AES_L2_TS_AES_CWSKp);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");
            return HI_FAILURE;
        }        
        Ret = HI_UNF_DMX_SetDescramblerOddKey(hKey, CW_S0_KL_AES_L2_TS_AES_CEK_p);
        Ret |= HI_UNF_DMX_SetDescramblerEvenKey(hKey, CW_S0_KL_AES_L2_TS_AES_CEK_p);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_DMX_SetDescramblerEvenKey failed, Ret = 0x%x\n", Ret);
            return HI_FAILURE; 
        }

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_SP_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_FALSE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_SP, &stKeyladderAttr);        
        break;

    case CW_S0_KL_AES_L2_TS_AES_TA: //CW_S0_KL-AES_L2_TS-AES_TA

        //set the Tranformation Alg keyladder
        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_TRUE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ALG;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enAlgType = HI_UNF_ADVCA_ALG_TYPE_AES;
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_SESSION_KEY;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enStage = HI_UNF_ADVCA_KEYLADDER_LEV1;
        memcpy(stKeyladderAttr.unKlAttr.stTAKlAttr.au8SessionKey, CW_S0_KL_AES_L2_TS_AES_TA_TASKp, 16);
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_LOAD_TRANDATA;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enStage = HI_UNF_ADVCA_KEYLADDER_LEV2;
        stKeyladderAttr.unKlAttr.stTAKlAttr.pu8TranData = CW_S0_KL_AES_L2_TS_AES_TA_Transformation_Data;
        stKeyladderAttr.unKlAttr.stTAKlAttr.u32TranDataLen = sizeof(CW_S0_KL_AES_L2_TS_AES_TA_Transformation_Data);
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
        if(Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("Set TA keyladder attr, Ret = 0x%x\n", Ret);
            return HI_FAILURE; 
        }

        //set the sp keyladder
        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_SP_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_TRUE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_SP, &stKeyladderAttr);
        
        Ret = HI_UNF_ADVCA_SetSPAlg(HI_UNF_ADVCA_ALG_TYPE_AES);
        Ret |= HI_UNF_ADVCA_SetSPDscMode(HI_UNF_ADVCA_SP_DSC_MODE_PAYLOAD_AES_CBC_CI);

        //load the IV
        Ret |= HI_UNF_DMX_SetDescramblerOddIVKey(hKey, g_u8IV_Zero);
        Ret |= HI_UNF_DMX_SetDescramblerEvenIVKey(hKey, g_u8IV_Zero);
        
        /* first level */        
        Ret |= HI_UNF_ADVCA_SetSPSessionKey(HI_UNF_ADVCA_KEYLADDER_LEV1, CW_S0_KL_AES_L2_TS_AES_TA_CWSKp);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");
            return HI_FAILURE;
        }
        
        Ret = HI_UNF_DMX_SetDescramblerOddKey(hKey, CW_S0_KL_AES_L2_TS_AES_TA_CEK_pT);
        Ret |= HI_UNF_DMX_SetDescramblerEvenKey(hKey, CW_S0_KL_AES_L2_TS_AES_TA_CEK_pT);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_DMX_SetDescramblerEvenKey failed, Ret = 0x%x\n", Ret);
            return HI_FAILURE;        
        }

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_SP_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_FALSE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_SP, &stKeyladderAttr);        

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_FALSE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
        if(Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("Set TA keyladder attr, Ret = 0x%x\n", Ret);
            return HI_FAILURE; 
        }        
        break;
     case CW_S0_KL_AES_L2_TS_CSA: //3.20	CW_S0_KL-AES_L2_TS-CSA
        Ret = HI_UNF_ADVCA_SetDVBAlg(HI_UNF_ADVCA_ALG_TYPE_AES);

        /* first level */
        Ret |= HI_UNF_ADVCA_SetDVBSessionKey(HI_UNF_ADVCA_KEYLADDER_LEV1, CW_S0_KL_AES_L2_TS_CSA_CWSKp);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");            
            return HI_FAILURE;
        }
        Ret = HI_UNF_DMX_SetDescramblerOddKey(hKey, CW_S0_KL_AES_L2_TS_CSA_CEK_p);
        Ret |= HI_UNF_DMX_SetDescramblerEvenKey(hKey, CW_S0_KL_AES_L2_TS_CSA_CEK_p);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_DMX_SetDescramblerEvenKey failed\n");
            return HI_FAILURE;
        }
        break;       
    case CW_S0_KL_AES_L2_TS_CSA_TA: //3.21	CW_S0_KL-AES_L2_TS-CSA_TA
    
        //set the Tranformation Alg keyladder
        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_TRUE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
    
        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ALG;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enAlgType = HI_UNF_ADVCA_ALG_TYPE_AES;
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
    
        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_SESSION_KEY;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enStage = HI_UNF_ADVCA_KEYLADDER_LEV1;
        memcpy(stKeyladderAttr.unKlAttr.stTAKlAttr.au8SessionKey, CW_S0_KL_AES_L2_TS_CSA_TA_TASKp, 16);
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
    
        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_LOAD_TRANDATA;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enStage = HI_UNF_ADVCA_KEYLADDER_LEV2;
        stKeyladderAttr.unKlAttr.stTAKlAttr.pu8TranData = CW_S0_KL_AES_L2_TS_CSA_TA_Transformation_Data;
        stKeyladderAttr.unKlAttr.stTAKlAttr.u32TranDataLen = sizeof(CW_S0_KL_AES_L2_TS_CSA_TA_Transformation_Data);
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
        if(Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("Set TA keyladder attr, Ret = 0x%x\n", Ret);
            return HI_FAILURE; 
        }
    
        //set the DVB keyladder
        Ret = HI_UNF_ADVCA_SetDVBAlg(HI_UNF_ADVCA_ALG_TYPE_TDES);
    
        //load the IV
        Ret |= HI_UNF_DMX_SetDescramblerOddIVKey(hKey, g_u8IV_Zero);
        Ret |= HI_UNF_DMX_SetDescramblerEvenIVKey(hKey, g_u8IV_Zero);
        
        /* first level */        
        Ret |= HI_UNF_ADVCA_SetDVBSessionKey(HI_UNF_ADVCA_KEYLADDER_LEV1, CW_S0_KL_AES_L2_TS_CSA_TA_CWSKp);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");
            return HI_FAILURE;
        }
        
        Ret = HI_UNF_DMX_SetDescramblerOddKey(hKey, CW_S0_KL_AES_L2_TS_CSA_TA_CEK_pT);
        Ret |= HI_UNF_DMX_SetDescramblerEvenKey(hKey, CW_S0_KL_AES_L2_TS_CSA_TA_CEK_pT);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_DMX_SetDescramblerEvenKey failed, Ret = 0x%x\n", Ret);
            return HI_FAILURE;        
        }
    
        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_FALSE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
        if(Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("Set TA keyladder attr, Ret = 0x%x\n", Ret);
            return HI_FAILURE; 
        }        
        break;
    case CW_S0_KL_AES_L2_TS_CSA3: //3.22	CW_S0_KL-AES_L2_TS-CSA3
        Ret = HI_UNF_ADVCA_SetCSA3Alg(HI_UNF_ADVCA_ALG_TYPE_AES);
    
        /* first level */
        Ret |= HI_UNF_ADVCA_SetCSA3SessionKey(HI_UNF_ADVCA_KEYLADDER_LEV1, CW_S0_KL_AES_L2_TS_CSA3_CWSKp);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");            
            return HI_FAILURE;
        }
        Ret = HI_UNF_DMX_SetDescramblerOddKey(hKey, CW_S0_KL_AES_L2_TS_CSA3_CEK_p);
        Ret |= HI_UNF_DMX_SetDescramblerEvenKey(hKey, CW_S0_KL_AES_L2_TS_CSA3_CEK_p);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_DMX_SetDescramblerEvenKey failed\n");
            return HI_FAILURE;
        }      
        break;
    case CW_S0_KL_AES_L2_TS_CSA3_TA: //3.23	CW_S0_KL-AES_L2_TS-CSA3_TA
    
        //set the Tranformation Alg keyladder
        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_TRUE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
    
        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ALG;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enAlgType = HI_UNF_ADVCA_ALG_TYPE_TDES;
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
    
        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_SESSION_KEY;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enStage = HI_UNF_ADVCA_KEYLADDER_LEV1;
        memcpy(stKeyladderAttr.unKlAttr.stTAKlAttr.au8SessionKey, CW_S0_KL_AES_L2_TS_CSA3_TA_TASKp, 16);
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
    
        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_LOAD_TRANDATA;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enStage = HI_UNF_ADVCA_KEYLADDER_LEV2;
        stKeyladderAttr.unKlAttr.stTAKlAttr.pu8TranData = CW_S0_KL_AES_L2_TS_CSA3_TA_Transformation_Data;
        stKeyladderAttr.unKlAttr.stTAKlAttr.u32TranDataLen = sizeof(CW_S0_KL_AES_L2_TS_CSA3_TA_Transformation_Data);
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
        if(Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("Set TA keyladder attr, Ret = 0x%x\n", Ret);
            return HI_FAILURE; 
        }
    
        //set the CSA3 keyladder
        Ret = HI_UNF_ADVCA_SetCSA3Alg(HI_UNF_ADVCA_ALG_TYPE_AES);
    
        //load the IV
        Ret |= HI_UNF_DMX_SetDescramblerOddIVKey(hKey, g_u8IV_Zero);
        Ret |= HI_UNF_DMX_SetDescramblerEvenIVKey(hKey, g_u8IV_Zero);
        
        /* first level */        
        Ret |= HI_UNF_ADVCA_SetCSA3SessionKey(HI_UNF_ADVCA_KEYLADDER_LEV1, CW_S0_KL_AES_L2_TS_CSA3_TA_CWSKp);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetCSA3SessionKey failed\n");
            return HI_FAILURE;
        }
        
        Ret = HI_UNF_DMX_SetDescramblerOddKey(hKey, CW_S0_KL_AES_L2_TS_CSA3_TA_CEK_pT);
        Ret |= HI_UNF_DMX_SetDescramblerEvenKey(hKey, CW_S0_KL_AES_L2_TS_CSA3_TA_CEK_pT);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_DMX_SetDescramblerEvenKey failed, Ret = 0x%x\n", Ret);
            return HI_FAILURE;        
        }
    
        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_FALSE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
        if(Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("Set TA keyladder attr, Ret = 0x%x\n", Ret);
            return HI_FAILURE; 
        }        
        break;
    case CW_S0_KL_AES_L2_TS_TCSA3: //3.24	CW_S0_KL-AES_L2_TS-TCSA3
        Ret = HI_UNF_ADVCA_SetCSA3Alg(HI_UNF_ADVCA_ALG_TYPE_AES);
    
        /* first level */
        Ret |= HI_UNF_ADVCA_SetCSA3SessionKey(HI_UNF_ADVCA_KEYLADDER_LEV1, CW_S0_KL_AES_L2_TS_TCSA3_CWSKp);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");            
            return HI_FAILURE;
        }
    
        stCaVendorOpt.enCaVendorOpt = HI_UNF_ADVCA_CA_VENDOR_OPT_IRDETO_ACTIVATION_CODE;
        memcpy(stCaVendorOpt.unCaVendorOpt.stIrdetoCsa3ActCode.au8CSA3ActCode,
            CW_S0_KL_AES_L2_TS_TCSA3_ACTIVATION, 16);
        Ret = HI_UNF_ADVCA_CaVendorOperation(HI_UNF_ADVCA_IRDETO, &stCaVendorOpt);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_CaVendorOperation failed\n");            
            return HI_FAILURE;
        }
       
        Ret = HI_UNF_DMX_SetDescramblerOddKey(hKey, CW_S0_KL_AES_L2_TS_TCSA3_CEK_p);
        Ret |= HI_UNF_DMX_SetDescramblerEvenKey(hKey, CW_S0_KL_AES_L2_TS_TCSA3_CEK_p);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_DMX_SetDescramblerEvenKey failed\n");
            return HI_FAILURE;
        }      
        break;
    case CW_S0_KL_AES_L2_TS_TCSA3_TA: //3.25	CW_S0_KL-AES_L2_TS-TCSA3_TA
    
        //set the Tranformation Alg keyladder
        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_TRUE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
    
        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ALG;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enAlgType = HI_UNF_ADVCA_ALG_TYPE_TDES;
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
    
        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_SESSION_KEY;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enStage = HI_UNF_ADVCA_KEYLADDER_LEV1;
        memcpy(stKeyladderAttr.unKlAttr.stTAKlAttr.au8SessionKey, CW_S0_KL_AES_L2_TS_TCSA3_TA_TASKp, 16);
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
    
        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_LOAD_TRANDATA;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enStage = HI_UNF_ADVCA_KEYLADDER_LEV2;
        stKeyladderAttr.unKlAttr.stTAKlAttr.pu8TranData = CW_S0_KL_AES_L2_TS_TCSA3_TA_Transformation_Data;
        stKeyladderAttr.unKlAttr.stTAKlAttr.u32TranDataLen = sizeof(CW_S0_KL_AES_L2_TS_TCSA3_TA_Transformation_Data);
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
        if(Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("Set TA keyladder attr, Ret = 0x%x\n", Ret);
            return HI_FAILURE; 
        }
    
        //set the CSA3 keyladder
        Ret = HI_UNF_ADVCA_SetCSA3Alg(HI_UNF_ADVCA_ALG_TYPE_AES);
    
        //load the IV
        Ret |= HI_UNF_DMX_SetDescramblerOddIVKey(hKey, g_u8IV_Zero);
        Ret |= HI_UNF_DMX_SetDescramblerEvenIVKey(hKey, g_u8IV_Zero);
        
        /* first level */        
        Ret |= HI_UNF_ADVCA_SetCSA3SessionKey(HI_UNF_ADVCA_KEYLADDER_LEV1, CW_S0_KL_AES_L2_TS_TCSA3_TA_CWSKp);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetCSA3SessionKey failed\n");
            return HI_FAILURE;
        }
    
        stCaVendorOpt.enCaVendorOpt = HI_UNF_ADVCA_CA_VENDOR_OPT_IRDETO_ACTIVATION_CODE;
        memcpy(stCaVendorOpt.unCaVendorOpt.stIrdetoCsa3ActCode.au8CSA3ActCode,
            CW_S0_KL_AES_L2_TS_TCSA3_TA_ACTIVATION, 16);
        Ret = HI_UNF_ADVCA_CaVendorOperation(HI_UNF_ADVCA_IRDETO, &stCaVendorOpt);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_CaVendorOperation failed\n");            
            return HI_FAILURE;
        }
        
        Ret = HI_UNF_DMX_SetDescramblerOddKey(hKey, CW_S0_KL_AES_L2_TS_TCSA3_TA_CEK_pT);
        Ret |= HI_UNF_DMX_SetDescramblerEvenKey(hKey, CW_S0_KL_AES_L2_TS_TCSA3_TA_CEK_pT);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_DMX_SetDescramblerEvenKey failed, Ret = 0x%x\n", Ret);
            return HI_FAILURE;        
        }
    
        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_FALSE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
        if(Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("Set TA keyladder attr, Ret = 0x%x\n", Ret);
            return HI_FAILURE; 
        }        
        break;
    case CW_S0_KL_AES_L3_TS_AES: //CW_S0_KL-AES_L3_TS-AES

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_SP_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_TRUE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_SP, &stKeyladderAttr);
    
        (HI_VOID)HI_UNF_ADVCA_GetSPKeyLadderStage(&enKeyladderLev);
        if(enKeyladderLev != HI_UNF_ADVCA_KEYLADDER_LEV3)
        {
            HI_DEBUG_ADVCA("SP keyladder stage is 2, should be 3\n");
            return HI_FAILURE;            
        }
        
        Ret = HI_UNF_ADVCA_SetSPAlg(HI_UNF_ADVCA_ALG_TYPE_AES);
        Ret |= HI_UNF_ADVCA_SetSPDscMode(HI_UNF_ADVCA_SP_DSC_MODE_PAYLOAD_AES_CBC_CI);
        Ret |= HI_UNF_DMX_SetDescramblerOddIVKey(hKey, g_u8IV_Zero);
        Ret |= HI_UNF_DMX_SetDescramblerEvenIVKey(hKey, g_u8IV_Zero);
        /* first level */        
        Ret |= HI_UNF_ADVCA_SetSPSessionKey(HI_UNF_ADVCA_KEYLADDER_LEV1, CW_S0_KL_AES_L3_TS_AES_CWAKp);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");
            return HI_FAILURE;
        }
    
        Ret |= HI_UNF_ADVCA_SetSPSessionKey(HI_UNF_ADVCA_KEYLADDER_LEV2, CW_S0_KL_AES_L3_TS_AES_CWSKp);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");
            return HI_FAILURE;
        }
        
        Ret = HI_UNF_DMX_SetDescramblerOddKey(hKey, CW_S0_KL_AES_L3_TS_AES_CEK_p);
        Ret |= HI_UNF_DMX_SetDescramblerEvenKey(hKey, CW_S0_KL_AES_L3_TS_AES_CEK_p);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_DMX_SetDescramblerEvenKey failed, Ret = 0x%x\n", Ret);
            return HI_FAILURE; 
        }

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_SP_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_FALSE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_SP, &stKeyladderAttr);        
        break;
    case CW_S0_KL_AES_L3_TS_AES_TA://3.27	CW_S0_KL-AES_L3_TS-AES_TA
        (HI_VOID)HI_UNF_ADVCA_GetSPKeyLadderStage(&enKeyladderLev);
        if(enKeyladderLev != HI_UNF_ADVCA_KEYLADDER_LEV3)
        {
            HI_DEBUG_ADVCA("SP keyladder stage is 2, should be 3\n");
            return HI_FAILURE;            
        }
        
        //set the Tranformation Alg keyladder
        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_TRUE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
        
        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ALG;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enAlgType = HI_UNF_ADVCA_ALG_TYPE_AES;
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
        
        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_SESSION_KEY;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enStage = HI_UNF_ADVCA_KEYLADDER_LEV1;
        memcpy(stKeyladderAttr.unKlAttr.stTAKlAttr.au8SessionKey, CW_S0_KL_AES_L3_TS_AES_TA_TASKp, 16);
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
        
        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_LOAD_TRANDATA;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enStage = HI_UNF_ADVCA_KEYLADDER_LEV2;
        stKeyladderAttr.unKlAttr.stTAKlAttr.pu8TranData = CW_S0_KL_AES_L3_TS_AES_TA_Transformation_Data;
        stKeyladderAttr.unKlAttr.stTAKlAttr.u32TranDataLen = sizeof(CW_S0_KL_AES_L3_TS_AES_TA_Transformation_Data);
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
        if(Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("Set TA keyladder attr, Ret = 0x%x\n", Ret);
            return HI_FAILURE; 
        }
        
        //set the sp keyladder
        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_SP_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_TRUE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_SP, &stKeyladderAttr);
        
        Ret = HI_UNF_ADVCA_SetSPAlg(HI_UNF_ADVCA_ALG_TYPE_AES);
        Ret |= HI_UNF_ADVCA_SetSPDscMode(HI_UNF_ADVCA_SP_DSC_MODE_PAYLOAD_AES_CBC_CI);
        
        //load the IV
        Ret |= HI_UNF_DMX_SetDescramblerOddIVKey(hKey, g_u8IV_Zero);
        Ret |= HI_UNF_DMX_SetDescramblerEvenIVKey(hKey, g_u8IV_Zero);
        
        /* first level */        
        Ret |= HI_UNF_ADVCA_SetSPSessionKey(HI_UNF_ADVCA_KEYLADDER_LEV1, CW_S0_KL_AES_L3_TS_AES_TA_CWAKp);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");
            return HI_FAILURE;
        }
        
        Ret |= HI_UNF_ADVCA_SetSPSessionKey(HI_UNF_ADVCA_KEYLADDER_LEV2, CW_S0_KL_AES_L3_TS_AES_TA_CWSKp);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");
            return HI_FAILURE;
        }         
        
        Ret = HI_UNF_DMX_SetDescramblerOddKey(hKey, CW_S0_KL_AES_L3_TS_AES_TA_CEK_pT);
        Ret |= HI_UNF_DMX_SetDescramblerEvenKey(hKey, CW_S0_KL_AES_L3_TS_AES_TA_CEK_pT);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_DMX_SetDescramblerEvenKey failed, Ret = 0x%x\n", Ret);
            return HI_FAILURE;        
        }

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_SP_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_FALSE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_SP, &stKeyladderAttr);        
        
        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_FALSE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
        if(Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("Set TA keyladder attr, Ret = 0x%x\n", Ret);
            return HI_FAILURE; 
        }        
        break;
    case CW_S0_KL_AES_L3_TS_CSA://3.28	CW_S0_KL-AES_L3_TS-CSA
        (HI_VOID)HI_UNF_ADVCA_GetDVBKeyLadderStage(&enKeyladderLev);
         if(enKeyladderLev != HI_UNF_ADVCA_KEYLADDER_LEV3)
         {
             HI_DEBUG_ADVCA("CSA2 keyladder stage is 2, should be 3\n");
             return HI_FAILURE;            
         }
         
        Ret = HI_UNF_ADVCA_SetDVBAlg(HI_UNF_ADVCA_ALG_TYPE_AES);

        /* first level */
        Ret |= HI_UNF_ADVCA_SetDVBSessionKey(HI_UNF_ADVCA_KEYLADDER_LEV1, CW_S0_KL_AES_L3_TS_CSA_CWAKp);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");            
            return HI_FAILURE;
        }

        Ret |= HI_UNF_ADVCA_SetDVBSessionKey(HI_UNF_ADVCA_KEYLADDER_LEV2, CW_S0_KL_AES_L3_TS_CSA_CWSKp);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");            
            return HI_FAILURE;
        }
        
        Ret = HI_UNF_DMX_SetDescramblerOddKey(hKey, CW_S0_KL_AES_L3_TS_CSA_CEK_p);
        Ret |= HI_UNF_DMX_SetDescramblerEvenKey(hKey, CW_S0_KL_AES_L3_TS_CSA_CEK_p);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_DMX_SetDescramblerEvenKey failed\n");
            return HI_FAILURE;
        }
        break;
    
    case CW_S0_KL_AES_L3_TS_CSA_TA:////3.29	CW_S0_KL-AES_L3_TS-CSA_TA
       (HI_VOID)HI_UNF_ADVCA_GetDVBKeyLadderStage(&enKeyladderLev);
         if(enKeyladderLev != HI_UNF_ADVCA_KEYLADDER_LEV3)
         {
             HI_DEBUG_ADVCA("CSA2 keyladder stage is 2, should be 3\n");
             return HI_FAILURE;            
         }

        //set the Tranformation Alg keyladder
        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_TRUE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ALG;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enAlgType = HI_UNF_ADVCA_ALG_TYPE_AES;
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_SESSION_KEY;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enStage = HI_UNF_ADVCA_KEYLADDER_LEV1;
        memcpy(stKeyladderAttr.unKlAttr.stTAKlAttr.au8SessionKey, CW_S0_KL_AES_L3_TS_CSA_TA_TASKp, 16);
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_LOAD_TRANDATA;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enStage = HI_UNF_ADVCA_KEYLADDER_LEV2;
        stKeyladderAttr.unKlAttr.stTAKlAttr.pu8TranData = CW_S0_KL_AES_L3_TS_CSA_TA_Transformation_Data;
        stKeyladderAttr.unKlAttr.stTAKlAttr.u32TranDataLen = sizeof(CW_S0_KL_AES_L3_TS_CSA_TA_Transformation_Data);
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
        if(Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("Set TA keyladder attr, Ret = 0x%x\n", Ret);
            return HI_FAILURE; 
        }

        //set the DVB keyladder
        Ret = HI_UNF_ADVCA_SetDVBAlg(HI_UNF_ADVCA_ALG_TYPE_AES);

        //load the IV
        Ret |= HI_UNF_DMX_SetDescramblerOddIVKey(hKey, g_u8IV_Zero);
        Ret |= HI_UNF_DMX_SetDescramblerEvenIVKey(hKey, g_u8IV_Zero);
        
        /* first level */        
        Ret |= HI_UNF_ADVCA_SetDVBSessionKey(HI_UNF_ADVCA_KEYLADDER_LEV1, CW_S0_KL_AES_L3_TS_CSA_TA_CWAKp);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");
            return HI_FAILURE;
        }

        Ret |= HI_UNF_ADVCA_SetDVBSessionKey(HI_UNF_ADVCA_KEYLADDER_LEV2, CW_S0_KL_AES_L3_TS_CSA_TA_CWSKp);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");
            return HI_FAILURE;
        }        
        
        Ret = HI_UNF_DMX_SetDescramblerOddKey(hKey, CW_S0_KL_AES_L3_TS_CSA_TA_CEK_pT);
        Ret |= HI_UNF_DMX_SetDescramblerEvenKey(hKey, CW_S0_KL_AES_L3_TS_CSA_TA_CEK_pT);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_DMX_SetDescramblerEvenKey failed, Ret = 0x%x\n", Ret);
            return HI_FAILURE;        
        }

        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_FALSE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
        if(Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("Set TA keyladder attr, Ret = 0x%x\n", Ret);
            return HI_FAILURE; 
        }        
        break;
    case CW_S0_KL_AES_L3_TS_CSA3: //3.30 CW_S0_KL-AES_L3_TS-CSA3
    
        (HI_VOID)HI_UNF_ADVCA_GetCSA3KeyLadderStage(&enKeyladderLev);
        if(enKeyladderLev != HI_UNF_ADVCA_KEYLADDER_LEV3)
        {
            HI_DEBUG_ADVCA("CSA3 keyladder stage is 2, should be 3\n");
            return HI_FAILURE;            
        }
    
        Ret = HI_UNF_ADVCA_SetCSA3Alg(HI_UNF_ADVCA_ALG_TYPE_AES);
    
        /* first level */
        Ret |= HI_UNF_ADVCA_SetCSA3SessionKey(HI_UNF_ADVCA_KEYLADDER_LEV1, CW_S0_KL_AES_L3_TS_CSA3_CWAKp);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");            
            return HI_FAILURE;
        }
    
        Ret |= HI_UNF_ADVCA_SetCSA3SessionKey(HI_UNF_ADVCA_KEYLADDER_LEV2, CW_S0_KL_AES_L3_TS_CSA3_CWSKp);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");            
            return HI_FAILURE;
        }
        
        Ret = HI_UNF_DMX_SetDescramblerOddKey(hKey, CW_S0_KL_AES_L3_TS_CSA3_CEK_p);
        Ret |= HI_UNF_DMX_SetDescramblerEvenKey(hKey, CW_S0_KL_AES_L3_TS_CSA3_CEK_p);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_DMX_SetDescramblerEvenKey failed\n");
            return HI_FAILURE;
        }      
        break;
    
    case CW_S0_KL_AES_L3_TS_CSA3_TA: //3.31 CW_S0_KL-AES_L3_TS-CSA3_TA
    
        (HI_VOID)HI_UNF_ADVCA_GetCSA3KeyLadderStage(&enKeyladderLev);
        if(enKeyladderLev != HI_UNF_ADVCA_KEYLADDER_LEV3)
        {
            HI_DEBUG_ADVCA("CSA3 keyladder stage is 2, should be 3\n");
            return HI_FAILURE;            
        }
    
        //set the Tranformation Alg keyladder
        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_TRUE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
    
        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ALG;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enAlgType = HI_UNF_ADVCA_ALG_TYPE_AES;
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
    
        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_SESSION_KEY;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enStage = HI_UNF_ADVCA_KEYLADDER_LEV1;
        memcpy(stKeyladderAttr.unKlAttr.stTAKlAttr.au8SessionKey, CW_S0_KL_AES_L3_TS_CSA3_TA_TASKp, 16);
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
    
        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_LOAD_TRANDATA;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enStage = HI_UNF_ADVCA_KEYLADDER_LEV2;
        stKeyladderAttr.unKlAttr.stTAKlAttr.pu8TranData = CW_S0_KL_AES_L3_TS_CSA3_TA_Transformation_Data;
        stKeyladderAttr.unKlAttr.stTAKlAttr.u32TranDataLen = sizeof(CW_S0_KL_AES_L3_TS_CSA3_TA_Transformation_Data);
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
        if(Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("Set TA keyladder attr, Ret = 0x%x\n", Ret);
            return HI_FAILURE; 
        }
    
        //set the CSA3 keyladder
        Ret = HI_UNF_ADVCA_SetCSA3Alg(HI_UNF_ADVCA_ALG_TYPE_AES);
    
        //load the IV
        Ret |= HI_UNF_DMX_SetDescramblerOddIVKey(hKey, g_u8IV_Zero);
        Ret |= HI_UNF_DMX_SetDescramblerEvenIVKey(hKey, g_u8IV_Zero);
        
        /* first level */        
        Ret |= HI_UNF_ADVCA_SetCSA3SessionKey(HI_UNF_ADVCA_KEYLADDER_LEV1, CW_S0_KL_AES_L3_TS_CSA3_TA_CWAKp);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetCSA3SessionKey failed\n");
            return HI_FAILURE;
        }
    
        Ret |= HI_UNF_ADVCA_SetCSA3SessionKey(HI_UNF_ADVCA_KEYLADDER_LEV2, CW_S0_KL_AES_L3_TS_CSA3_TA_CWSKp);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetCSA3SessionKey failed\n");
            return HI_FAILURE;
        }        
        
        Ret = HI_UNF_DMX_SetDescramblerOddKey(hKey, CW_S0_KL_AES_L3_TS_CSA3_TA_CEK_pT);
        Ret |= HI_UNF_DMX_SetDescramblerEvenKey(hKey, CW_S0_KL_AES_L3_TS_CSA3_TA_CEK_pT);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_DMX_SetDescramblerEvenKey failed, Ret = 0x%x\n", Ret);
            return HI_FAILURE;        
        }
    
        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_FALSE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
        if(Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("Set TA keyladder attr, Ret = 0x%x\n", Ret);
            return HI_FAILURE; 
        }        
        break;
    case CW_S0_KL_AES_L3_TS_TCSA3: //3.32 CW_S0_KL-AES_L3_TS-TCSA3
    
        (HI_VOID)HI_UNF_ADVCA_GetCSA3KeyLadderStage(&enKeyladderLev);
        if(enKeyladderLev != HI_UNF_ADVCA_KEYLADDER_LEV3)
        {
            HI_DEBUG_ADVCA("CSA3 keyladder stage is 2, should be 3\n");
            return HI_FAILURE;            
        }
    
        Ret = HI_UNF_ADVCA_SetCSA3Alg(HI_UNF_ADVCA_ALG_TYPE_AES);
    
        /* first level */
        Ret |= HI_UNF_ADVCA_SetCSA3SessionKey(HI_UNF_ADVCA_KEYLADDER_LEV1, CW_S0_KL_AES_L3_TS_TCSA3_CWAKp);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");            
            return HI_FAILURE;
        }
    
        Ret |= HI_UNF_ADVCA_SetCSA3SessionKey(HI_UNF_ADVCA_KEYLADDER_LEV2, CW_S0_KL_AES_L3_TS_TCSA3_CWSKp);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");            
            return HI_FAILURE;
        }
    
        stCaVendorOpt.enCaVendorOpt = HI_UNF_ADVCA_CA_VENDOR_OPT_IRDETO_ACTIVATION_CODE;
        memcpy(stCaVendorOpt.unCaVendorOpt.stIrdetoCsa3ActCode.au8CSA3ActCode,
            CW_S0_KL_AES_L3_TS_TCSA3_ACTIVATION, 16);
        Ret = HI_UNF_ADVCA_CaVendorOperation(HI_UNF_ADVCA_IRDETO, &stCaVendorOpt);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_CaVendorOperation failed\n");            
            return HI_FAILURE;
        }
        
        Ret = HI_UNF_DMX_SetDescramblerOddKey(hKey, CW_S0_KL_AES_L3_TS_TCSA3_CEK_p);
        Ret |= HI_UNF_DMX_SetDescramblerEvenKey(hKey, CW_S0_KL_AES_L3_TS_TCSA3_CEK_p);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_DMX_SetDescramblerEvenKey failed\n");
            return HI_FAILURE;
        }      
        break;
    
    case CW_S0_KL_AES_L3_TS_TCSA3_TA: //3.33 CW_S0_KL-AES_L3_TS-TCSA3_TA
    
         (HI_VOID)HI_UNF_ADVCA_GetCSA3KeyLadderStage(&enKeyladderLev);
         if(enKeyladderLev != HI_UNF_ADVCA_KEYLADDER_LEV3)
         {
             HI_DEBUG_ADVCA("CSA3 keyladder stage is 2, should be 3\n");
             return HI_FAILURE;
         }
    
        //set the Tranformation Alg keyladder
        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_TRUE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
    
        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ALG;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enAlgType = HI_UNF_ADVCA_ALG_TYPE_AES;
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
    
        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_SESSION_KEY;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enStage = HI_UNF_ADVCA_KEYLADDER_LEV1;
        memcpy(stKeyladderAttr.unKlAttr.stTAKlAttr.au8SessionKey, CW_S0_KL_AES_L3_TS_TCSA3_TA_TASKp, 16);
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
    
        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_LOAD_TRANDATA;
        stKeyladderAttr.unKlAttr.stTAKlAttr.enStage = HI_UNF_ADVCA_KEYLADDER_LEV2;
        stKeyladderAttr.unKlAttr.stTAKlAttr.pu8TranData = CW_S0_KL_AES_L3_TS_TCSA3_TA_Transformation_Data;
        stKeyladderAttr.unKlAttr.stTAKlAttr.u32TranDataLen = sizeof(CW_S0_KL_AES_L3_TS_TCSA3_TA_Transformation_Data);
        Ret |= HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
        if(Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("Set TA keyladder attr, Ret = 0x%x\n", Ret);
            return HI_FAILURE; 
        }
    
        //set the CSA3 keyladder
        Ret = HI_UNF_ADVCA_SetCSA3Alg(HI_UNF_ADVCA_ALG_TYPE_AES);
    
        //load the IV
        Ret |= HI_UNF_DMX_SetDescramblerOddIVKey(hKey, g_u8IV_Zero);
        Ret |= HI_UNF_DMX_SetDescramblerEvenIVKey(hKey, g_u8IV_Zero);
        
        /* first level */        
        Ret |= HI_UNF_ADVCA_SetCSA3SessionKey(HI_UNF_ADVCA_KEYLADDER_LEV1, CW_S0_KL_AES_L3_TS_TCSA3_TA_CWAKp);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");
            return HI_FAILURE;
        }
    
        Ret |= HI_UNF_ADVCA_SetCSA3SessionKey(HI_UNF_ADVCA_KEYLADDER_LEV2, CW_S0_KL_AES_L3_TS_TCSA3_TA_CWSKp);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_SetDVBSessionKey failed\n");
            return HI_FAILURE;
        }
    
        stCaVendorOpt.enCaVendorOpt = HI_UNF_ADVCA_CA_VENDOR_OPT_IRDETO_ACTIVATION_CODE;
        memcpy(stCaVendorOpt.unCaVendorOpt.stIrdetoCsa3ActCode.au8CSA3ActCode,
            CW_S0_KL_AES_L3_TS_TCSA3_TA_ACTIVATION, 16);
        Ret = HI_UNF_ADVCA_CaVendorOperation(HI_UNF_ADVCA_IRDETO, &stCaVendorOpt);
        if (HI_SUCCESS != Ret)
        {
            HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_CaVendorOperation failed\n");            
            return HI_FAILURE;
        }        
        
        Ret = HI_UNF_DMX_SetDescramblerOddKey(hKey, CW_S0_KL_AES_L3_TS_TCSA3_TA_CEK_pT);
        Ret |= HI_UNF_DMX_SetDescramblerEvenKey(hKey, CW_S0_KL_AES_L3_TS_TCSA3_TA_CEK_pT);
        if (HI_SUCCESS != Ret)
        {            
            HI_DEBUG_ADVCA("Call HI_UNF_DMX_SetDescramblerEvenKey failed, Ret = 0x%x\n", Ret);
            return HI_FAILURE;        
        }
    
        stKeyladderAttr.unKlAttr.stTAKlAttr.enTAKlAttr = HI_UNF_ADVCA_KEYLADDER_TA_ATTR_ENABLE;
        stKeyladderAttr.unKlAttr.stTAKlAttr.bEnable = HI_FALSE;
        Ret = HI_UNF_ADVCA_SetKeyLadderAttr(HI_UNF_ADVCA_KEYLADDER_TA, &stKeyladderAttr);
        if(Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("Set TA keyladder attr, Ret = 0x%x\n", Ret);
            return HI_FAILURE; 
        }        
        break;
    default:
        break;
    }
    
    return HI_SUCCESS;
}

static HI_VOID *PlayTsTthread(HI_VOID *args)
{
    HI_UNF_STREAM_BUF_S   StreamBuf;
    HI_U32            Readlen;
    HI_S32            Ret;

    while (!g_bStopTsThread)
    {
        pthread_mutex_lock(&g_TsMutex);
        Ret = HI_UNF_DMX_GetTSBuffer(g_TsBuf, 188*50, &StreamBuf, 1000);
        if (Ret != HI_SUCCESS )
        {
            pthread_mutex_unlock(&g_TsMutex);
            continue;
        }

        switch(g_CwType)
        {
        case Clear_CW: //0: Clear_CW (SST_V2.4.mpg)
        case CW_8byte_KL_ALG_TDES_KL_Level_2_TS_CSA2: //1: 8byte_CW-KL_ALG_TDES-KL_Level_2-TS_CSA2 (SST_V2.4.mpg)
        case CW_8byte_KL_ALG_AES_KL_Level_2_TS_CSA2: //2: 8byte_CW-KL_ALG_AES-KL_Level_2-TS_CSA2 (SST_V2.4.mpg)
        case CW_16byte_KL_ALG_AES_KL_Level_2_TS_AES_CBC: //3: 16byte_CW-KL_ALG_AES-KL_Level_2-TS_AES_CBC (IRDETO_AES_CBC.ts)
            Readlen = fread(StreamBuf.pu8Data, sizeof(HI_S8), 188*50, g_pTsFile);
            if(Readlen <= 0)
            {
                rewind(g_pTsFile);
                pthread_mutex_unlock(&g_TsMutex);
                continue;
            }
            break;

        case CW_S0_KL_2TDES_L2_TS_AES: //3.2   CW_S0_KL-2TDES_L2_TS-AES
            Readlen = 188;
            memcpy(StreamBuf.pu8Data, Org_CW_S0_KL_2TDES_L2_TS_AES, 188);
            break;
        case CW_S0_KL_2TDES_L2_TS_AES_TA: //3.3	CW_S0_KL-2TDES_L2_TS-AES_TA
            Readlen = 188;
            memcpy(StreamBuf.pu8Data, Org_CW_S0_KL_2TDES_L2_TS_AES_TA, 188);
            break;
        case CW_S0_KL_2TDES_L2_TS_CSA: //3.4	CW_S0_KL-2TDES_L2_TS-CSA
            Readlen = 188;
            memcpy(StreamBuf.pu8Data, Org_CW_S0_KL_2TDES_L2_TS_CSA, 188);
            break;
        case CW_S0_KL_2TDES_L2_TS_CSA_TA: //3.5	CW_S0_KL-2TDES_L2_TS-CSA_TA
            Readlen = 188;
            memcpy(StreamBuf.pu8Data, Org_CW_S0_KL_2TDES_L2_TS_CSA_TA, 188);
            break;
        case CW_S0_KL_2TDES_L2_TS_CSA3: //3.6	CW_S0_KL-2TDES_L2_TS-CSA3
            Readlen = 188;
            memcpy(StreamBuf.pu8Data, Org_CW_S0_KL_2TDES_L2_TS_CSA3, 188);
            break;
        case CW_S0_KL_2TDES_L2_TS_CSA3_TA: //3.7	CW_S0_KL-2TDES_L2_TS-CSA3_TA
            Readlen = 188;
            memcpy(StreamBuf.pu8Data, Org_CW_S0_KL_2TDES_L2_TS_CSA3_TA, 188);
            break;
        case CW_S0_KL_2TDES_L2_TS_TCSA3: //3.8	CW_S0_KL-2TDES_L2_TS-TCSA3
            Readlen = 188;
            memcpy(StreamBuf.pu8Data, Org_CW_S0_KL_2TDES_L2_TS_TCSA3, 188);
            break;
        case CW_S0_KL_2TDES_L2_TS_TCSA3_TA: //3.9	CW_S0_KL-2TDES_L2_TS-TCSA3_TA
            Readlen = 188;
            memcpy(StreamBuf.pu8Data, Org_CW_S0_KL_2TDES_L2_TS_TCSA3_TA, 188);
            break;
        case CW_S0_KL_2TDES_L3_TS_AES: //3.10	CW_S0_KL-2TDES_L3_TS-AES
            Readlen = 188;
            memcpy(StreamBuf.pu8Data, Org_CW_S0_KL_2TDES_L3_TS_AES, 188);
            break;
        case CW_S0_KL_2TDES_L3_TS_AES_TA: //3.11	CW_S0_KL-2TDES_L3_TS-AES_TA
            Readlen = 188;
            memcpy(StreamBuf.pu8Data, Org_CW_S0_KL_2TDES_L3_TS_AES_TA, 188);
            break;
        case CW_S0_KL_2TDES_L3_TS_CSA: //3.12	CW_S0_KL-2TDES_L3_TS-CSA
            Readlen = 188;
            memcpy(StreamBuf.pu8Data, Org_CW_S0_KL_2TDES_L3_TS_CSA, 188);
            break;
        case CW_S0_KL_2TDES_L3_TS_CSA_TA: //3.13	CW_S0_KL-2TDES_L3_TS-CSA_TA
            Readlen = 188;
            memcpy(StreamBuf.pu8Data, Org_CW_S0_KL_2TDES_L3_TS_CSA_TA, 188);
            break;
        case CW_S0_KL_2TDES_L3_TS_CSA3: //3.14	CW_S0_KL-2TDES_L3_TS-CSA3
            Readlen = 188;
            memcpy(StreamBuf.pu8Data, Org_CW_S0_KL_2TDES_L3_TS_CSA3, 188);
            break;
        case CW_S0_KL_2TDES_L3_TS_CSA3_TA: //3.15	CW_S0_KL-2TDES_L3_TS-CSA3_TA
            Readlen = 188;
            memcpy(StreamBuf.pu8Data, Org_CW_S0_KL_2TDES_L3_TS_CSA3_TA, 188);
            break;
        case CW_S0_KL_2TDES_L3_TS_TCSA3: //3.16	CW_S0_KL-2TDES_L3_TS-TCSA3
            Readlen = 188;
            memcpy(StreamBuf.pu8Data, Org_CW_S0_KL_2TDES_L3_TS_TCSA3, 188);
            break;
        case CW_S0_KL_2TDES_L3_TS_TCSA3_TA: //3.17	CW_S0_KL-2TDES_L3_TS-TCSA3_TA
            Readlen = 188;
            memcpy(StreamBuf.pu8Data, Org_CW_S0_KL_2TDES_L3_TS_TCSA3_TA, 188);
            break; 
        case CW_S0_KL_AES_L2_TS_AES: //3.18	CW_S0_KL-AES_L2_TS-AES
            Readlen = 188;
            memcpy(StreamBuf.pu8Data, Org_CW_S0_KL_AES_L2_TS_AES, 188);
            break;
        case CW_S0_KL_AES_L2_TS_AES_TA: //3.19	CW_S0_KL-AES_L2_TS-AES_TA
            Readlen = 188;
            memcpy(StreamBuf.pu8Data, Org_CW_S0_KL_AES_L2_TS_AES_TA, 188);
            break;
        case CW_S0_KL_AES_L2_TS_CSA: //3.20	CW_S0_KL-AES_L2_TS-CSA
            Readlen = 188;
            memcpy(StreamBuf.pu8Data, Org_CW_S0_KL_AES_L2_TS_CSA, 188);
            break;  
        case CW_S0_KL_AES_L2_TS_CSA_TA: //3.21	CW_S0_KL-AES_L2_TS-CSA_TA
            Readlen = 188;
            memcpy(StreamBuf.pu8Data, Org_CW_S0_KL_AES_L2_TS_CSA_TA, 188);
            break;
        case CW_S0_KL_AES_L2_TS_CSA3: //3.22	CW_S0_KL-AES_L2_TS-CSA3
            Readlen = 188;
            memcpy(StreamBuf.pu8Data, Org_CW_S0_KL_AES_L2_TS_CSA3, 188);
            break;
        case CW_S0_KL_AES_L2_TS_CSA3_TA: //3.23	CW_S0_KL-AES_L2_TS-CSA3_TA
            Readlen = 188;
            memcpy(StreamBuf.pu8Data, Org_CW_S0_KL_AES_L2_TS_CSA3_TA, 188);
            break;
        case CW_S0_KL_AES_L2_TS_TCSA3: //3.24	CW_S0_KL-AES_L2_TS-TCSA3
            Readlen = 188;
            memcpy(StreamBuf.pu8Data, Org_CW_S0_KL_AES_L2_TS_TCSA3, 188);
            break;
        case CW_S0_KL_AES_L2_TS_TCSA3_TA: //3.25	CW_S0_KL-AES_L2_TS-TCSA3_TA
            Readlen = 188;
            memcpy(StreamBuf.pu8Data, Org_CW_S0_KL_AES_L2_TS_TCSA3_TA, 188);
            break; 
        case CW_S0_KL_AES_L3_TS_AES: //3.26	CW_S0_KL-AES_L3_TS-AES
            Readlen = 188;
            memcpy(StreamBuf.pu8Data, Org_CW_S0_KL_AES_L3_TS_AES, 188);
            break; 
        case CW_S0_KL_AES_L3_TS_AES_TA: //3.27	CW_S0_KL-AES_L3_TS-AES_TA
            Readlen = 188;
            memcpy(StreamBuf.pu8Data, Org_CW_S0_KL_AES_L3_TS_AES_TA, 188);
            break;  
        case CW_S0_KL_AES_L3_TS_CSA: //3.28	CW_S0_KL-AES_L3_TS-CSA
            Readlen = 188;
            memcpy(StreamBuf.pu8Data, Org_CW_S0_KL_AES_L3_TS_CSA, 188);
            break; 
        case CW_S0_KL_AES_L3_TS_CSA_TA: //3.29	CW_S0_KL-AES_L3_TS-CSA_TA
            Readlen = 188;
            memcpy(StreamBuf.pu8Data, Org_CW_S0_KL_AES_L3_TS_CSA_TA, 188);
            break;
        case CW_S0_KL_AES_L3_TS_CSA3: //3.30	CW_S0_KL-AES_L3_TS-CSA3
            Readlen = 188;
            memcpy(StreamBuf.pu8Data, Org_CW_S0_KL_AES_L3_TS_CSA3, 188);
            break; 
        case CW_S0_KL_AES_L3_TS_CSA3_TA: //3.31	CW_S0_KL-AES_L3_TS-CSA3_TA
            Readlen = 188;
            memcpy(StreamBuf.pu8Data, Org_CW_S0_KL_AES_L3_TS_CSA3_TA, 188);
            break;
        case CW_S0_KL_AES_L3_TS_TCSA3: //3.32	CW_S0_KL-AES_L3_TS-TCSA3
            Readlen = 188;
            memcpy(StreamBuf.pu8Data, Org_CW_S0_KL_AES_L3_TS_TCSA3, 188);
            break; 
        case CW_S0_KL_AES_L3_TS_TCSA3_TA: //3.33	CW_S0_KL-AES_L3_TS-TCSA3_TA
            Readlen = 188;
            memcpy(StreamBuf.pu8Data, Org_CW_S0_KL_AES_L3_TS_TCSA3_TA, 188);
            break;            

        default:
            Readlen = 0;
            break;
        }

        Ret = HI_UNF_DMX_PutTSBuffer(g_TsBuf, Readlen);
        if (Ret != HI_SUCCESS )
        {
            HI_DEBUG_ADVCA("call HI_UNF_DMX_PutTSBuffer failed.\n");
        }
        
        pthread_mutex_unlock(&g_TsMutex);
    }

    Ret = HI_UNF_DMX_ResetTSBuffer(g_TsBuf);
    if (Ret != HI_SUCCESS )
    {
        HI_DEBUG_ADVCA("call HI_UNF_DMX_ResetTSBuffer failed.\n");
    }

    return HI_NULL;
}

static HI_S32 AVPLAY_TS(HI_ADVCA_IRDETO_MSR2_2_CASE_ID enCaseID)
{
    HI_S32  Ret;
    HI_HANDLE   hWin;
    HI_HANDLE   hAvplay;
    HI_HANDLE   hKey;
    HI_UNF_AVPLAY_ATTR_S    AvplayAttr;
    HI_UNF_SYNC_ATTR_S  SyncAttr;
    HI_UNF_AVPLAY_STOP_OPT_S    Stop;
    HI_CHAR InputCmd[32];
    HI_UNF_ENC_FMT_E   enFormat = HI_UNF_ENC_FMT_1080i_50;
    HI_U32  ProgNum;
    HI_HANDLE   hTrack;
    HI_UNF_AUDIOTRACK_ATTR_S    stTrackAttr;
    HI_CHAR cUserInput[512];
#ifdef __HI3716MV310__	
    HI_UNF_MIXER_ATTR_S stMixerAttr;
#endif


    HI_DEBUG_ADVCA("\nPlease input the test stream path:");
    scanf("%s", cUserInput);
    
    g_pTsFile = fopen(cUserInput, "rb");
    if (g_pTsFile == NULL)
    {
        HI_DEBUG_ADVCA("Open file %s error!\n", cUserInput);
        return HI_FAILURE;
    }
    g_CwType = enCaseID; //CW type is equaled to the case ID

    (HI_VOID)HI_SYS_Init();
#ifndef __HI3716MV310__
    HIADP_MCE_Exit();
#endif
    Ret = HI_UNF_ADVCA_Init();
    if (HI_SUCCESS != Ret)
    {
        HI_DEBUG_ADVCA("Call HI_UNF_ADVCA_Init failed, Ret = 0x%x\n", Ret);
        goto SYS_DEINIT;
    }

    Ret = HIADP_Snd_Init();
    if (HI_SUCCESS != Ret)
    {
        HI_DEBUG_ADVCA("Call SndInit failed, Ret = 0x%x\n", Ret);
        goto CA_DEINIT;
    }

    Ret = HIADP_Disp_Init(enFormat);
    if (HI_SUCCESS != Ret)
    {
        HI_DEBUG_ADVCA("Call HIADP_Disp_Init failed, Ret = 0x%x\n", Ret);
        goto SND_DEINIT;
    }

    Ret = HIADP_VO_Init(HI_UNF_VO_DEV_MODE_NORMAL);
    Ret |= HIADP_VO_CreatWin(HI_NULL,&hWin);
    if (HI_SUCCESS != Ret)
    {
        HI_DEBUG_ADVCA("Call VoInit failed, Ret = 0x%x\n", Ret);
        (HI_VOID)HIADP_VO_DeInit();
        goto DISP_DEINIT;
    }

    Ret = HI_UNF_DMX_Init();
#ifdef __HI3716MV310__
    Ret = HI_UNF_DMX_AttachTSPort(PLAY_DMX_ID,HI_UNF_DMX_PORT_3_RAM);
#else
    Ret = HI_UNF_DMX_AttachTSPort(PLAY_DMX_ID,HI_UNF_DMX_PORT_RAM_0);
#endif
    if (HI_SUCCESS != Ret)
    {
        HI_DEBUG_ADVCA("Call VoInit failed, Ret = 0x%x\n", Ret);
        goto VO_DEINIT;
    }
#ifdef __HI3716MV310__
    Ret = HI_UNF_DMX_AttachTSPort(1,HI_UNF_DMX_PORT_3_RAM);
#else
    Ret = HI_UNF_DMX_AttachTSPort(1,HI_UNF_DMX_PORT_RAM_0);
#endif
    if (HI_SUCCESS != Ret)
    {
        HI_DEBUG_ADVCA("Call VoInit failed, Ret = 0x%x\n", Ret);
        goto VO_DEINIT;
    }
#ifdef __HI3716MV310__
    Ret = HI_UNF_DMX_CreateTSBuffer(HI_UNF_DMX_PORT_3_RAM, 0x200000, &g_TsBuf);
#else
    Ret = HI_UNF_DMX_CreateTSBuffer(HI_UNF_DMX_PORT_RAM_0, 0x200000, &g_TsBuf);
#endif
    if (Ret != HI_SUCCESS)
    {
        HI_DEBUG_ADVCA("Call HI_UNF_DMX_CreateTSBuffer failed, Ret = 0x%x\n", Ret);
        goto DMX_DEINIT;
    }

    Ret = HIADP_AVPlay_RegADecLib();
    if (HI_SUCCESS != Ret)
    {
        HI_DEBUG_ADVCA("Call RegADecLib failed, Ret = 0x%x\n", Ret);
        goto TSBUF_FREE;
    }

    Ret = HI_UNF_AVPLAY_Init();
    if (Ret != HI_SUCCESS)
    {
        HI_DEBUG_ADVCA("Call HI_UNF_AVPLAY_Init failed, Ret = 0x%x\n", Ret);
        goto DMX_DEINIT;
    }

    Ret = HI_UNF_AVPLAY_GetDefaultConfig(&AvplayAttr, HI_UNF_AVPLAY_STREAM_TYPE_TS);
    Ret |= HI_UNF_AVPLAY_Create(&AvplayAttr, &hAvplay);
    if (Ret != HI_SUCCESS)
    {
        HI_DEBUG_ADVCA("Call HI_UNF_AVPLAY_Create failed, Ret = 0x%x\n", Ret);
        goto AVPLAY_DEINIT;
    }

    Ret = HI_UNF_AVPLAY_ChnOpen(hAvplay, HI_UNF_AVPLAY_MEDIA_CHAN_VID, HI_NULL);
    if (Ret != HI_SUCCESS)
    {
        HI_DEBUG_ADVCA("Call HI_UNF_AVPLAY_ChnOpen failed, Ret = 0x%x\n", Ret);
        goto AVPLAY_DESTROY;
    }

    Ret = HI_UNF_AVPLAY_ChnOpen(hAvplay, HI_UNF_AVPLAY_MEDIA_CHAN_AUD, HI_NULL);
    if (Ret != HI_SUCCESS)
    {
        HI_DEBUG_ADVCA("Call HI_UNF_AVPLAY_ChnOpen failed, Ret = 0x%x\n", Ret);
        goto VCHN_CLOSE;
    }

    Ret = AVPLAY_AttachDescramble(hAvplay,&hKey);
    if (HI_SUCCESS != Ret)
    {
        HI_DEBUG_ADVCA("Call AVPLAY_AttachDescramble failed, Ret = 0x%x\n", Ret);
        goto ACHN_CLOSE;
    }

    Ret = HI_UNF_VO_AttachWindow(hWin, hAvplay);
    Ret |= HI_UNF_VO_SetWindowEnable(hWin, HI_TRUE);
    if (Ret != HI_SUCCESS)
    {
        HI_DEBUG_ADVCA("Call HI_UNF_VO_SetWindowEnable failed, Ret = 0x%x\n", Ret);
        goto WIN_DETACH;
    }
#ifndef __HI3716MV310__
    Ret = HI_UNF_SND_GetDefaultTrackAttr(HI_UNF_SND_TRACK_TYPE_MASTER, &stTrackAttr);
    if (Ret != HI_SUCCESS)
    {
        printf("Call HI_UNF_SND_GetDefaultTrackAttr failed, Ret = 0x%x\n", Ret);
        goto WIN_DETACH;
    }
    //Ret = HI_UNF_SND_Mixer_Open(HI_UNF_SND_0, &hTrack, &stMixerAttr);
    Ret = HI_UNF_SND_CreateTrack(HI_UNF_SND_0, &stTrackAttr, &hTrack);
    if (Ret != HI_SUCCESS)
    {
        printf("Call HI_UNF_SND_CreateTrack failed, Ret = 0x%x\n", Ret);
        goto WIN_DETACH;
    }
#endif

#ifdef __HI3716MV310__
    Ret = HI_UNF_SND_Attach(HI_UNF_SND_0, hAvplay, HI_UNF_SND_MIX_TYPE_MASTER, 100);
#else
    Ret = HI_UNF_SND_Attach(hTrack, hAvplay);
#endif
    if (Ret != HI_SUCCESS)
    {
        HI_DEBUG_ADVCA("Call HI_SND_Attach failed, Ret = 0x%x\n", Ret);
        goto TRACK_DESTROY;
    }
    
    Ret = HI_UNF_AVPLAY_GetAttr(hAvplay, HI_UNF_AVPLAY_ATTR_ID_SYNC, &SyncAttr);
    SyncAttr.enSyncRef = HI_UNF_SYNC_REF_NONE;
    Ret |= HI_UNF_AVPLAY_SetAttr(hAvplay, HI_UNF_AVPLAY_ATTR_ID_SYNC, &SyncAttr);
    if (Ret != HI_SUCCESS)
    {
        HI_DEBUG_ADVCA("Call HI_UNF_AVPLAY_SetAttr failed, Ret = 0x%x\n", Ret);
        goto SND_DETACH;
    }

    (HI_VOID)pthread_mutex_init(&g_TsMutex,NULL);
    g_bStopTsThread = HI_FALSE;
    (HI_VOID)pthread_create(&g_TsThd, HI_NULL, PlayTsTthread, HI_NULL);

    HIADP_Search_Init();
    Ret = HIADP_Search_GetAllPmt(0, &g_pProgTbl);
    if (Ret != HI_SUCCESS)
    {
        HI_DEBUG_ADVCA("Call HIADP_Search_GetAllPmt failed, Ret = 0x%x\n", Ret);
        goto PSISI_FREE;
    }
    
    ProgNum = 0;
    pthread_mutex_lock(&g_TsMutex);
    rewind(g_pTsFile);
    (HI_VOID)HI_UNF_DMX_ResetTSBuffer(g_TsBuf);
    pthread_mutex_unlock(&g_TsMutex);
    Ret = AVPLAY_SetCW(hKey);

    Ret |= HIADP_AVPlay_PlayProg(hAvplay, g_pProgTbl, ProgNum, HI_TRUE);
    if (Ret != HI_SUCCESS)
    {
        HI_DEBUG_ADVCA("Call SwitchProg failed, Ret = 0x%x\n", Ret);
        goto AVPLAY_STOP;
    }

    while(1)
    {
        HI_DEBUG_ADVCA("Please input 'q' to quit!\n");
        memset(InputCmd, 0, 30);
        (HI_VOID)fgets(InputCmd, 30, stdin);
        if ('q' == InputCmd[0])
        {
            break;
        }

        ProgNum = atoi(InputCmd);
        if (ProgNum == 0)
        {
            ProgNum = 1;
        }

        pthread_mutex_lock(&g_TsMutex);
        rewind(g_pTsFile);
        (HI_VOID)HI_UNF_DMX_ResetTSBuffer(g_TsBuf);
        pthread_mutex_unlock(&g_TsMutex);
        Ret = AVPLAY_SetCW(hKey);

        Ret |= HIADP_AVPlay_PlayProg(hAvplay,g_pProgTbl,ProgNum-1,HI_TRUE);
        if (Ret != HI_SUCCESS)
        {
            HI_DEBUG_ADVCA("Call SwitchProgfailed, Ret = 0x%x\n", Ret);
            break;
        }
    }

AVPLAY_STOP:
    Stop.enMode = HI_UNF_AVPLAY_STOP_MODE_BLACK;
    Stop.u32TimeoutMs = 0;
    (HI_VOID)HI_UNF_AVPLAY_Stop(hAvplay, HI_UNF_AVPLAY_MEDIA_CHAN_VID | HI_UNF_AVPLAY_MEDIA_CHAN_AUD, &Stop);

PSISI_FREE:
    HIADP_Search_DeInit();

    g_bStopTsThread = HI_TRUE;
    (HI_VOID)pthread_join(g_TsThd, HI_NULL);
    (HI_VOID)pthread_mutex_destroy(&g_TsMutex);

SND_DETACH:
    (HI_VOID)HI_UNF_SND_Detach(HI_UNF_SND_0, hAvplay);

TRACK_DESTROY:
#ifdef __HI3716MV310__	
    HI_UNF_SND_Mixer_Close(hTrack);
#else
    HI_UNF_SND_DestroyTrack(hTrack);
#endif
    
WIN_DETACH:
    (HI_VOID)HI_UNF_VO_SetWindowEnable(hWin,HI_FALSE);
    (HI_VOID)HI_UNF_VO_DetachWindow(hWin, hAvplay);

    (HI_VOID)AVPLAY_DetachDescramble(hAvplay,hKey);

ACHN_CLOSE:
    (HI_VOID)HI_UNF_AVPLAY_ChnClose(hAvplay, HI_UNF_AVPLAY_MEDIA_CHAN_AUD);

VCHN_CLOSE:
    (HI_VOID)HI_UNF_AVPLAY_ChnClose(hAvplay, HI_UNF_AVPLAY_MEDIA_CHAN_VID);

AVPLAY_DESTROY:
    (HI_VOID)HI_UNF_AVPLAY_Destroy(hAvplay);
    
AVPLAY_DEINIT:
    (HI_VOID)HI_UNF_AVPLAY_DeInit();

TSBUF_FREE:
    (HI_VOID)HI_UNF_DMX_DestroyTSBuffer(g_TsBuf);
    
DMX_DEINIT:
    (HI_VOID)HI_UNF_DMX_DetachTSPort(0);
    (HI_VOID)HI_UNF_DMX_DeInit();

VO_DEINIT:
    (HI_VOID)HI_UNF_VO_DestroyWindow(hWin);
    (HI_VOID)HIADP_VO_DeInit();

DISP_DEINIT:
    (HI_VOID)HIADP_Disp_DeInit();

SND_DEINIT:
    (HI_VOID)HIADP_Snd_DeInit();

CA_DEINIT:
    (HI_VOID)HI_UNF_ADVCA_DeInit();

SYS_DEINIT:
    (HI_VOID)HI_SYS_DeInit();
    (HI_VOID)fclose(g_pTsFile);
    g_pTsFile = HI_NULL;

    return Ret;        
}

static HI_S32 AVPLAY_AttachDescramble(HI_HANDLE hAvplay,HI_HANDLE *phKey)
{
    HI_S32 Ret;
    HI_UNF_DMX_DESCRAMBLER_ATTR_S stDesramblerAttr;
    HI_HANDLE hKey;
    HI_HANDLE hDmxVidChn,hDmxAudChn;

    memset(&stDesramblerAttr,0,sizeof(HI_UNF_DMX_DESCRAMBLER_ATTR_S));
    if (Clear_CW == g_CwType)
    {
        stDesramblerAttr.enCaType = HI_UNF_DMX_CA_NORMAL;
    }
    else
    {        
        stDesramblerAttr.enCaType = HI_UNF_DMX_CA_ADVANCE;
    }

    if(CW_16byte_KL_ALG_AES_KL_Level_2_TS_AES_CBC == g_CwType) //AES CBC encrypted stream
    {
        stDesramblerAttr.enDescramblerType = HI_UNF_DMX_DESCRAMBLER_TYPE_AES_CI;
    }
    else
    {
        stDesramblerAttr.enDescramblerType = HI_UNF_DMX_DESCRAMBLER_TYPE_CSA2;
    }
    stDesramblerAttr.enEntropyReduction = HI_UNF_DMX_CA_ENTROPY_REDUCTION_CLOSE;
    Ret = HI_UNF_DMX_CreateDescramblerExt(0,&stDesramblerAttr,&hKey);
    if (HI_SUCCESS != Ret)
    {
        HI_DEBUG_ADVCA("Call HI_UNF_DMX_CreateDescramblerExt failed %#x\n",Ret);
        return HI_FAILURE;
    }

    Ret = HI_UNF_AVPLAY_GetDmxVidChnHandle(hAvplay,&hDmxVidChn);
    Ret |= HI_UNF_AVPLAY_GetDmxAudChnHandle(hAvplay,&hDmxAudChn);
    Ret = HI_UNF_DMX_AttachDescrambler(hKey,hDmxVidChn);
    if (HI_SUCCESS != Ret)
    {
        HI_DEBUG_ADVCA("Call HI_UNF_DMX_AttachDescrambler hDmxVidChn failed\n");        
        (HI_VOID)HI_UNF_DMX_DestroyDescrambler(hKey);
        return HI_FAILURE;
    }

    Ret = HI_UNF_DMX_AttachDescrambler(hKey,hDmxAudChn);
    if (HI_SUCCESS != Ret)
    {
        HI_DEBUG_ADVCA("call HI_UNF_DMX_AttachDescrambler hDmxAudChn failed\n");                
        (HI_VOID)HI_UNF_DMX_DetachDescrambler(hKey,hDmxVidChn);
        (HI_VOID)HI_UNF_DMX_DestroyDescrambler(hKey);
        return HI_FAILURE;
    }
    *phKey = hKey;

    return HI_SUCCESS;
}

static HI_S32 AVPLAY_DetachDescramble(HI_HANDLE hAvplay,HI_HANDLE hKey)
{
    HI_S32 Ret;
    HI_HANDLE hDmxVidChn,hDmxAudChn;

    Ret = HI_UNF_AVPLAY_GetDmxVidChnHandle(hAvplay,&hDmxVidChn);
    Ret |= HI_UNF_AVPLAY_GetDmxAudChnHandle(hAvplay,&hDmxAudChn);
    Ret |= HI_UNF_DMX_DetachDescrambler(hKey,hDmxVidChn);
    Ret |= HI_UNF_DMX_DetachDescrambler(hKey,hDmxAudChn);
    Ret |= HI_UNF_DMX_DestroyDescrambler(hKey);
    
    return Ret;
}

HI_S32 main(HI_S32 argc,HI_CHAR *argv[])
{
    run_cmdline(argc, argv);

    return HI_SUCCESS;
}

